\selectlanguage{english}

As already noted in \secref{sssec:div}, the computation of Next-to-Leading Order (NLO) corrections often produces diverging amplitudes. However, this seems to be a consequence of Heisenberg's principle, implying that a quantum field theory cannot be valid at all energy scales at once.

\section{Renormalization of \texorpdfstring{$ \lambda \phi^4 $}{λφ4}-theory}

\subsection{1-Loop diagrams}
\label{ssec:f4-1-loop}

Consider $ \lambda \phi^4 $-theory and compute the scattering cross-section for $ \phi \phi \rightarrow \phi \phi $ at LO:
\begin{equation*}
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};
      \vertex[right=4cm of a1] (a2) {};
      \vertex[below=4em of a1] (b1) {};
      \vertex[below=4em of a2] (b2) {};
      \vertex[below=2em of a1] (c1) {};
      \vertex[right=2cm of c1, dot] (c2) {};

      \vertex[below=2.2em of a1] (r);

      \diagram* {
        (a1) -- [scalar, momentum = \(p_1\)] (c2),
        (b1) -- [scalar, momentum' = \(p_2\)] (c2),
        (c2) -- [scalar, momentum = \(p_3\)] (a2),
        (c2) -- [scalar, momentum' = \(p_4\)] (b2),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad \implies \quad
  \dd \sigma^\text{LO} = \frac{1}{\Phi} \frac{\dd^3p_3}{(2\pi)^3 2E_{p_3}} \frac{\dd^3p_4}{(2\pi)^4 2E_{p_4}} (2\pi)^4 \delta^{(4)}(p_1 + p_2 - p_3 - p_4) \lambda^2
\end{equation*}
In the CM frame:
\begin{equation*}
  p_1 = (E, 0, 0, p)
  \quad
  p_2 = (E, 0, 0, -p)
  \quad
  p_3 = (E, p \sin \theta, 0, p \cos \theta)
  \quad
  p_4 = (E, -p \sin \theta, 0, - p \cos \theta)
\end{equation*}
\begin{equation*}
  s = 4E^2
  \qquad
  t = -2p^2 (1 + \cos \theta)
  \qquad
  u = -2p^2 (1 - \cos \theta)
\end{equation*}
with flux factor $ \Phi = 8pE $. Then the cross-section becomes:
\begin{equation*}
  \dd \sigma^\text{LO} = \frac{\lambda^2}{8pE} \frac{\dd^3p_3}{(2\pi)^2 (2E_{p_3})^2} \delta(2E - 2\sqrt{p_3^2 + m^2}) = \frac{\lambda^2}{8pE} \frac{p_3 \dd p_3 \dd \Omega_2}{(2\pi)^2 4E_{p_3}} \delta(E_{p_3} - E) = \frac{\lambda^2}{8pE} \frac{p}{16\pi E} \dd \cos \theta
\end{equation*}
Therefore, there's no angular dependence:
\begin{equation}
  \frac{\dd \sigma^\text{LO}}{\dd \cos \theta} = \frac{\lambda^2}{128 \pi} \frac{1}{E^2}
\end{equation}
Now, consider the NLO corrections to this cross-section, i.e. the 1-loop corrections:
\begin{equation*}
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};
      \vertex[right=4cm of a1] (a2) {};
      \vertex[below=4em of a1] (b1) {};
      \vertex[below=4em of a2] (b2) {};
      \vertex[below=2em of a1] (c1) {};
      \vertex[right=2cm of c1, blob] (c2) {};

      \vertex[below=2.2em of a1] (r);

      \diagram* {
        (a1) -- [scalar, momentum = \(p_1\)] (c2),
        (b1) -- [scalar, momentum' = \(p_2\)] (c2),
        (c2) -- [scalar, momentum = \(p_3\)] (a2),
        (c2) -- [scalar, momentum' = \(p_4\)] (b2),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad = \quad
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};
      \vertex[right=4cm of a1] (a2) {};
      \vertex[below=4em of a1] (b1) {};
      \vertex[below=4em of a2] (b2) {};
      \vertex[below=2em of a1] (c1) {};
      \vertex[right=2cm of c1, dot] (c2) {};

      \vertex[below=2.2em of a1] (r);

      \diagram* {
        (a1) -- [scalar, momentum = \(p_1\)] (c2),
        (b1) -- [scalar, momentum' = \(p_2\)] (c2),
        (c2) -- [scalar, momentum = \(p_3\)] (a2),
        (c2) -- [scalar, momentum' = \(p_4\)] (b2),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad + \smo(\lambda^2) \equiv -\img \lambda F(s,t)
\end{equation*}
where $ F(s,t) $ is called \bctxt{form factor}.

\begin{proposition}{Form factor}{}
  In $ \lambda \phi^4 $-theory, the form factor at NLO is:
  \begin{equation}
    F(s,t) = 1 - \img\lambda \left( V(s) + V(t) + V(u) \right) + \smo(\lambda^2)
  \end{equation}
  with:
  \begin{equation}
    V(p^2) \defeq \frac{1}{2} \int \frac{\dd^4k}{(2\pi)^4} \frac{\img}{k^2 - m^2} \frac{\img}{(p + k)^2 - m^2}
    \label{eq:vps-def}
  \end{equation}
\end{proposition}

\begin{proofbox}
  \begin{proof}
    The NLO correction to the scattering amplitude is given by three loop diagrams:
    \begin{equation*}
      \begin{tikzpicture}[baseline = (r.base)]
        \begin{feynman}[inline = (r.base)]
          \vertex (x1) {};
          \vertex[below=3em of x1] (p1) {};
          \vertex[below=3em of p1] (x2) {};

          \vertex[right=3em of p1, dot] (v1) {};
          \vertex[right=5em of v1, dot] (v2) {};

          \vertex[right=3em of v2] (p2) {};
          \vertex[above=3em of p2] (x3) {};
          \vertex[below=3em of p2] (x4) {};

          \vertex[above=0.5em of v1] (r) {};

          \diagram* {
            (x1) -- [scalar, momentum = \(p_1\)] (v1),
            (x2) -- [scalar, momentum' = \(p_2\)] (v1),
            (v2) -- [scalar, momentum = \(p_3\)] (x3),
            (v2) -- [scalar, momentum' = \(p_4\)] (x4),

            (v1) -- [scalar, half left, momentum' = \(p'\)] (v2),
            (v2) -- [scalar, half left, momentum' = \(p\)] (v1),
          };
        \end{feynman}
      \end{tikzpicture}
      \qquad
      \begin{tikzpicture}[baseline = (r.base)]
        \begin{feynman}[inline = (r.base)]
          \vertex (x1) {};
          \vertex[right=4em of x1] (p1) {};
          \vertex[right=4em of p1] (x3) {};

          \vertex[below=2em of p1, dot] (v1) {};
          \vertex[below=5em of v1, dot] (v2) {};

          \vertex[below=9em of x1] (x2) {};
          \vertex[below=9em of x3] (x4) {};

          \vertex[below=2em of v1] (r) {};

          \diagram* {
            (x1) -- [scalar, momentum = \(p_1\)] (v1) -- [scalar, momentum = \(p_3\)] (x3),
            (x2) -- [scalar, momentum' = \(p_2\)] (v2) -- [scalar, momentum' = \(p_4\)] (x4),

            (v1) -- [scalar, half left, momentum = \(p''\)] (v2),
            (v2) -- [scalar, half left, momentum = \(p\)] (v1),
          };
        \end{feynman}
      \end{tikzpicture}
      \qquad
      \begin{tikzpicture}[baseline = (r.base)]
        \begin{feynman}[inline = (r.base)]
          \vertex (x1) {};
          \vertex[right=4em of x1] (p1) {};
          \vertex[right=4em of p1] (x3) {};

          \vertex[below=2em of p1, dot] (v1) {};
          \vertex[below=5em of v1, dot] (v2) {};

         \vertex[below=9em of x1] (x2) {};
          \vertex[below=9em of x3] (x4) {};

          \vertex[below=2em of v1] (r) {};

          \diagram* {
            (x1) -- [scalar, momentum = \(p_1\)] (v1) -- [scalar, momentum = \(p_4\)] (x3),
            (x2) -- [scalar, momentum' = \(p_2\)] (v2) -- [scalar, momentum' = \(p_3\)] (x4),

            (v1) -- [scalar, half left, momentum = \(p'''\)] (v2),
            (v2) -- [scalar, half left, momentum = \(p\)] (v1),
          };
        \end{feynman}
      \end{tikzpicture}
    \end{equation*}
    with $ p' = p + p_1 + p_2 $, $ p'' = p + p_1 - p_3 $ and $ p''' = p + p_1 - p_4 $. These correspond to loop diagrams in the $ s $, $ t $ and $ u $ channels, therefore, recalling \eref{eq:f4-loop-ampl}, the thesis is trivially found.
  \end{proof}
\end{proofbox}

\begin{lemma}{Feynman parameters}{feynman-parameters}
  For $ \{A_i\}_{i = 1, \dots, n} \ssq \C $ and $ \{m_i\}_{i = 1, \dots, n} \ssq \R^+ $, with $ n \in \N $:
  \begin{equation}
    \frac{1}{A_1^{m_1} \hspace{-0.1em} \dots A_n^{m_n}} = \int_{[0,1]^n} \dd x_1 \dots \dd x_n \, \delta ( {\textstyle \sum_{i = 1}^n x_i} - 1 ) \frac{\prod_{i = 1}^n x_i^{m_i - 1}}{(\sum_{i = 1}^n x_i A_i)^{m_1 + \dots + m_n}} \frac{\Gamma(m_1 + \dots m_n)}{\Gamma(m_1) \dots \Gamma(m_n)}
  \end{equation}
\end{lemma}

This allows to rewrite $ V(p^2) $:
\begin{equation*}
  V(p^2) = - \frac{1}{2} \int \frac{\dd^4k}{(2\pi)^4} \int_0^1 \dd x \left[ k^2 - m^2 + x \left( 2 k \cdot p + p^2 \right) \right]^{-2} \equiv - \frac{1}{2} \int_0^1 \dd x \int \frac{\dd^4\ell}{(2\pi)^4} \frac{1}{\left( \ell^2 - M^2 \right)^2}
\end{equation*}
having defined:
\begin{equation}
  \ell \equiv k + x p
  \qquad \qquad
  M^2 \equiv m^2 - x (1-x) p^2
\end{equation}

\begin{lemma}[before upper = {\tcbtitle}]{}{}
  \begin{equation}
    I_d(n) \equiv \int \frac{\dd^dk}{(2\pi)^d} \frac{1}{(k^2 - M^2 + \img\epsilon)^n} = \frac{\img (-1)^n}{(4\pi)^{d/2}} \frac{\Gamma(n - \frac{d}{2})}{\Gamma(n)} \left( \frac{1}{M^2} \right)^{n - d/2}
    \label{eq:int-dn}
  \end{equation}
\end{lemma}

\begin{proofbox}
  \begin{proof}
    The poles of the integrand function are $ k_0 = \pm \left[ \sqrt{M^2 + \ve{k}^2} - \img\epsilon \right] $, therefore the integration path $ I = \R $ can be rotated counterclockwise by $ \frac{\pi}{2} $ without overlapping with any pole. The resulting Wick rotation $ k_0 \mapsto \img k_0 $, i.e. $ k \mapsto k_\text{E} $ (REF TO OBSERVATION), therefore the $ d $-dimensional integral in Minkowskian metric becomes a $ d $-dimensional integral with (negative) Euclidean metric:
    \begin{equation*}
      I_d(n) = \img (-1)^n \int \frac{\dd^dk_\text{E}}{(2\pi)^d} \frac{1}{(k_\text{E}^2 + M^2 - \img\epsilon)^n} = \img (-1)^n \int_{\mathbb{S}^{d-1}} \frac{\dd \Omega_{d-1}}{(2\pi)^d} \int_{\R^+} \dd k_\text{E} \frac{k_\text{E}^{d-1}}{(k_\text{E}^2 + M^2)^n}
    \end{equation*}
    It can be shown that:
    \begin{equation}
      \int_{\R^+} \dd k_\text{E} \frac{k_\text{E}^{d-1}}{(k_\text{E}^2 + M^2)^n} = \frac{1}{2} \frac{\Gamma(n - \frac{d}{2}) \Gamma(\frac{d}{2})}{\Gamma(n)} \left( \frac{1}{M^2} \right)^{n - \frac{d}{2}}
      \label{eq:auxiliary-integral}
    \end{equation}
    Inserting \eref{eq:solid-angle} yields the thesis.
  \end{proof}
\end{proofbox}

\eref{eq:int-dn} diverges for $ (d,n) = (4,2) $, as $ \Gamma(z) = \frac{1}{z} - \gamma_\text{E} + o(z) $, therefore a cutoff needs to be introduced to regularize the integral:
\begin{equation*}
  \begin{split}
    V(p^2)
    & = \lim_{\Lambda \rightarrow \infty} \frac{-\img}{2} \int_0^1 \dd x \int_0^\Lambda \frac{\dd k_\text{E}}{8\pi^2} \frac{k_\text{E}^3}{(k_\text{E}^2 + M^2)^2} = \lim_{\Lambda \rightarrow \infty} \frac{-\img}{2} \int_0^1 \dd x \int_{M^2}^{\Lambda^2 + M^2} \frac{\dd \rho}{16\pi^2} \frac{\rho - M^2}{\rho^2} \\
    & = \lim_{\Lambda \rightarrow \infty} \frac{-\img}{32 \pi^2} \int_0^1 \dd x \left[ \log \left( 1 + \frac{\Lambda^2}{M^2} \right) - \frac{\Lambda^2}{\Lambda^2 + M^2} \right] \\
    & = \lim_{\Lambda \rightarrow \infty} \frac{-\img}{32\pi^2} \int_0^1 \dd x \left[ \log \frac{\Lambda^2}{M^2} - 1 + \smo  \left( \frac{M^2}{\Lambda^2} \right) \right]
  \end{split}
\end{equation*}
The form factor can then be rewritten as:
\begin{equation}
  F(s,t) = 1 + \frac{\lambda}{32\pi^2} \left[ 3 + \lim_{\Lambda \rightarrow \infty} \int_0^1 \dd x \left( \log \frac{M^2(s)}{\Lambda^2} + \log \frac{M^2(t)}{\Lambda^2} + \log \frac{M^2(u)}{\Lambda^2} \right) \right] + \smo(\lambda^2)
  \label{eq:form-factor}
\end{equation}
Now, define the threshold values $ s_0 \equiv 4m^2 $, $ t_0 = u_0 \equiv 0 $. The \bctxt{physical coupling constant} $ \lambda_\text{phys} $ is defined as:
\begin{equation}
  \frac{\dd \sigma}{\dd \cos \theta}\bigg\vert_{s_0 , t_0} = \frac{\lambda_\text{phys}^2}{128\pi m^2}
\end{equation}
which is linked to the \bctxt{bare coupling constant} $ \lambda_\text{bare} \equiv \lambda $ by:
\begin{equation}
  \lambda_\text{bare} F(s_0,t_0) = \lambda_\text{phys}
  \label{eq:bare-phys-def}
\end{equation}

\begin{proposition}{Bare and physical coupling}{bare-phys-coupl}
  The NLO form factor can be expressed as:
  \begin{equation}
    \lambda F(s,t) = \lambda_\text{phys} \left[ 1 - \frac{\lambda_\text{phys}}{32\pi^2} \int_0^1 \dd x \left( \log \frac{M^2(s)}{M^2(s_0)} + \log \frac{M^2(t)}{M^2(t_0)} + \log \frac{M^2(u)}{M^2(u_0)} \right) \right] + \smo(\lambda_\text{phys}^3)
    \label{eq:l-f-cutoff}
  \end{equation}
\end{proposition}

\begin{proofbox}
  \begin{proof}
    By \eref{eq:bare-phys-def}:
    \begin{equation*}
      \lambda_\text{phys} = \lambda (1 - c_0 \lambda) + \smo(\lambda^3)
      \qquad \Leftrightarrow \qquad
      \lambda = \lambda_\text{phys} (1 + c_0 \lambda_\text{phys}) + \smo(\lambda_\text{phys}^3)
    \end{equation*}
    Therefore:
    \begin{equation*}
      \lambda (1 - c \lambda) = \lambda_\text{phys} (1 + c_0 \lambda_\text{phys}) (1 - c \lambda_\text{phys}) + \smo(\lambda_\text{phys}^3) = \lambda_\text{phys} (1 - (c - c_0) \lambda_\text{phys}) + \smo(\lambda_\text{phys}^3)
    \end{equation*}
    Inserting \eref{eq:form-factor} yields the thesis.
  \end{proof}
\end{proofbox}

Expressing $ \lambda_\text{bare} $ as a function of $ \lambda_\text{phys} $ eliminates the divergence regularized by the cutoff, which is absorbed into $ \lambda_\text{phys} $, the observable coupling constant. Note that the choice of $ s_0 $ and $ t_0 $ to define $ \lambda_\text{phys} $ is purely conventional: a more useful choice is imposing:
\begin{equation}
  M^2(s_0) = M^2(t_0) = M^2(u_0) = \mu^2
\end{equation}
It is important to stress the difference between $ \Lambda $ and $ \mu $: $ \Lambda $ is a \bctxt{regularization scale}, introduced to regularize diverging loop integrals, while $ \mu $ is a \bctxt{renormalization point}, introduced to eliminate the $ \Lambda $-depedence\footnotemark. Both parameters are arbitrary, hence physical observables cannot depend on any of them: this means that the explicit $ \mu $-dependence of $ F(s,t) $ must cancel the implicit $ \mu $-dependence of $ \lambda $, so that $ \lambda_\text{phys} $ does not depend on it. \\
The infinities which cancel expressing $ F(s,t) $ in terms of $ \lambda_\text{phys} $ are explicit when expressing $ \lambda_\text{bare} = \lambda_\text{bare}(\lambda_\text{phys}) $. In fact:
\begin{equation*}
  \lambda_\text{phys} = \lambda_\text{bare} \left[ 1 + \frac{3\lambda_\text{bare}}{32\pi^2} \left( 1 + \log \frac{\mu^2}{\Lambda^2} \right) \right] + \smo(\lambda_\text{bare}^3)
\end{equation*}
Thus, choosing $ \mu^2 \propto \Lambda^2 $, it is possible to express $ \lambda_\text{phys} $ as a limit of $ \lambda_\text{bare} $, and eventually $ \lambda_\text{phys} = \lambda_\text{bare} $: the bare coupling constant is the physical coupling at the scale $ \Lambda \rightarrow \infty $ (infinitely-small distances), i.e. including the fluctuations at all scales. Due to Heisenberg's principle, then, $ \lambda_\text{bare} $ is expected to diverge: excitations of the fields in momentum space are defined as normal coordinates of the system in position space, i.e. $ p \sim \pa_x \phi \sim \frac{1}{\Delta x} $, which diverges as $ \Delta x \rightarrow 0 $ (as $ \Lambda \rightarrow \infty $).

\footnotetext{The regularization scale $ \Lambda $ is an unphysical artifact introduce to isolate UV divergences, it depends on the specific regularization scheme adopted (UV cut-off, dimensional regolarization, etc.) and it disappears in renormalized results, while the renormalization point $ \mu $ is the physical reference scale which defines renormalized physical parameters.}

\subsection{Renormalized perturbation theory}

The process of renormalization, which allows to obtain finite results from diverging amplitudes, can be implemented in various ways. That of introducing a UV cut-off $ \Lambda $, expressing the bare observables in terms of the physical observables at some scale $ \mu $ and then setting $ \Lambda \rightarrow \infty $ is rather inefficient at higher orders in perturbation theory: thus, a more efficient renormalization scheme must be adopted. \\
First of all, substitute the UV cut-off with a \bctxt{dimensional regularization scheme} ('t Hooft--Veltman scheme): this scheme consists in turning diverging loop integrals into meromorphic\footnotemark functions of $ d \in \C $, which is an analytic continuation of the number of spacetime dimensions. In particular:
\begin{equation}
  d = 4 - 2 \epsilon
  \label{eq:dim-reg}
\end{equation}
with $ \epsilon \in \C : \Re{\epsilon} < 0 $. By analytic continuation of the Lagrangian of the theory, the dimensionality of the various objects changes.

\footnotetext{Given an open set $ D \subset \C $, then $ f : D \rightarrow \C $ is \textit{meromorphic} if it is holomorphic on $ D - P $, where $ P \subset D $ is a set of isolated points called \textit{poles}. Recall that a function $ f : D \rightarrow \C $ is \textit{holomorphic} on $ D $ if it is complex differentiable at every point in $ D $.}

\begin{proposition}{Dimensional analysis}{}
  In $ d = 4 $:
  \begin{equation}
    [\phi] = [M]
    \qquad \qquad
    [\lambda] = 1
  \end{equation}
\end{proposition}

\begin{proofbox}
  \begin{proof}
    In natural units $ \hbar = c = 1 $, each physical quantity has the dimension of a power of mass, as:
    \begin{equation*}
      [\hbar] = [E] [T] = [M] [T] \equiv 1
      \qquad \qquad
      [c] = [L] [T]^{-1} \equiv 1
    \end{equation*}
    where $ E = m $ ($ c^2 = 1 $) was used. Therefore, $ [L] = [T] = [M]^{-1} $. In this system, the action must be a dimensionless quantity:
    \begin{equation*}
      \act = \int \dd^4x \,\lag
      \qquad \Rightarrow \qquad
      1 = [L]^4 [\lag] = [M]^{-4} [\lag]
      \qquad \Rightarrow \qquad
      [\lag] = [M]^4
    \end{equation*}
    As $ [\pa_\mu] = [L]^{-1} = [M] $, then, it is clear that $ [\phi] = [M] $ and, being $ \lag_\text{int} = - \frac{\lambda}{4!} \phi^4 $, $ [\lambda] = 1 $.
  \end{proof}
\end{proofbox}

\begin{proposition}{Dimensionality in 't Hooft--Veltman scheme}{}
  In $ d = 4 - 2\epsilon $:
  \begin{equation}
    [\phi] = [M]^{1 - \epsilon}
    \qquad \qquad
    [\lambda] = [M]^{2\epsilon}
  \end{equation}
\end{proposition}

\begin{proofbox}
  \begin{proof}
    In the dimensional regularization scheme the differential becomes $ \dd^4x \mapsto \dd^dx $, therefore the Lagrangian must have:
    \begin{equation*}
      [\lag] = [M]^d = [M]^{4 - 2\epsilon}
    \end{equation*}
    $ [\pa_\mu] = [M] $ remains unchanged, therefore $ [\phi] = [M]^{1 - \epsilon} $ and, as a consequence, $ [\lambda] = [M]^{2\epsilon} $.
  \end{proof}
\end{proofbox}

To explicit the dimensionality of the (bare) coupling constant, a regularization scale $ \mu_\text{reg} $ is introduced, so that:
\begin{equation}
  \lambda = \mu_\text{reg}^{2\epsilon} \lambda_\text{bare}
\end{equation}

\begin{proposition}{}{}
  In $ d = 4 - 2\epsilon $:
  \begin{equation}
    -\img \lambda V(p^2) = - \frac{\lambda_\text{bare}}{32\pi^2} \int_0^1 \dd x \left[ \frac{1}{\epsilon} - \gamma_\text{E} + \ln 4\pi - \log \frac{M^2}{\mu_\text{reg}^2} + \smo(\epsilon) \right]
  \end{equation}
  where $ \gamma_\text{E} \simeq 0.5772 $ is the Euler--Mascheroni constant.
\end{proposition}

\begin{proofbox}
  \begin{proof}
    From \eref{eq:vps-def} and using \eref{eq:int-dn}:
    \begin{equation*}
      \begin{split}
        -\img \lambda V(p^2)
        & = \frac{\img \lambda}{2} \int_0^1 \dd x \int \frac{\dd^d\ell}{(2\pi)^d} \frac{1}{(\ell^2 - M^2)^2} = \frac{\img \lambda_\text{bare}}{2} \mu_\text{reg}^{2\epsilon} \int_0^1 \dd x \frac{\img}{(4\pi)^{2 - \epsilon}} \frac{\Gamma(\epsilon)}{2} (M^2)^{-\epsilon} \\
        & = - \frac{\lambda_\text{bare}}{32\pi^2} \int_0^1 \dd x \, (4\pi)^\epsilon \Gamma(\epsilon) \left( \frac{M^2}{\mu_\text{reg}^2} \right)^{-\epsilon}
      \end{split}
    \end{equation*}
    Now, the Laurent series in $ \epsilon $ for this expression is:
    \begin{equation*}
      \begin{split}
        -\img \lambda V(p^2)
        &= - \frac{\lambda_\text{bare}}{32\pi^2} \int_0^1 \dd x \left( 1 + \epsilon \log 4\pi + \smo(\epsilon) \right) \left( \frac{1}{\epsilon} - \gamma_\text{E} + \smo(\epsilon) \right) \left( 1 - \epsilon \log \frac{M^2}{\mu_\text{reg}^2} + \smo(\epsilon) \right) \\
        & = - \frac{\lambda_\text{bare}}{32\pi^2} \int_0^1 \dd x \left[ \frac{1}{\epsilon} - \gamma_\text{E} + \log 4\pi - \log \frac{M^2}{\mu_\text{reg}^2} + \smo(\epsilon) \right]
      \end{split}
    \end{equation*}
    which is the thesis.
  \end{proof}
\end{proofbox}

The dimensionally-regularized form factor, then, takes the form:
\begin{equation*}
  F(s,t) = 1 - \frac{\lambda_\text{bare}}{32\pi^2} \left[ 3 \hspace{-0.2em} \left( \frac{1}{\epsilon} - \gamma_\text{E} + \log 4\pi \right) \hspace{-0.2em} - \hspace{-0.2em} \int_0^1 \dd x \left( \log \frac{M^2(s)}{\mu_\text{reg}^2} + \log \frac{M^2(t)}{\mu_\text{reg}^2} + \log \frac{M^2(u)}{\mu_\text{reg}^2} \right) \right] + \smo(\epsilon)
\end{equation*}
It would then be possible to proceed with the renormalization of the coupling constant specifying a cinematic $ (s_0,t_0) $ and setting $ \lambda_\text{phys} = \lambda_\text{bare} F(s_0,t_0) $. However, given the arbitrariness of the renormalization point $ \mu_\text{ren} $, it is algebrically convenient to choose an unphysical cinematic which simplifies the expression of $ \lambda_\text{phys} $.

\begin{definition}{Minimal subtraction scheme}{}
  The \bcdef{minimal subtraction scheme} (MS) is a renormalization scheme with renormalization point such that:
  \begin{equation}
    \lambda_\text{MS} = \lambda_\text{bare} \left[ 1 - \frac{3\lambda_\text{bare}}{32\pi^2} \frac{1}{\epsilon} \right] + \smo(\lambda_\text{bare}^3)
  \end{equation}
\end{definition}

When working with dimensional regularization, it is more useful to adopt the \bctxt{modified MS scheme} ($ \msb $), which includes the universal constant $ -\gamma_\text{E} + \log 4\pi $ in the expression for the physical coupling constant:
\begin{equation}
  \lambda_{\msb} = \lambda_\text{bare} \left[ 1 - \frac{3\lambda_\text{bare}}{32\pi^2} \left( \frac{1}{\epsilon} - \gamma_\text{E} + \log 4\pi \right) \right] + \smo(\lambda_\text{bare}^3)
  \label{eq:l-msb}
\end{equation}

\begin{theorem}{Scales in the $ \msb $ scheme}{}
  In the $ \msb $ scheme:
  \begin{equation}
    \mu_\text{reg} = \mu_\text{ren}
  \end{equation}
\end{theorem}

\begin{proofbox}
  \begin{proof}
    As of \eref{eq:l-msb}, using the same reasoning as in the proof of \pref{prop:bare-phys-coupl}:
    \begin{equation}
      \lambda_\text{bare} = \lambda_{\msb} \left[ 1 + \frac{3\lambda_{\msb}}{32\pi^2} \left( \frac{1}{\epsilon} - \gamma_\text{E} + \log 4\pi \right) \right] + \smo(\lambda_{\msb}^3)
    \end{equation}
    Moreover:
    \begin{equation*}
      \begin{split}
        \lambda_\text{bare} F(s,t)
        & = \lambda_\text{bare} \left[ 1 - \frac{3\lambda_\text{bare}}{32\pi^2} \left( \frac{1}{\epsilon} - \gamma_\text{E} + \log 4\pi \right) \right] \\
        & \qquad \qquad  + \frac{\lambda_\text{bare}^2}{32\pi^2} \int_0^1 \dd x \left( \log \frac{M^2(s)}{\mu_\text{reg}^2} + \log \frac{M^2(t)}{\mu_\text{reg}^2} + \log \frac{M^2(u)}{\mu_\text{reg}^2} \right) + \smo(\lambda_\text{bare}^3) \\
      \end{split}
    \end{equation*}
    Then, noting that $ \lambda_\text{bare}^2 = \lambda_{\msb}^2 + \smo(\lambda_{\msb}^3) $:
    \begin{equation*}
      \lambda_\text{bare} F(s,t) = \lambda_{\msb} \left[ 1 + \frac{\lambda_{\msb}}{32\pi^2} \int_0^1 \dd x \left( \log \frac{M^2(s)}{\mu_\text{reg}^2} + \log \frac{M^2(t)}{\mu_\text{reg}^2} + \log \frac{M^2(u)}{\mu_\text{reg}^2} \right) \right] + \smo(\lambda_{\msb}^3)
    \end{equation*}
    Comparing this expression to \eref{eq:l-f-cutoff}, it is clear that $ \mu_\text{reg} $ is also the renormalization point of the scheme.
  \end{proof}
\end{proofbox}

Hence, in the $ \msb $ scheme $ \mu_\text{reg} = \mu_\text{ren} \equiv \mu $.

\subsubsection{Lagrangian counterterms}
\label{sssec:lag-count}

Define $ Z_\lambda : \lambda_\text{bare} = Z_\lambda \lambda_{\msb} \equiv \lambda_{\msb} + \delta_\lambda $, so that:
\begin{equation*}
  Z_\lambda = 1 + \frac{3\lambda_{\msb}}{32\pi^2} \left( \frac{1}{\epsilon} - \gamma_\text{E} + \log 4\pi \right) + \smo(\lambda_{\msb}^2)
  \qquad
  \delta_\lambda = \frac{3\lambda_{\msb}^2}{32\pi^2} \left( \frac{1}{\epsilon} - \gamma_\text{E} + \log 4\pi \right) + \smo(\lambda_{\msb}^3)
\end{equation*}
Inserting into the Lagrangian:
\begin{equation*}
  \begin{split}
    \lag
    & = \frac{1}{2} \left( \pa_\mu \phi \pa^\mu \phi - m^2 \phi^2 \right) - \frac{\lambda}{4!} \phi^4 \\
    & = \frac{1}{2} \left( \pa_\mu \phi \pa^\mu \phi - m^2 \phi^2 \right) - \frac{\lambda_{\msb}}{4!} \phi^4 - \frac{\delta_\lambda}{4!} \phi^4 + \smo(\lambda_{\msb}^3)
  \end{split}
\end{equation*}
It is then clear that renormalizing the coupling constant is equivalent to adding a counterterm to the Lagrangian, which contains the original divergence. This counterterm induces a new interaction vertex:
\begin{equation}
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};
      \vertex[right=4cm of a1] (a2) {};
      \vertex[below=4em of a1] (b1) {};
      \vertex[below=4em of a2] (b2) {};
      \vertex[below=2em of a1] (c1) {};
      \vertex[right=2cm of c1, crossed dot] (c2) {};

      \vertex[below=2.2em of a1] (r);

      \diagram* {
        (a1) -- [scalar] (c2),
        (b1) -- [scalar] (c2),
        (a2) -- [scalar] (c2),
        (b2) -- [scalar] (c2),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad = \quad -i \delta_\lambda
  \label{eq:counterterm}
\end{equation}
This process is general: divergences are cured order by order in perturbation theory by adding each time new counterterms to the Lagrangian: hence the name of renormalized perturbation theory\footnote{The name may be confusing, as the counterterms still contain divergences.}. At each order, each new counterterms are fixed by an appropriate physical condition.

\subsection{Renormalizability}

The problem of renormalization has been reduced to that of classifying all possible counterterms to the Lagrangian, where each counterterm arises from the normalization of a different class of diverging Feynman diagrams.

\begin{definition}{Superficial degree of divergence}{}
  Given a scalar field theory in $ d $ dimensions, the \bcdef{superficial degree of divergence} of a Feynman diagram with $ L $ loops and $ P_\text{s} $ scalar propagators is:
  \begin{equation}
    D \defeq d L - 2 P_\text{s}
    \label{eq:sup-deg-div-def}
  \end{equation}
\end{definition}

The superficial degree of divergence gives an idea of how badly the considered diagram diverges: indeed, each loop corresponds to an integration with measure $ \dd^dk $, which has dimension $ [M]^d $, and each propagator corresponds to a factor of $ \fprp(p) \sim (p^2 - m^2)^{-1} $, which has dimension $ [M]^{-2} $, so $ D $ is the net power of momentum present in the amplitude:
\begin{equation*}
  \mat \sim \int \frac{\dd k}{k^{1-D}}
\end{equation*}
Introducing a UV cut-off $ \Lambda $, the divergence will be different for different values of $ D $:
\begin{itemize}
  \item $ D > 0 $: $ \mat \sim \Lambda^D $, hence the diagram has a UV divergence which must be renormalized;
  \item $ D = 0 $: $ \mat \sim \log \Lambda $, hence the diagram has a logarithmic UV divergence;
  \item $ D < 0 $: $ \mat \sim \Lambda^{-\abs{D}} $, hence the diagram is UV finite.
\end{itemize}
This, however, is a naive analysis: in fact, the diagram may have diverging sub-diagrams which make the actual degree of divergence worse, or it may have symmetries which make divergences partially cancel, leaving a better degree of divergence. As an example, a trivial diagram with no loops and no propagators has $ D = 0 $, but it is not a diverging diagram. \\
The problem of diverging sub-diagrams requires a more careful analysis. Consider the following diagram in $ 4 $-dimensional $ \lambda \phi^4 $-theory:
\begin{equation*}
  \begin{tikzpicture}[baseline = (r.base)]
    \begin{feynman}[inline = (r.base)]
      \vertex (a) {};
      \vertex [above = 1.0cm of a] (a1) {};
      \vertex [below = 1.0cm of a] (a2) {};

      \vertex [right = 1.5cm of a, dot] (v1) {};
      \vertex [right = 2.0cm of v1, dot] (v2) {};

      \vertex [right = 1.5cm of v2] (b1) {};
      \vertex [right = 1.5cm of b1] (b2) {};

      \vertex [above = 1.0cm of b1, dot] (v3) {};
      \vertex [below = 1.0cm of b1, dot] (v4) {};

      \vertex [above = 0.5cm of b2] (c1) {};
      \vertex [above = 1.5cm of b2] (c2) {};
      \vertex [below = 0.5cm of b2] (c3) {};
      \vertex [below = 1.5cm of b2] (c4) {};

      \vertex[below=0.1em of a] (r) {};

      \diagram* {
        (a1) -- [scalar] (v1);
        (a2) -- [scalar] (v1);
        (v1) -- [scalar, half left] (v2) -- [scalar, half left] (v1);
        (v2) -- [scalar] (v3) -- [scalar] (c2);
        (v2) -- [scalar] (v4) -- [scalar] (c4);
        (v3) -- [scalar] (c1);
        (v4) -- [scalar] (c3);
        (v3) -- [scalar] (v4);
      };
    \end{feynman}
  \end{tikzpicture}
  \qquad \qquad
  D = 4 \cdot 2 - 2 \cdot 5 = -2
\end{equation*}
Although $ D < 0 $, the loop integral diverges: however, in renormalized perturbation theory this divergence is cured by the counterterm \eref{eq:counterterm}. This is a general property: apart from superficially divergent diagrams, the only other divergences arise from diverging sub-diagrams of superficially finite diagrams, but these divergences are cured by the counterterms already added to the Lagrangian. Hence, the renormalization procedure correctly cures all UV divergences.

\begin{theorem}{Bogolyubov--Parasyuk theorem}{}
  For any renormalized quantum field theory, the perturbative expansion of matrix elements of the $ S $-matrix is UV-finite.
\end{theorem}

\begin{proofbox}
  \begin{proof}
    The proof is found in \cite{bog-par, azp}.
  \end{proof}
\end{proofbox}

\subsubsection{\texorpdfstring{$ \lambda \phi^n $}{λφn}-theory}

\begin{lemma}{Loop number}{loop-number}
  Given a diagram with $ P $ propagators and $ V $ vertices, then:
  \begin{equation}
    L = P - V + 1
    \label{eq:loop-num}
  \end{equation}
\end{lemma}

\begin{proofbox}
  \begin{proof}
    Each loop is associated to an unconstrained momentum: each propagator corresponds to a momentum, while each vertex to a $ \delta $ which constrains the momenta of the diagram, but there's also an overall momentum-conserving $ \delta $ which makes one of the vertex-associated $ \delta $ redundant, hence $ L = P - (V - 1) $, which is the thesis.
  \end{proof}
\end{proofbox}

This result is valid in general for any field theory, and $ P $ represents the total number of propagators (even of different kinds). \\
Considering the specific case of $ \lambda \phi^n $-theory, instead, there's another relation which can simplify the computation of the superficial degrees of freedom: as each vertex has $ n $ scalar lines, then:
\begin{equation}
  n V = 2 P_\text{s} + N_\text{s}
  \label{eq:fn-v}
\end{equation}
where $ N_\text{s} $ is the number of external scalar lines. This expression takes into account the fact that each propagator links two vertices.

\begin{theorem}{Superficial degree of divergence}{lfn-sup-deg-div}
  In $ \lambda \phi^n $-theory in $ d $ dimensions, the \bcth{superficial degree of divergence} is:
    \begin{equation}
      D = d + \left( n \frac{d - 2}{2} - d \right) V - \frac{d - 2}{2} N
      \label{eq:lfn-sup-deg-div}
    \end{equation}
\end{theorem}

\begin{proofbox}
  \begin{proof}
    By \eref{eq:fn-v} $ P = \frac{1}{2} (n V - N) $, thus by \eref{eq:loop-num}:
    \begin{equation*}
      L = \left( \frac{n}{2} - 1 \right) V - \frac{N}{2} + 1
    \end{equation*}
    Recalling \eref{eq:sup-deg-div-def}:
    \begin{equation*}
      D = d \left[ \left( \frac{n}{2} - 1 \right) V - \frac{N}{2} + 1 \right] - n V + N = d + \left( n \frac{d - 2}{2} - d \right) V - \frac{d - 2}{2} N
    \end{equation*}
    which is the thesis.
  \end{proof}
\end{proofbox}

\begin{example}{$ \lambda \phi^4 $-theory}{p4-th}
  The case of $ \lambda \phi^4 $-theory in $ 4 $ dimensions is a particularly simple one, as:
  \begin{equation}
    D = 4 - N
  \end{equation}
  Hence, the only classes of diverging diagrams are vacuum-to-vacuum diagrams, which diverge as $ \sim \Lambda^4 $, the $ 1 \rightarrow 1 $ diagrams (i.e. the $ 2 $-point Green function of the theory and all its possible loop corrections), which diverges as $ \sim \Lambda^2 $, and the $ 2 \rightarrow 2 $ scattering, which diverges as $ \sim \log \Lambda $ (agreeing with \eref{eq:form-factor}). In this case there is only a finite number of classes of diverging diagrams.
\end{example}

\tref{th:lfn-sup-deg-div} can be derived also with dimensional analysis alone. In $ d $-dimensional $ \lambda \phi^n $-theory, it is trivial to show that:
\begin{equation*}
  [\phi] = [M]^{\frac{d - 2}{2}}
  \qquad \qquad
  [\lambda] = [M]^{d - n \frac{d - 2}{2}}
\end{equation*}
The dimensionality of $ \lambda $ is the dimensionality of a diagram with a single vertex, i.e. with $ N = n $ amputated legs, and, as diagrams with the same $ N $ have the same dimensionality, of any diagram with $ N = n $: generalizing, the dimensionality of a diagram with $ N $ amputated legs should be $ d - N \frac{d - 2}{2} $. On the other hand, if the diagram has $ V $ vertices, by definition it should have dimension $ [\lambda]^V [M]^D $, thus:
\begin{equation*}
  \left( d - n \frac{d - 2}{2} \right) V + D = d - N \frac{d - 2}{2}
\end{equation*}
which is exactly \eref{eq:lfn-sup-deg-div}. It is then clear that $ D $ decreases as $ V $ increases (i.e. going to higher orders in perturbation theory) if and only if the coupling constant has positive mass dimension, leaving only three possible classes theories:
\begin{itemize}
  \item super-renormalizable theories: the coupling constant has strictly negative mass dimension, hence there is only a finite number of diverging diagrams.
  \item renormalizable theories: the coupling constant is dimensionless, hence there is only a finite number of classes of diverging diagrams (although their absolute number may be infinite);
  \item non-renormalizable theories: the coupling constant has strictly negative mass dimension, hence there is an infinite number of classes of diverging diagrams.
\end{itemize}
Note that these are general properties, not restricted to real scalar field theories.

\begin{example}{$ d = 4 $ theories}{}
  Consider $ \lambda \phi^n $-theory in $ d = 4 $ dimensions. The coupling constant in $ \lag_\text{int} = - \frac{1}{n!} \lambda \phi^n $ has dimension $ 4 - n $, hence:
  \begin{itemize}
    \item $ \lambda \phi^3 $-theory is super-renormalizable: $ D = 4 - V - N $, thus the only diverging diagrams are the $ 2 $-point Green function (loop corrections have $ D < 0 $) and the single interaction vertex, while all other diagrams have a finite amplitude;
    \item $ \lambda \phi^4 $-theory is renormalizable: $ D = 4 - N $, so the finitely-many classes of diverging diagrams are those listed in \exref{ex:p4-th};
    \item $ \lambda \phi^n $-theory with $ n \ge 5 $ is non-renormalizable: for example, in $ \lambda \phi^5 $-theory $ D = 4 + V - N $, hence increasing the number of vertices increases the superficial degree of divergence, i.e. $ \forall N \in \N_{\ge 2} \, \exists V \in \N : D > 0 $.
  \end{itemize}
\end{example}

The conceptual distinction between renormalizable and non-renormalizable theories is then clear: renormalizable theories can be renormalizable with a finite set of counterterms, which can be fixed with a finite number of physical conditions (i.e. comparison with experiments), while non-renormalizable theories require an infinite set of counterterms, hence having no predictive power (as infinite parameters must be fixed by comparison with experiments).

Although at first glance non-renormalizability may seem problematic, in reality it is not. Consider a non-renormalizable theory with coupling constant $ g \propto M^{-k} $, with $ k \in \R^+ $ and some mass scale $ M $, and assume that the theory has already been renormalized up to $ (N - 1) $-point amplitudes, with $ N \in \N_{\ge 2} $: then, an $ N $-point amplitude at typical energy scale $ E $ can be expressed as:
\begin{equation*}
  \mathcal{A}_N(E) = \mathcal{A}^{(0)}_N(E) \left[ 1 + c_1 \frac{E^k}{M^k} + c_2 \frac{E^{2k}}{M^{2k}} + \dots + c_n \frac{E^{nk}}{M^{nk}} \right]
\end{equation*}
where $ c_1, \dots, c_{n-1} $ are finite constant already fixed by physical conditions.
As $ c_n $ should be fixed too by a new physical condition, the theory would not be predictive even at order $ n $: however, at low energy $ E \ll M $, this lack of predictivity due to $ c_n $ is negligible, as the quantity $ (E/M)^{nk} $ can be assumed to be below the sensitivity of the experimental apparatus taken into consideration. Therefore, it is clear that non-renormalizable theories are acceptable low-energy theories: they gain predictive power by limiting the set of counterterms to be fixed to those necessary at the desired energy scale, as the ignorance about higher-order divergences is beyond the required accuracy. At $ E \sim M $ the above series expansion diverges, signaling a lack of meaning of the theory: non-renormalizable theories have a built-in scale which provides their limit of validity, while renormalizable theories are in principle valid at all energy scales.

\subsubsection{\texorpdfstring{$ \lambda \phi^4 $}{λφ4}-theory}

Consider $ \lambda \phi^4 $-theory in $ d = 4 $ dimensions:
\begin{equation}
  \lag = \frac{1}{2} \pa_\mu \phi \pa^\mu \phi - \frac{1}{2} m_0^2 \phi^2 - \frac{\lambda_0}{4!} \phi^4
\end{equation}
where $ m_0 , \lambda_0 $ are the bare mass and coupling constant. By \eref{eq:lfn-sup-deg-div}, the superficial degree of divergence of a diagram depends only on the number of external legs, as $ D = 4 - N $; moreover, as the theory is symmetric under $ \phi \rightarrow -\phi $, all amplitudes with an odd number of external legs vanish. The only classes of divergent diagrams then are:
\begin{equation*}
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};
      \vertex[right=4cm of a1] (a2) {};
      \vertex[below=4em of a1] (b1) {};
      \vertex[below=4em of a2] (b2) {};
      \vertex[below=2em of a1] (c1) {};
      \vertex[right=2cm of c1, blob] (c2) {};

      \vertex[below=2.2em of a1] (r);
    \end{feynman}
  \end{tikzpicture}
  \qquad
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};
      \vertex[right=4cm of a1] (a2) {};
      \vertex[below=4em of a1] (b1) {};
      \vertex[below=4em of a2] (b2) {};
      \vertex[below=2em of a1] (c1) {};
      \vertex[right=2cm of c1, blob] (c2) {};

      \vertex[left = 2cm of c2] (d1) {};
      \vertex[right = 2cm of c2] (d2) {};

      \vertex[below=2.2em of a1] (r);

      \diagram* {
        (d1) -- [scalar] (c2),
        (c2) -- [scalar] (d2),
      };
    \end{feynman}
  \end{tikzpicture}
  \qquad
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};
      \vertex[right=4cm of a1] (a2) {};
      \vertex[below=4em of a1] (b1) {};
      \vertex[below=4em of a2] (b2) {};
      \vertex[below=2em of a1] (c1) {};
      \vertex[right=2cm of c1, blob] (c2) {};

      \vertex[below=2.2em of a1] (r);

      \diagram* {
        (a1) -- [scalar] (c2),
        (b1) -- [scalar] (c2),
        (c2) -- [scalar] (a2),
        (c2) -- [scalar] (b2),
      };
    \end{feynman}
  \end{tikzpicture}
\end{equation*}
The first class is that of vacuum-to-vacuum diagrams, which are unobservable vacuum energy shifts as they are all accounted for in the definition of correlation functions (see \secref{sssec:lamb-4}).
The second class of diagrams are the loop corrections to the $ 2 $-point Green function and, having $ D = 2 $, has the general diverging structure $ \sim c_1 \Lambda^2 + c_2 p^2 \log \Lambda $, where $ p $ is the initial-state four-momentum.
The third class of diagrams are the loop corrections to the $ 2 \rightarrow 2 $ scattering amplitude, with $ D = 0 $ and diverging structure $ \sim c_3 \log \Lambda $ (agreeing with \secref{ssec:f4-1-loop}).
Ignoring the vacuum-to-vacuum diagrams, there are three infinite constants that need to be absorbed into three unobservable parameters of the theory: the bare mass, the bare coupling constant and the field-strength.

\paragraph{Correlation functions}

To express the identity operator on the Fock space $ \fock $ of the theory, it is necessary to choose a complete basis of $ \fock $. Consider an eigenstate of the Hamiltonian $ H \ket{\lambda_\ve{0}} = m_\lambda \ket{\lambda_\ve{0}} $ such that $ \ve{P} \ket{\lambda_\ve{0}} = \ve{0} $ (i.e. $ m_\lambda^2 = E_\ve{0}^2 $): as per Lorentz invariance, all possible boosts of $ \ket{\lambda_\ve{0}} $ are still eigenstates of $ H $, and they have all the possible three-momenta. Conversely , any eigenstate of $ H $ with definite three-momentum can be expressed as the boost of some zero-momentum eigenstate $ \ket{\lambda_\ve{0}} $. Denoting with $ \ket{\lambda_\ve{p}} $ the eigenstate of $ H $ with three-momentum $ \ve{p} $ obtained as a boost of $ \ket{\lambda_\ve{0}} $ and defining $ E_\ve{p}(\lambda) \equiv \sqrt{\ve{p}^2 + m_\lambda^2} $, where $ m_\lambda : H \ket{\lambda_\ve{0}} = m_\lambda \ket{\lambda} $, then the completeness relation on $ \fock $ can be written as\footnotemark:
\begin{equation}
  \id_\fock = \ket{0}\bra{0} + \sum_\lambda \int \frac{\dd^3p}{(2\pi)^3} \frac{1}{2E_\ve{p}(\lambda)} \ket{\lambda_\ve{p}}\bra{\lambda_\ve{p}}
\end{equation}
where $ \ket{0} $ is the vacuum state of $ \fock $.

\footnotetext{Recall that for the one-particle Hilbert space $ \hilb $ with relativistic normalization (\eref{eq:scal-rel-norm}):
\begin{equation}
  \id_\hilb = \int \frac{\dd^3p}{(2\pi)^3} \frac{1}{2E_\ve{p}} \ket{\ve{p}}\bra{\ve{p}}
\end{equation}}

\begin{proposition}{Correlation functions}{}
  The correlation function for a real scalar field theory can be written as (with $ x^0 > y^0 $):
  \begin{equation}
    \braket{0 | \tempord\{\phi(x) \phi(y)\} | 0} = \sum_\lambda \int \frac{\dd^4p}{(2\pi)^4} \frac{\img}{p^2 - m_\lambda^2 + \img\epsilon} e^{-\img p_\mu (x - y)^\mu} \abs{\braket{0 | \phi(0) | \lambda_\ve{0}}}^2
  \end{equation}
\end{proposition}

\begin{proofbox}
  \begin{proof}
    Inserting the identity in the $ 2 $-point Green function, as $ x^0 > y^0 $:
    \begin{equation*}
      \braket{0 | \phi(x) \phi(y) | 0} = \braket{0 | \phi(x) | 0} \braket{0 | \phi(y) | 0} +  \sum_\lambda \int \frac{\dd^3p}{(2\pi)^3} \frac{1}{2E_\ve{p}(\lambda)} \braket{0 | \phi(x) | \lambda_\ve{p}} \braket{\lambda_\ve{p} | \phi(y) | 0}
    \end{equation*}
    The first term is constant and can be neglected, as it usually vanishes by symmetry or Lorentz invariance. Manipulating the matrix elements:
    \begin{equation*}
      \begin{split}
        \braket{0 | \phi(x) | \lambda_\ve{p}}
        & = \braket{0 | e^{\img x_\mu P^\mu} \phi(0) e^{-\img x_\mu P^\mu} | \lambda_\ve{p}} = e^0 \braket{0 | \phi(0) | \lambda_\ve{p}} e^{-\img p_\mu x^\mu} \big\vert_{p^0 = E_\ve{p}} \\
        & = \braket{0 | \mt{U}^{-1} \mt{U} \phi(0) \mt{U}^{-1} \mt{U} | \lambda_\ve{p}} e^{-\img p_\mu x^\mu} \big\vert_{p^0 = E_\ve{p}} = \braket{0 | \phi(0) | \lambda_\ve{0}} e^{-\img p_\mu x^\mu} \big\vert_{p^0 = E_\ve{p}}
      \end{split}
    \end{equation*}
    where $ \mt{U} $ is a unitary operator implementing a Lorentz boost $ \ve{p} \mapsto \ve{0} $, using that $ \mt{U} \phi(0) \mt{U}^{-1} = \phi(0) $ (this is valid for a spinless field, while higher-spin fields have non-trivial transformation properties). Introducing an integration in $ \dd p^0 $ as in the proof of \tref{th:feynman-prop} yields the thesis.
  \end{proof}
\end{proofbox}

The case $ x^0 < y^0 $ is analogous, and a common expression can be formulated.

\begin{definition}{Källén--Lehmann representation}{}
  The \bcdef{Källén--Lehmann spectral representation} of the correlation function of a real scalar field theory is defined as:
  \begin{equation}
    \braket{0 | \tempord\{\phi(x) \phi(y)\} | 0} = \int_0^\infty \frac{\dd M^2}{2\pi} \rho(M^2) \fpr(x-y ; M^2)
  \end{equation}
  where $ \rho(M^2) $ is a positive \bcdef{spectral density} function:
  \begin{equation}
    \rho(M^2) \defeq \sum_\lambda 2\pi \delta(M^2 - m_\lambda^2) \abs{\braket{0 | \phi(0) | \lambda_0}}^2
  \end{equation}
\end{definition}

\begin{figure}[!ht]
  \centering
  \includegraphics[width = 0.70 \textwidth]{mas-hyp.png}
  \caption{Hyperboloids in energy-momentum space formed by the eigenvalues of $ P^\mu = (H, \ve{P}) $.}
  \label{fig:mass-1}
\end{figure}

\begin{figure}[!ht]
  \centering
  \includegraphics[width = 0.60 \textwidth]{spec-dens.png}
  \caption{Spectral density function for a typical interacting field theory.}
  \label{fig:mass-2}
\end{figure}

\begin{figure}[!ht]
  \centering
  \includegraphics[width = 0.60 \textwidth]{poles.png}
  \caption{Analytic structure in the complex $ p^2 $-plane of $ \fprp(p) $.}
  \label{fig:mass-3}
\end{figure}

As shown in Fig. \ref{fig:mass-2}, the one-particle states contribute to the spectral density with an isolated $ \delta $:
\begin{equation}
  \rho(M^2) = 2\pi \delta(M^2 - m^2) Z + (\text{terms with } M^2 \gtrsim (2m)^2)
\end{equation}
where $ Z $ is a number coming from the squared matrix element and it is called \bctxt{field-strength renormalization} (the same factor appearing in the LSZ reduction formula). Note that $ m $ is the physical mass of the particle, as opposed to the bare mass $ m_0 $ appearing in the Lagrangian. The Fourier transform of the $ 2 $-point Green function then is:
\begin{equation}
  \fprp(p) = \frac{\img Z}{p^2 - m^2 + \img\epsilon} + \int_{\sim 4m^2}^\infty \frac{\dd M^2}{2\pi} \rho(M^2) \frac{\img}{p^2 - M^2 + \img\epsilon}
  \label{eq:corr-func-gen}
\end{equation}
The pole structure of $ \fprp(p) $ is shown in Fig. \ref{fig:mass-3}: the first term gives an isolated simple pole in $ p^2 = m^2 $, while the second term contributes a branch cut beginning at $ p^2 = (2m)^2 $ (any two-particle bound states will appear as an additional $ \delta $ in $ \rho(M^2) $, i.e. additional an isolated pole below the branch cut). \eref{eq:corr-func-gen} is a direct generalization of \eref{eq:corr-func}: the former contains the field-strength renormalization $ Z = \abs{\braket{\lambda_\ve{0} | \phi(0) | 0}}^2 $, i.e. the probability for $ \phi(0) $ to create a given state from vacuum, while the latter has it implicitly, since in the free theory $ \abs{\braket{\ve{p} | \phi(0) | 0}}^2 = 1 $; moreover, \eref{eq:corr-func} is the amplitude of a single particle propagating from $ x $ to $ y $, as in the free theory $ \phi(0) $ can only create a single particle from vacuum, while \eref{eq:corr-func-gen} contains contributions from multiparticle intermediate states with a continuous mass spectrum.

\paragraph{Counterterms}

\eref{eq:corr-func-gen} has a single term which is singular at $ p^2 = m^2 $, and to eliminate the awkward residue $ Z $ it is possible to set:
\begin{equation}
  \phi \equiv \sqrt{Z} \phi_\text{r}
  \label{eq:phi-ren}
\end{equation}
This is the renormalized field (recall that it is equivalent to renormalize multiplicatively or additively).

\begin{proposition}{Renormalized $ \lambda \phi^4 $-theory}{}
  The renormalized Lagrangian of $ \lambda \phi^4 $-theory takes the form:
  \begin{equation}
    \lag = \frac{1}{2} \pa_\mu \phi_\text{r} \pa^\mu \phi_\text{r} - \frac{1}{2} m^2 \phi_\text{r}^2 - \frac{\lambda}{4!} \phi_\text{r}^4 + \frac{1}{2} \delta_Z \pa_\mu \phi_\text{r} \pa^\mu \phi_\text{r} - \frac{1}{2} \delta_m \phi_\text{r}^2 - \frac{\delta_\lambda}{4!} \phi_\text{r}^4
  \end{equation}
  with:
  \begin{equation}
    \delta_Z \equiv Z - 1
    \qquad \qquad
    \delta_m \equiv m_0^2 Z - m^2
    \qquad \qquad
    \delta_\lambda \equiv \lambda_0 Z^2 - \lambda
  \end{equation}
\end{proposition}

\begin{proofbox}
  \begin{proof}
    Inserting \eref{eq:phi-ren} into the Lagrangian of $ \lambda \phi^4 $-theory:
    \begin{equation*}
      \lag = \frac{1}{2} Z \pa_\mu \phi_\text{r} \pa^\mu \phi_\text{r} - \frac{1}{2} m_0^2 Z \phi_\text{r}^2 - \frac{\lambda_0}{4!} \phi_\text{r}^4
    \end{equation*}
    The isolation of counterterms is then trivial.
  \end{proof}
\end{proofbox}

This Lagrangian is composed of the standard $ \lambda \phi^4 $-theory Lagrangian, with renormalized field, mass and coupling constant, plus three counterterms: this is precisely the number of infinite constants appearing in diverging amplitudes of the theory. The Feynman rules for the renormalized theory are:
\begin{equation*}
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};
      \vertex[right=4cm of a1] (a2) {};
      \vertex[below=4em of a1] (b1) {};
      \vertex[below=4em of a2] (b2) {};
      \vertex[below=2em of a1] (c1) {};
      \vertex[right=2cm of c1] (c2) {};

      \vertex[left = 2cm of c2] (d1) {};
      \vertex[right = 2cm of c2] (d2) {};

      \vertex[below=2.2em of a1] (r);

      \diagram* {
        (d1) -- [scalar, momentum = \(p\)] (d2),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad = \quad \frac{\img}{p^2 - m^2 + \img\epsilon}
  \qquad
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};
      \vertex[right=4cm of a1] (a2) {};
      \vertex[below=4em of a1] (b1) {};
      \vertex[below=4em of a2] (b2) {};
      \vertex[below=2em of a1] (c1) {};
      \vertex[right=2cm of c1, crossed dot] (c2) {};

      \vertex[left = 2cm of c2] (d1) {};
      \vertex[right = 2cm of c2] (d2) {};

      \vertex[below=2.2em of a1] (r);

      \diagram* {
        (d1) -- [scalar, momentum = \(p\)] (c2) -- [scalar] (d2),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad = \quad \img (p^2 \delta_Z - \delta_m)
\end{equation*}
\begin{equation*}
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};
      \vertex[right=4cm of a1] (a2) {};
      \vertex[below=4em of a1] (b1) {};
      \vertex[below=4em of a2] (b2) {};
      \vertex[below=2em of a1] (c1) {};
      \vertex[right=2cm of c1, dot] (c2) {};

      \vertex[below=2.2em of a1] (r);

      \diagram* {
        (a1) -- [scalar] (c2),
        (b1) -- [scalar] (c2),
        (c2) -- [scalar] (a2),
        (c2) -- [scalar] (b2),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad = \quad -\img \lambda
  \qquad \qquad
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};
      \vertex[right=4cm of a1] (a2) {};
      \vertex[below=4em of a1] (b1) {};
      \vertex[below=4em of a2] (b2) {};
      \vertex[below=2em of a1] (c1) {};
      \vertex[right=2cm of c1, crossed dot] (c2) {};

      \vertex[below=2.2em of a1] (r);

      \diagram* {
        (a1) -- [scalar] (c2),
        (b1) -- [scalar] (c2),
        (c2) -- [scalar] (a2),
        (c2) -- [scalar] (b2),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad = \quad -\img \delta_\lambda
\end{equation*}
To make the definition of the counterterms effective, the physical conditions which fix $ Z $, $ m $ and $ \lambda $ must be set, in order to set their value via comparison with experiments. The three \bctxt{renormalization conditions} are:
\begin{equation*}
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};
      \vertex[right=4cm of a1] (a2) {};
      \vertex[below=4em of a1] (b1) {};
      \vertex[below=4em of a2] (b2) {};
      \vertex[below=2em of a1] (c1) {};
      \vertex[right=2cm of c1, blob] (c2) {};

      \vertex[left = 2cm of c2] (d1) {};
      \vertex[right = 2cm of c2] (d2) {};

      \vertex[below=2.2em of a1] (r);

      \diagram* {
        (d1) -- [scalar, momentum = \(p\)] (c2) -- [scalar] (d2),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad = \quad \frac{\img}{p^2 - m^2} + (\text{terms regular at } p^2 = m^2)
\end{equation*}
\begin{equation*}
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};
      \vertex[right=4cm of a1] (a2) {};
      \vertex[below=4em of a1] (b1) {};
      \vertex[below=4em of a2] (b2) {};
      \vertex[below=2em of a1] (c1) {};
      \vertex[right=2cm of c1, blob] (c2) {};

      \vertex[below=2.2em of a1] (r);

      \diagram* {
        (a1) -- [scalar] (c2),
        (b1) -- [scalar] (c2),
        (c2) -- [scalar] (a2),
        (c2) -- [scalar] (b2),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad = \quad -\img \lambda
  \qquad \text{at} \qquad
  s = 4m^2 \,\,,\,\, t = u = 0
\end{equation*}
These physical conditions fix the pole and the residue of the $ 2 $-point Green function and the zero-momentum $ 2 \rightarrow 2 $ scattering amplitude: once loop integrals have been regularized, the $ \delta_Z $, $ \delta_m $ and $ \delta_\lambda $ are adjusted (renormalized) to satisfy the renormalization conditions and, after this adjustment, the amplitudes should be finite and independent of the regulator. This marks the successful renormalization of the theory\footnote{Note that in the $ \msb $ scheme the physical conditions are replaced by subtraction of poles: this means that the $ \msb $ mass $ m_{\msb} $ is not the pole of the $ 2 $-point Green function, hence it is not physically observable.}. \\
At $ \smo(\lambda) $ order only $ \delta_\lambda $ is non-trivial, as $ \delta_Z $ and $ \delta_m $ come into play only at $ \smo(\lambda)^2 $ with diagrams:
\begin{equation*}
  \begin{tikzpicture}[baseline = (r.base)]
    \begin{feynman}[inline = (r.base)]
      \vertex (x1) {};
      \vertex[below=3em of x1] (p1) {};
      \vertex[below=3em of p1] (x2) {};

      \vertex[right=3em of p1, dot] (v1) {};
      \vertex[right=5em of v1, dot] (v2) {};

      \vertex[right=3em of v2] (p2) {};
      \vertex[above=3em of p2] (x3) {};
      \vertex[below=3em of p2] (x4) {};

      \vertex[above=0.5em of v1] (r) {};

      \diagram* {
        (p1) -- [scalar] (v1),
        (v2) -- [scalar] (p2),

        (v1) -- [scalar, half left] (v2),
        (v2) -- [scalar, half left] (v1),
        (v1) -- [scalar] (v2),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad + \quad
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};
      \vertex[right=4cm of a1] (a2) {};
      \vertex[below=4em of a1] (b1) {};
      \vertex[below=4em of a2] (b2) {};
      \vertex[below=2em of a1] (c1) {};
      \vertex[right=2cm of c1, crossed dot] (c2) {};

      \vertex[left = 2cm of c2] (d1) {};
      \vertex[right = 2cm of c2] (d2) {};
      \vertex[above = 2cm of c2] (d3);

      \vertex[above=1.1cm of c2] (r);

      \diagram* {
        (d1) -- [scalar] (c2) -- [scalar] (d2),
        (c2) -- [scalar, half left] (d3) -- [scalar, half left] (c2),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad + \quad
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};
      \vertex[right=4cm of a1] (a2) {};
      \vertex[below=4em of a1] (b1) {};
      \vertex[below=4em of a2] (b2) {};
      \vertex[below=2em of a1] (c1) {};
      \vertex[right=2cm of c1, crossed dot] (c2) {};

      \vertex[left = 2cm of c2] (d1) {};
      \vertex[right = 2cm of c2] (d2) {};

      \vertex[below=2.2em of a1] (r);

      \diagram* {
        (d1) -- [scalar] (c2) -- [scalar] (d2),
      };
    \end{feynman}
  \end{tikzpicture}
\end{equation*}
This means that:
\begin{equation}
  \delta_\lambda = 1 + \smo(\lambda)
  \qquad \qquad
  \delta_Z = 1 + \smo(\lambda^2)
  \qquad \qquad
  \delta_m = 1 + \smo(\lambda^2)
\end{equation}
agreeing with \secref{sssec:lag-count}. Tadpoles produced by the physical vertex (not the counterterm) should be considered too, but, as per \lref{lemma:tadpole-resumm}, they only contribute as a shift between $ m $ and $ m_0 $.

\newpage

\section{Renormalization of QED}

Recall the QED Lagrangian in the Landau gauge ($ \lambda = 0 $):
\begin{equation}
  \lag_\text{QED} = - \frac{1}{4} F_{\mu \nu} F^{\mu \nu} + \bar{\Psi} \left( \img \slashed{\pa} - m_0 \right) \Psi - e_0 \bar{\Psi} \slashed{A} \Psi
  \label{eq:qed-lagrangian}
\end{equation}
which is implicitly assumed to be normal-ordered. The interaction between the fermion field $ \Psi $ and the gauge field $ A_\mu $ is expressed by the interaction Lagrangian $ \lag_\text{int} = - e_0 \bar{\psi} \slashed{A} \psi $, which depends on the bare coupling $ e_0 $.

\begin{observation}{Renormalizablity of QED}{}
  Consider the QED Lagrangian \eref{eq:qed-lagrangian} in $ d \in \R^+ $ dimensions. Then, imposing $ [\lag_\text{QED}] = d $ and $ [m_0] = [\slashed{\pa}] = 1 $, it is trivial to see that:
  \begin{equation}
    [A_\mu] = \frac{d - 2}{2}
    \qquad
    [\Psi] = \frac{d - 1}{2}
    \qquad
    [e_0] = \frac{4 - d}{2}
  \end{equation}
  which hints to the fact that QED is renormalizable only for $ d \leq 4 $. To verify this, compute the superficial degree of divergence of a diagram with $ L $ loops, $ P_\text{b} $ bosonic propagators and $ P_\text{f} $ fermionic propagator:
  \begin{equation*}
    D = d L - 2 P_\text{b} - P_\text{f}
  \end{equation*}
  Recalling \lref{lemma:loop-number}, the loop number can be expressed as $ L = P_\text{b} + P_\text{f} - V + 1 $, so:
  \begin{equation*}
    D = d - d V + (d - 2) P_\text{b} + (d - 1) P_\text{f}
  \end{equation*}
  Finally, noting that each vertex has $ 2 $ fermionic lines and $ 1 $ bosonic line, i.e. $ 2V = 2 P_\text{f} + N_\text{f} $ and $ V = 2 P_\text{b} + N_\text{b} $, the following relation is found:
  \begin{equation}
    D = d + \frac{d - 4}{2} V - \frac{d - 2}{2} N_\text{b} - \frac{d - 1}{2} N_\text{f}
    \label{eq:sup-div-qed}
  \end{equation}
  Clearly, then, if $ d > 4 $ there is an infinite number of classes of diverging diagrams, since $ D $ increases as $ V $ increases. On the contrary, for $ d = 4 $ QED is renormalizable, as there are only a finitely-many classes of diverging diagrams (those with $ N_\text{b} + \frac{3}{2} N_\text{f} \leq 4 $), while for $ d < 4 $ it is super-renormalizable, as there are only finitely-many diverging diagrams.
\end{observation}

By \eref{eq:s-t-matrix}, the $ S $-matrix element for a generic scattering process $ \ket{\text{i}} \ra \ket{\text{f}} $ is $ S_\text{if} = \delta_\text{if} + \img T_\text{if} $. Assuming a non-trivial scattering, the significant quantity is the $ T $-matrix element, which can be computed from the LSZ formula and is found to be (\eref{eq:mat-el}):
\begin{equation}
  \img T_\text{if} = (2\pi)^4 \delta^{(4)}(p_\text{f} - p_\text{i}) \img \mat_\text{if}
\end{equation}
where the matrix element $ \mat_\text{if} $ receives contributions from all the diagrams arising from the possible contractions determined by Wick's theorem (\tref{th:wick-boson} and \tref{th:wick-fermion}). In particular, due to \eref{eq:corr-func-pert}, this contributions arrange themselves in a power series of the coupling constant, $ e_0 $ in the case of QED, hence the general matrix element can be written as:
\begin{equation}
  \mat_\text{if} = \sum_{n \in \N} \mat_\text{if}^{(n)}
\end{equation}
with $ \mat_\text{if}^{(n)} \propto e_0^n $. Note that the power series is over $ \N $ and not $ \N_0 $, since diagrams without interactions are disconnected (except for propagators) and do not contribute to $ S_\text{if} $.

\begin{example}{Corrections to the photon propagator}{}
  Consider the propagator of the gauge field $ A_\mu $. In the free theory, it is simply given by \eref{eq:photon-propagator}, while in an interacting theory it becomes:
  \begin{equation*}
    \gpr_{\mu \nu}(x - y) \equiv \braket{0 | \tempord\{A_\mu(x) A_\nu\}(y) | 0} = \sum_{n = 0}^\infty \frac{\img^n}{n!} \braket{0 | \tempord\{ {A_I}_\mu(x) {A_I}_\nu(y) \lag_I(x_1) \dots \lag_I(x_n) \} | 0}
  \end{equation*}
  where \eref{eq:corr-func-pert} was used (with the conventional normalization to ignore vacuum-to-vacuum diagrams). For ease of notation, in the following all fields are understood to be in the interaction picture. Specializing the computation for QED:
  \begin{equation*}
    \gpr_{\mu \nu}(x - y) \hspace{-0.1em} = \hspace{-0.1em} \sum_{n = 0}^\infty \frac{(- \img e_0)^n}{n!} \hspace{-0.2em} \int \hspace{-0.2em} \dd x_1 \dots \dd x_n \braket{0 | \tempord\{ A_\mu(x) A_\nu(y) j^{\alpha_1} \hspace{-0.1em} (x_1) A_{\alpha_1} \hspace{-0.1em} (x_1) \dots j^{\alpha_n} \hspace{-0.1em} (x_n) A_{\alpha_n} \hspace{-0.1em} (x_n) \} | 0}
  \end{equation*}
  where the fermionic vector current is defined as $ j^\mu \defeq \bar{\Psi} \gamma^\mu \Psi $. Now, it is possible to apply Wick's theorem: e.g. up to $ \smo(e_0^2) $ order:
  \begin{equation*}
      \gpr_{\mu \nu}(x - y)
      =
      \begin{tikzpicture}[baseline = (r.base)]
        \begin{feynman}[inline = (r.base)]
          \vertex [dot] (a) {};
          \vertex (la) at ($ (a) + (-0.4 , 0) $) {$ \mu $};
          \vertex (lax) at ($ (a) + (0 , 0.4) $) {$ x $};

          \vertex [right = 2cm of a, dot] (b) {};
          \vertex (lb) at ($ (b) + (0.4 , 0) $) {$ \nu $};
          \vertex (lby) at ($ (b) + (0 , 0.4) $) {$ y $};

          \vertex [below = 0.1em of a] (r);

          \diagram* {
            (a) -- [photon] (b),
          };
        \end{feynman}
      \end{tikzpicture}
      \quad + \quad
      \begin{tikzpicture}[baseline = (r.base)]
        \begin{feynman}[inline = (r.base)]
          \vertex [dot] (a) {};
          \vertex (la) at ($ (a) + (-0.4 , 0) $) {$ \mu $};
          \vertex (lax) at ($ (a) + (0 , 0.4) $) {$ x $};

          \vertex [right = 1cm of a, dot] (v1) {};
          \vertex (l1x) at ($ (v1) + (-0.2 , -0.3) $) {$ x_1 $};

          \vertex [right = 1cm of v1, dot] (v2) {};
          \vertex (l2x) at ($ (v2) + (0.25 , -0.3) $) {$ x_2 $};

          \vertex [right = 1cm of v2, dot] (b) {};
          \vertex (lb) at ($ (b) + (0.4 , 0) $) {$ \nu $};
          \vertex (lby) at ($ (b) + (0 , 0.4) $) {$ y $};

          \vertex [below = 0.1em of a] (r);

          \diagram* {
            (a) -- [photon] (v1),
            (v1) -- [fermion, half left] (v2) -- [fermion, half left] (v1),
            (v2) -- [photon] (b),
          };
        \end{feynman}
      \end{tikzpicture}
      \quad + \quad \smo(e_0^4)
  \end{equation*}
  since, due to the form of the interaction vertex $ \lag_\text{int} \sim A_\mu $, only terms with $ n \in \N_0 $ even give non-vanishing contributions. Therefore, all power series in QED can be expressed either in terms of the coupling constant $ e_0 $ or of the structure constant $ \alpha_0 \equiv \frac{e^2}{4\pi} $: indeed, it is useful to define the following notation for $ n \in \N_0 $ (highest number of loops in the corrections):
  \begin{equation}
    \gpr_{\mu \nu}(x - y) \equiv \gpr_{\mu \nu} \od n (x - y) + \smo(\alpha_0^{n+1})
  \end{equation}
  Note that the power series for the propagator can be rearranged as follows:
  \begin{equation}
    \gpr_{\mu \nu} = \,\,
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex [dot] (a) {};
        \vertex [right = 2cm of a, dot] (b) {};

        \vertex [below = 0.1cm of a] (r);

        \diagram* {
          (a) -- [photon] (b),
        };
      \end{feynman}
    \end{tikzpicture}
    \quad + \quad
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex [dot] (a) {};

        \vertex [right = 1.2cm of a, blob] (v) {};

        \vertex [right = 1.2cm of v, dot] (b) {};

        \vertex [below = 0.1cm of a] (r);

        \diagram* {
          (a) -- [photon] (v) -- [photon] (b),
        };
      \end{feynman}
    \end{tikzpicture}
    \quad + \quad
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex [dot] (a) {};

        \vertex [right = 1.2cm of a, blob] (v1) {};
        \vertex [right = 1.2cm of v1, blob] (v2) {};

        \vertex [right = 1.2cm of v2, dot] (b) {};

        \vertex [below = 0.1cm of a] (r);

        \diagram* {
          (a) -- [photon] (v1) -- [photon] (v2) -- [photon] (b),
        };
      \end{feynman}
    \end{tikzpicture}
    \quad + \quad \dots
    \label{eq:photon-propagator-series}
  \end{equation}
  \begin{equation}
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex (a) {};

        \vertex [right = 0.7cm of a, blob] (v) {};

        \vertex [right = 0.7cm of v] (b) {};

        \vertex [below = 0.1cm of a] (r);

        \diagram* {
          (a) -- [photon] (v) -- [photon] (b),
        };
      \end{feynman}
    \end{tikzpicture}
    \, = \,
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex (a) {};

        \vertex [right = 0.7cm of a, dot] (v1) {};
        \vertex [right = 1.5cm of v1, dot] (v2) {};

        \vertex [right = 0.7cm of v2] (b) {};

        \vertex [below = 0.1cm of a] (r);

        \diagram* {
          (a) -- [photon] (v1),
          (v2) -- [photon] (b),

          (v1) -- [fermion, half left] (v2) -- [fermion, half left] (v1),
        };
      \end{feynman}
    \end{tikzpicture}
    \, + \,
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex (a) {};

        \vertex [right = 0.7cm of a, dot] (v1) {};
        \vertex [right = 1.5cm of v1, dot] (v2) {};

        \vertex [dot] (i1) at ($ (v1) + (0.75 , 0.71) $) {};
        \vertex [dot] (i2) at ($ (v1) + (0.75 , -0.71) $) {};

        \vertex [right = 0.7cm of v2] (b) {};

        \vertex [below = 0.1cm of a] (r);

        \diagram* {
          (a) -- [photon] (v1),
          (v2) -- [photon] (b),

          (v1) -- [fermion, quarter left] (i1) -- [fermion, quarter left] (v2),
          (v2) -- [fermion, quarter left] (i2) -- [fermion, quarter left] (v1),

          (i1) -- [photon] (i2),
        };
      \end{feynman}
    \end{tikzpicture}
    \, + \,
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex (a) {};

        \vertex [right = 0.7cm of a, dot] (v1) {};
        \vertex [right = 2.5cm of v1, dot] (v2) {};

        \vertex [dot] (i1) at ($ (v1) + (0.75 , 0.71) $) {};
        \vertex [dot] (i2) at ($ (v1) + (0.75 , -0.71) $) {};

        \vertex [right = 1cm of i1, dot] (i3) {};
        \vertex [right = 1cm of i2, dot] (i4) {};

        \vertex [right = 0.7cm of v2] (b) {};

        \vertex [below = 0.1cm of a] (r);

        \diagram* {
          (a) -- [photon] (v1),
          (v2) -- [photon] (b),

          (v1) -- [fermion, quarter left] (i1) -- [fermion] (i3),
          (i3) -- [fermion, quarter left] (v2),
          (v2) -- [fermion, quarter left] (i4) -- [fermion] (i2),
          (i2)-- [fermion, quarter left] (v1),

          (i1) -- [photon] (i2),
          (i3) -- [photon] (i4),
        };
      \end{feynman}
    \end{tikzpicture}
    \, + \, \dots
    \label{eq:photon-propagator-corrections}
  \end{equation}
  Hence, each blob is itself a power series in $ \alpha_0 $.
\end{example}

From \eref{eq:sup-div-qed} it is possible to state all relevant classes of diverging diagrams in $ d = 4 $ QED:
\begin{equation*}
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex (a) {};

        \vertex [right = 1.2cm of a, blob] (v) {};

        \vertex [right = 1.2cm of v] (b) {};

        \vertex [below = 0.1cm of a] (r);

        \diagram* {
          (a) -- [photon] (v) -- [photon] (b),
        };
      \end{feynman}
    \end{tikzpicture}
    \qquad \qquad
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex (a) {};

        \vertex [right = 1.2cm of a, blob] (v) {};

        \vertex [right = 1.2cm of v] (b) {};

        \vertex [below = 0.1cm of a] (r);

        \diagram* {
          (a) -- [fermion] (v) -- [fermion] (b),
        };
      \end{feynman}
    \end{tikzpicture}
    \qquad \qquad
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex (a) {};

        \vertex [right = 1.2cm of a, blob] (v) {};

        \vertex [right = 1.2cm of v] (b) {};

        \vertex [above = 0.6cm of b] (c) {};
        \vertex [below = 0.6cm of b] (d) {};

        \vertex [below = 0.1cm of a] (r);

        \diagram* {
          (a) -- [photon] (v),
          (v) -- [fermion] (c),
          (v) -- [anti fermion] (d),
        };
      \end{feynman}
    \end{tikzpicture}
\end{equation*}

\subsection{Running coupling}

For example, consider the Coulomb scattering $ e^- e^- \ra e^- e^- $, which at lowest order is:
\begin{equation*}
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (a1) {};

      \vertex[right=3.5cm of a1] (a2) {};

      \vertex[below=1.2cm of a1] (b1) {};

      \vertex[below=1.2cm of a2] (b2) {};

      \vertex[below=0.6cm of a1] (c1) {};

      \vertex[right=1cm of c1, dot] (c2) {};

      \vertex[right=1.5cm of c2, dot] (c3) {};

      \vertex[below=0.1em of c1] (r);

      \diagram* {
        (a1) -- [fermion] (c2),
        (c2) -- [fermion] (b1),

        (a2) -- [fermion] (c3),
        (c3) -- [fermion] (b2),

        (c2) -- [photon, momentum = \(q\)] (c3),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad \equiv
  \img \mat_0 (q^2) = \frac{e_0^2}{q^2}
\end{equation*}
Including the correction to the photon propagator as in \eref{eq:photon-propagator-series}, the measured total matrix element is:
\begin{equation*}
  \mat = \mat_0 \sum_{n = 0}^\infty (\Pi \mat_0)^n = \mat_0 (1 - \Pi \mat_0)^{-1} = (\mat_0 - \Pi)^{-1}
\end{equation*}
where $ \Pi(q^2) $ is the matrix element for the corrections in \eref{eq:photon-propagator-corrections}. Defining the measured electric charge at momentum transfer $ q $ as $ \mat \equiv e^2(q^2) / q^2 $, the previous manipulation of the formal power series yields a relation between the measured coupling and the bare coupling:
\begin{equation}
  \frac{1}{e^2(q^2)} = \frac{1}{e_0^2} - \frac{\Pi(q^2)}{q^2}
  \label{eq:phys-bar-charge}
\end{equation}
Since $ \Pi(q^2) $ is a power series in $ e_0^2 $, this relation can be inverted, so as to express $ e_0^2 = e_0^2(e_2) $: most notably, the expression of the bare coupling in terms of the physical coupling is independent of the energy scale $ q^2 $.

Moreover, note that all empirical measurements really are comparisons between different measurements, and this is reflected by \eref{eq:phys-bar-charge}. Indeed, suppose to measure the physical electric charge at two different energy scales $ q^2 $ and $ \mu^2 $; then, the relation between the two measurements is, defining $ \pi(q^2) \equiv \Pi(q^2) / q^2 $:
\begin{equation}
  \frac{1}{e^2(q^2)} - \frac{1}{e^2(\mu^2)} = \pi(\mu^2) - \pi(q^2)
  \label{eq:charge-run}
\end{equation}
which is correctly independent of the unobservable bare electric charge. This relation is known as the ``running" of the coupling, as it determines the dependence of the physical coupling on the energy scale (which can be tested, and has been verified, experimentally).

\begin{proposition}{Vacuum polarization}{}
  At 1-loop order in dimensional regularization, the \bcprop{vacuum polarization} is:
  \begin{equation}
    \pi\od1(q^2) = \frac{e_0^2}{2\pi^2} (4\pi)^\epsilon \Gamma(\epsilon) \int_0^1 \dd x \, x (1 - x) \Delta^{-\epsilon}
  \end{equation}
  with $ \Delta \equiv m^2 - x(1 - x) q^2 $.
\end{proposition}

\begin{proofbox}
  \begin{proof}
    At 1-loop order, \eref{eq:photon-propagator-corrections} reduces to:
    \begin{equation*}
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex (a) {};
        \vertex (l1) at ($ (a) + (-0.1 , 0) $) {$ \mu $};

        \vertex [right = 1.5cm of a, dot] (v1) {};
        \vertex [right = 1.5cm of v1, dot] (v2) {};

        \vertex [right = 1.5cm of v2] (b) {};
        \vertex (l2) at ($ (b) + (0.1 , 0) $) {$ \nu $};

        \vertex [below = 0.1cm of a] (r);

        \diagram* {
          (a) -- [photon, momentum = $ q $] (v1),
          (v2) -- [photon, momentum = $ q $] (b),

          (v1) -- [fermion, half left] (v2) -- [fermion, half left] (v1),
        };
      \end{feynman}
    \end{tikzpicture}
    \ \equiv \img \Pi\od1_{\mu \nu}(q^2)
    \end{equation*}
    Hence, recalling that fermionic loops determine an additional $ (-1) $ factor:
    \begin{equation*}
      \begin{split}
        \img \Pi\od1_{\mu \nu}(q^2)
        & = (-\img e_0)^2 (-1) \int \frac{\dd^4 k}{(2\pi)^4} \frac{\tr \{ \gamma_\mu \img (\slashed{k} + m) \gamma_\nu \img (\slashed{k} + \slashed{q} + m) \}}{(k^2 - m^2 + \img \epsilon) ((k + q)^2 - m^2 + \img \epsilon)} \\
        & = - 4 e_0^2 \int \frac{\dd^4 k}{(2\pi)^4} \frac{2 k_\mu k_\nu + k_\mu q_\nu + q_\mu k_\nu - \eta_{\mu \nu} (k^2 + k \cdot q - m^2)}{(k^2 - m^2 + \img \epsilon) (k^2 + 2 k \cdot q + q^2 - m^2 + \img \epsilon)}
      \end{split}
    \end{equation*}
    Introducing Feynman parameters (\lref{lemma:feynman-parameters}):
    \begin{equation*}
      \begin{split}
        \Pi\od1_{\mu \nu}(q^2)
        & = 4\img e_0^2 \int_0^1 \dd x \int \frac{\dd^4 \ell}{(2\pi)^4} \big[ 2 \ell_\mu \ell_\nu + (1 - 2x) (\ell_\mu q_\nu + \ell_\nu q_\mu) - 2x (1 - x) q^\mu q^\nu + \\
        & \qquad \qquad \qquad \qquad \qquad - \eta_{\mu \nu} (\ell^2 + (1 - 2x) \ell \cdot q - x (1 - x) q^2 - m^2) \big] (\ell^2 - \Delta + \img \epsilon)^{-2}
      \end{split}
    \end{equation*}
    where the integration has been shifted to $ \ell = k + x q $, with $ \Delta \equiv m^2 - x (1 - x) q^2 $. Note that both the integration measure and the denominator are even under $ \ell \ra - \ell $, hence all terms with an odd numerator vanish (i.e. the linear terms in $ \ell $, in this case). Then, the integral can be broken up into two contributions:
    \begin{equation*}
      \begin{split}
        \Pi\od1_{\mu \nu}(q^2)
        & = 4\img e_0^2 \int_0^1 \dd x \bigg[ \int \frac{\dd^4 \ell}{(2\pi^4)} \frac{2 \ell_\mu \ell_\nu - \eta_{\mu \nu} \ell^2}{(\ell^2 - \Delta + \img \epsilon)^2} + \\
        & \qquad \qquad \qquad + (\eta_{\mu \nu} (m^2 + x (1 - x) q^2) - 2x (1 - x) q^\mu q^\nu) \int \frac{\dd^4 \ell}{(2\pi)^4} \frac{1}{(\ell^2 - \Delta + \img \epsilon)^2} \bigg]
      \end{split}
    \end{equation*}
    The second integral is in the form of \eref{eq:int-dn}, while the first one requires additional treatment.

    \begin{lemma}[before upper = {\tcbtitle}, borderline = {1pt}{0pt}{blue!35!black}]{}{generalized-d-int}
      \begin{equation}
        \int \frac{\dd^d k}{(2\pi)^d} \frac{k^{2m}}{(k^2 - \Delta + \img \epsilon)^n} = \frac{\img (-1)^{n + m}}{(4\pi)^{d/2}} \frac{\Gamma(n - \frac{d}{2} - m) \Gamma(\frac{d}{2} + m)}{\Gamma(\frac{d}{2}) \Gamma(n)} \Delta^{-n + \frac{d}{2} + m}
        \label{eq:int-dn-gen}
      \end{equation}
    \end{lemma}

    \begin{proofbox}
      \begin{proof}
        Performing a Wick rotation:
        \begin{equation*}
          \int \frac{\dd^d k}{(2\pi)^d} \frac{k^{2m}}{(k^2 - \Delta + \img \epsilon)^n} = \img (-1)^{n + m} \int \frac{\dd^d \ell_\text{E}}{(2\pi)^d} \frac{\ell_\text{E}^{2m}}{(\ell_\text{E}^2 + \Delta - \img \epsilon)^n}
        \end{equation*}
        Parametrizing the Euclidean domain of integration $ \R^d $ with spherical coordinates and using \eref{eq:solid-angle}:
        \begin{equation*}
          \int \frac{\dd^d k}{(2\pi)^d} \frac{k^{2m}}{(k^2 - \Delta + \img \epsilon)^n} = \frac{2 \img (-1)^{n + m}}{(4\pi)^{d/2} \Gamma(\frac{d}{2})} \int_{\R^+} \dd \ell \frac{\ell^{2m + d - 1}}{(\ell^2 + \Delta)^n}
        \end{equation*}
        Recalling \eref{eq:auxiliary-integral} yields the thesis.
      \end{proof}
    \end{proofbox}

    Now, recall the following identity for tensorial momentum integrals, valid for a general integrable $ f(k^2) $:
    \begin{equation}
      \int \dd^d k \, k^\mu k^\nu f(k^2) = \frac{1}{d} \eta^{\mu \nu} \int \dd^d k \, k^2 f(k^2)
    \end{equation}
    which is a consequence of Lorentz invariance. With this identity, the numerator of the first integral becomes $ \eta_{\mu \nu} (1 - 2/d) \ell^2 $, so that, by \eref{eq:int-dn-gen}:
    \begin{equation*}
      \begin{split}
        \Pi\od1_{\mu \nu}(q^2) = 8e_0^2 (q_\mu q_\nu - \eta_{\mu \nu} q^2) \int_0^1 \dd x \, x (1 - x) \frac{\Gamma(2 - \frac{d}{2})}{(4\pi)^{d/2}} \Delta^{d - 4} \equiv \left( \eta_{\mu \nu} - \frac{q_\mu q_\nu}{q^2} \right) \Pi(q^2)
      \end{split}
    \end{equation*}
    where the transverse projector has been factored out. Then:
    \begin{equation*}
      \pi\od1(q^2) \equiv \frac{\Pi(q^2)}{q^2} = 8e_0^2 \int_0^1 \dd x \, x (1 - x) \frac{\Gamma(2 - \frac{d}{2})}{(4\pi)^{d/2}} \Delta^{d - 4}
    \end{equation*}
    Inserting \eref{eq:dim-reg} yields the thesis.
  \end{proof}
\end{proofbox}

The Laurent series in $ \epsilon $ of the vacuum polariazione then reads:
\begin{equation}
  \pi\od1(q^2) = - \frac{\alpha_0}{3\pi} \left( \frac{1}{\epsilon} - \gamma_\text{E} + \log 4\pi \right) + \frac{2\alpha_0}{\pi} \int_0^1 \dd x \, x (1 - x) \log \Delta + \smo(\epsilon)
\end{equation}
which clearly shows that the pole term at 1-loop order does not depend on the energy scale $ q^2 $, ensuring that \eref{eq:charge-run} is finite. This is a feature of all loop orders\footnotemark, and it can be shown that:
\begin{equation}
  \pi(\mu^2) - \pi(q^2) = \frac{1}{12\pi^2} \log \frac{q^2}{\mu^2}
\end{equation}
so that the running of the running of the physical coupling reads:
\begin{equation}
  \alpha(q^2) = \frac{\alpha(\mu^2)}{1 - \frac{\alpha(\mu^2)}{3\pi} \log \frac{q^2}{\mu^2}}
\end{equation}
which is precisely the empirically-observed dependence.

\footnotetext{This is to be expected: in fact, the divergences encapsulated in the $ \epsilon $-poles are UV divergences, and in the UV limit $ q^2 $ and $ \mu^2 $ become equal, since they both $ q^2 , \mu^2 \ra \infty $.}

\begin{observation}{Vacuum polarization and charge screening}{}
  Consider corrections to the photon propagator like:
  \begin{equation*}
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex (a) {};
        \vertex (l1) at ($ (a) + (-0.1 , 0) $) {$ \mu $};

        \vertex [right = 1.5cm of a, dot] (v1) {};
        \vertex [right = 1.5cm of v1, dot] (v2) {};

        \vertex [right = 1.5cm of v2] (b) {};
        \vertex (l2) at ($ (b) + (0.1 , 0) $) {$ \nu $};

        \vertex [below = 0.1cm of a] (r);

        \diagram* {
          (a) -- [photon, momentum = $ q $] (v1),
          (v2) -- [photon, momentum = $ q $] (b),

          (v1) -- [fermion, half left] (v2) -- [fermion, half left] (v1),
        };
      \end{feynman}
    \end{tikzpicture}
  \end{equation*}
  The physical interpretation of these corrections is that the vacuum is filled with virtual electric dipoles, hence the name of \bcobs{vacuum polarization}. In particular, in presence of an electric charge, e.g. a proton, these virtual dipoles orient themselves according to said charge, thus resulting in a screening of the Coulomb potential: this phenomenon is known as \emph{charge screening}.
\end{observation}

The running of the physical electric charge shows the effectiveness of the renormalization procedure: absorbing UV divergences into bare observables and then expressing all quantities in terms of physical observables yields the correct finite results.

\subsubsection{Anomalous magnetic moment}

Another important class of diverging diagrams in QED is the electron-photon vertex, which at 1-loop order can be written as:
\begin{equation*}
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex (a) {};
        \vertex (l) at ($ (a) + (-0.1 , 0) $) {$ \mu $};

        \vertex [right = 1.8cm of a, blob] (v) {};

        \vertex [right = 1.4cm of v] (b) {};

        \vertex [above = 1cm of b] (c) {};
        \vertex [below = 1cm of b] (d) {};

        \vertex [below = 0.1cm of a] (r);

        \diagram* {
          (a) -- [photon, momentum = $ q $] (v),
          (v) -- [fermion] (c),
          (v) -- [anti fermion] (d),
        };
      \end{feynman}
    \end{tikzpicture}
    \ = \
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex (a) {};
        \vertex (l) at ($ (a) + (-0.1 , 0) $) {$ \mu $};

        \vertex [right = 1.8cm of a, dot] (v) {};

        \vertex [right = 1.4cm of v] (b) {};

        \vertex [above = 1cm of b] (c) {};
        \vertex [below = 1cm of b] (d) {};

        \vertex [below = 0.1cm of a] (r);

        \diagram* {
          (a) -- [photon, momentum = $ q $] (v),
          (v) -- [fermion] (c),
          (v) -- [anti fermion] (d),
        };
      \end{feynman}
    \end{tikzpicture}
    \ + \
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex (a) {};
        \vertex (l) at ($ (a) + (-0.1 , 0) $) {$ \mu $};

        \vertex [right = 1.8cm of a, dot] (v) {};

        \vertex [right = 1.4cm of v] (b) {};

        \vertex [above = 1cm of b] (c) {};
        \vertex [below = 1cm of b] (d) {};

        \vertex [dot] (v1) at ($ (v) + (0.7 , 0.5) $) {};
        \vertex [dot] (v2) at ($ (v) + (0.7 , -0.5) $) {};

        \vertex [below = 0.1cm of a] (r);

        \diagram* {
          (a) -- [photon, momentum = $ q $] (v),
          (v) -- [fermion] (v1) -- [fermion] (c),
          (d) -- [fermion] (v2) -- [fermion] (v),
          (v1) -- [photon] (v2),
        };
      \end{feynman}
    \end{tikzpicture}
    \ \equiv - \img e \Gamma\od1_\mu(q)
\end{equation*}
where the dependence on $ q $ only is to be proved. Note that vacuum polarization and electron self-energy diagrams (see later) have been omitted: these are indeed only corrections to the photon and electron propagators, and are accounted for by using the physical charge and mass of the electron.

\begin{lemma}{Generalized vertex function}{}
  The electron-photon vertex function can be expressed as:
  \begin{equation}
    \Gamma^\mu(q) = \gamma^\mu F_1(q^2) + \frac{\img \sigma^{\mu \nu}}{2m} q_\nu F_2(q^2)
  \end{equation}
  where $ F_1(q^2) $ is the \bclemma{Dirac form factor} and $ F_2(q^2) $ is the \bclemma{Pauli form factor}.
\end{lemma}

\begin{proofbox}
  \begin{proof}
    Denoting the incoming and outgoing fermionic momenta with $ p $ and $ p' $, in general $ \Gamma^\mu $ is expressed in terms of $ \gamma^\mu $, since $ \Gamma\od0_\mu = \gamma_\mu $, of the 4-vectors $ p $ and $ p' $ and of the constants $ e $ and $ m $: note that this is the physical mass of the electrons, since the electron and the photon propagators are assumed to be renormalized, otherwise the general expression of the vertex function would include corrections to those propagators too. This is an exhaustive list, since no other objects appear in the Feynman rules for the diagrams involved\footnote{In principle $ \epsilon^{\mu \nu \rho \sigma} $ (or equivalently $ \gamma^5 $) could be present too, but it is forbidden by the fact that QED is a parity-conserving theory.}.

    The form of $ \Gamma^\mu $ is further constrained by Lorentz invariance. Indeed, it must transform as a 4-vector (in the sense of $ \gamma^\mu $, recall \tref{th:gamma-lorentz}), hence it can only be a linear combination of $ \gamma^\mu $, $ p^\mu $ and $ {p'}^\mu $, or, more conveniently, $ p'^\mu + p^\mu $ and $ p'^\mu - p^\mu $:
    \begin{equation*}
      \Gamma^\mu = A \gamma^\mu + B (p' + p)^\mu + C (p' - p)^\mu
    \end{equation*}
    A priori, the coefficients could contain $ \slashed{p} $ and $ \slashed{p}' $, but $ \slashed{p} u(p) = m u(p) $ and $ \bar{u}(p') \slashed{p'} = m \bar{u}(p') $ (note that $ \Gamma^\mu $ only has sense between Dirac spinors), hence it is possible to restrain the form of the coefficients to only contain ordinary scalars: the only non-trivial scalar available is $ q^2 = 2m^2 -2 p \cdot p' $, hence the coefficients can only be functions of $ q^2 $.

    Now, make use of the Ward identity $ q_\mu \Gamma^\mu = 0 $. The second term trivially vanishes, as does the first one since $ \bar{u}(p') (\slashed{p}' - \slashed{p}) u(p) = \bar{u}(p') (m - m) u(p) = 0 $: the only remaining term is the third one, which does not identically vanish, therefore $ C \equiv 0 $.

    Finally, it is customary to rewrite the $ B $ coefficient using the Gordon identity:
    \begin{equation}
      \bar{u}(p') \gamma^\mu u(p) = \bar{u}(p') \left[ \frac{p'^\mu + p^\mu}{2m} + \frac{\img \sigma^{\mu \nu}}{2m} q_\nu \right] u(p)
    \end{equation}
    so that the vertex function is expressed in the same form as in the thesis.
  \end{proof}
\end{proofbox}

The vertex function, and in particular the form factors, contains all the information on how an electron is influenced by an electromagnetic field. In presence of an external classical field $ A^\text{cl}_\mu(x) $, the QED Lagrangian is modified with an additional interaction term $ - e A^\text{cl}_\mu j^\mu $, and the $ S $-matrix element for the scattering of an electric from this field is:
\begin{equation*}
  \img \mat (2\pi) \delta(p'^0 - p^0) = - \img e \bar{u}(p') \Gamma^\mu(q) u(p) \tilde{A}^\text{cl}_\mu(q)
\end{equation*}
where $ \tilde{A}^\text{cl}_\mu(q) $ is the Fourier transform of $ A^\text{cl}_\mu(x) $. This expression is particularly useful to compute the Coulomb scattering amplitude of a non-relativistic electron from static fields.

\paragraph{Electrostatic field}

Suppose $ A^\text{cl}_\mu(x) = (\phi(\ve{x}) , \ve{0}) $. Then $ \tilde{A}^\text{cl}_\mu(q) = ((2\pi) \delta(q^0) \tilde{\phi}(\ve{q}) , \ve{0}) $, and the matrix element becomes:
\begin{equation*}
  \img \mat = - \img e \bar{u}(p') \Gamma^0(q) u(p) \tilde{\phi}(\ve{q})
\end{equation*}
Moreover, assume that $ \phi(\ve{x}) $ is slowly varying over a large (even macroscopic) region, so that $ \tilde{\phi}(\ve{q}) $ is peaked at $ \ve{q} = \ve{0} $. This allows to take the limit $ \ve{q} \ra \ve{0} $ (i.e. $ q \ra 0 $, since $ q^0 = 0 $) in the spinor matrix element, meaning that only the Dirac form factor contributes:
\begin{equation*}
  \bar{u}(p') \gamma^0 u(p) = u\dg(p') u(p) \approx 2E_\ve{p} {\xi'}\dg \xi \approx 2m {\xi'}\dg \xi
\end{equation*}
where \eref{eq:uv-spin-id} in the limit $ p' - p \ra 0 $ was used. Thus, the matrix element is expressed as:
\begin{equation*}
  \img \mat \approx - \img e F_1(0) \tilde{\phi}(\ve{q}) \cdot 2m {\xi'}\dg \xi
\end{equation*}
which is the Born approximation\footnotemark for the non-relativistic scattering from a potential of the form:
\begin{equation}
  V(\ve{x}) = - e F_1(0) \phi(\ve{x})
\end{equation}
This means that $ F_1(0) $ is the electric charge of the electron, in units of $ -e $: hence, it must be $ F_1(0) = 1 $. Note that $ \Gamma\od0(q) = \gamma^\mu $, i.e. at leading order already $ F_1\od0(q^2) = 1 $, thus radiative corrections to the electric form factor must vanish at $ q^2 = 0 $.

\footnotetext{In general, the Born approximation for the scattering  of an electron from a static potential $ V(\ve{x}) $ consists in modelling the incoming and outgoing electron asymptotic states as plane waves of defined momentum, so that the matrix element reads (with $ \ve{q} \equiv \ve{p}_\text{f} - \ve{p}_\text{i} $):
\begin{equation}
  \mat = \braket{\ve{p}_\text{f} , s_\text{f} | V(\ve{x}) | \ve{p}_\text{i} , s_\text{i}} = \int \dd^3 x \, e^{\img (\ve{p}_\text{f} - \ve{p}_\text{i}) \cdot \ve{x}} V(\ve{x}) \bar{u}^{s_\text{f}}(p_\text{f}) u^{s_\text{i}}(p_\text{i}) = \tilde{V}(\ve{q}) \bar{u}^{s_\text{f}}(p_\text{f}) u^{s_\text{i}}(p_\text{i})
\end{equation}}

\paragraph{Magnetostatic field}

Suppose $ A^\text{cl}_\mu(x) = (0 , A^\text{cl}_i(\ve{x})) $. Then $ \tilde{A}^\text{cl}_\mu(q) = (0 , (2\pi) \delta(q^0) \tilde{A}^\text{cl}_i(\ve{q})) $, and the matrix element becomes:
\begin{equation*}
  \img \mat = - \img e \bar{u}(p') \Gamma^i(q) u(p) \tilde{A}^\text{cl}_i(\ve{q}) = - \img e \bar{u}(p') \left[ \gamma^i F_1(q^2) + \frac{\img \sigma^{i \nu}}{2m} q_\nu F_2(q^2) \right] u(p) \tilde{A}^\text{cl}_i(\ve{q})
\end{equation*}
In the non-relativistic limit, keeping only terms which are linear in momenta:
\begin{equation*}
  u(p) \approx \sqrt{m}
  \begin{pmatrix}
    \left( 1 - \frac{\ve{q} \cdot \bs{\sigma}}{2m} \right) \xi \\
    \left( 1 + \frac{\ve{q} \cdot \bs{\sigma}}{2m} \right) \xi \\
  \end{pmatrix}
  \quad \implies \quad
  \bar{u}(p') \gamma^i u(p) \approx 2m {\xi'}\dg \left[ \frac{\ve{p}' \cdot \bs{\sigma}}{2m} \sigma^i + \sigma^i \frac{\ve{p} \cdot \bs{\sigma}}{2m} \right] \xi
\end{equation*}
This expression for the electric term can be further expanded using $ \sigma^i \sigma^j = \delta^{ij} \mt{I}_2 + \img \epsilon^{ijk} \sigma^k $, which result in a spin-independent term proportional to $ (p' + p)^i \mt{I}_2 $ and a spin-dependent term proportional to $ \epsilon^{ijk} (p' - p)^j \sigma^k $. The first term contributes to the usual kinetic operator from non-relativistic quantum mechanics and can be ignored in this treatment, hence only the spin-dependent term is retained:
\begin{equation*}
  \bar{u}(p') \gamma^i u(p) \approx 2m {\xi'}\dg \left[ \frac{-\img}{2m} \epsilon^{ijk} q^j \sigma^k \right] \xi
\end{equation*}
The magnetic term is already linear in momentum, hence it can be approximated with only the leading term in the expansion for the spinors:
\begin{equation*}
  \bar{u}(p') \frac{\img \sigma^{i \nu}}{2m} q_\nu u(p) \approx m
  \begin{pmatrix}
    {\xi'}\dg & {\xi'}\dg
  \end{pmatrix}
  \frac{\img}{2m} \epsilon^{ijk}
  \begin{bmatrix}
    \sigma^k & 0 \\ 0 & \sigma^k
  \end{bmatrix}
  q_j
  \begin{pmatrix}
    \xi \\ \xi
  \end{pmatrix}
  = 2m {\xi'}\dg \left[ \frac{-\img}{2m} \epsilon^{ijk} q^j \sigma^k \right] \xi
\end{equation*}
Thus, the linear spin-dependent contribution to the vertex function reads, as $ q \ra 0 $:
\begin{equation*}
  \img \mat \approx -2\img me {\xi'}\dg \frac{-\img}{2m} \epsilon^{ijk} q^j \sigma^k [F_1(0) + F_2(0)] \xi \tilde{A}^\text{cl}_i(\ve{q}) = 2\img me {\xi'}\dg \frac{\sigma^k}{2m} [F_1(0) + F_2(0)] \xi \tilde{B}^k(\ve{q})
\end{equation*}
where $ \tilde{B}^k(\ve{q}) \equiv \img \epsilon^{ijk} q^i \tilde{A}_\text{cl}^k(\ve{q}) $ is the Fourier transform of the magnetic field generated by the classical vector potential $ \ve{A}^\text{cl}(\ve{x}) $. Again, this matrix element can be interpreted as the Born approximation for the non-relativistic scattering of an electron from a potential of the form:
\begin{equation}
  V(\ve{x}) = - \bs{\mu} \cdot \ve{B}(\ve{x})
\end{equation}
with the electron magnetic moment defined as:
\begin{equation}
  \bs{\mu} = - \frac{e}{m} [F_1(0) + F_2(0)] \frac{\bs{\sigma}}{2} \equiv - g \frac{e}{2m} \ve{S}
\end{equation}
where $ \ve{S} \equiv \frac{\bs{\sigma}}{2} $. The \bctxt{Landé factor} is the found to be:
\begin{equation}
  g = 2 [F_1(0) + F_2(0)] = 2 + 2 F_2(0)
\end{equation}
Since $ F_2\od0(0) = 0 $, at leading order $ g\od0 = 2 $. To compute the first-order correction to the Landé factor, it is necessary to compute the magnetic form factor at leading order.

\begin{proposition}{Form factors}{}
  At 1-loop order in dimensional regularization, the Dirac and Pauli form factors are:
  \begin{equation}
    F_1\od1(q^2) = 1 + \frac{\alpha}{2\pi} (4\pi)^\epsilon \Gamma(\epsilon) \int_0^1 \dd x \int_0^1 \dd y \int_0^1 \dd z \, \delta(x + y + z - 1) \mathcal{K}(\epsilon,x,y,z,q^2,m^2) \Delta^{-\epsilon}
  \end{equation}
  \begin{equation}
    F_2\od1(q^2) = \frac{\alpha}{\pi} \int_0 \dd x \int_0^1 \dd y \int_0^1 \dd z \, \delta(x + y + z - 1) \frac{m^2 z (1 - z)}{m^2 (1 - z)^2 - xy q^2}
  \end{equation}
  with $ \Delta \equiv m^2 (1 - z)^2 - xy q^2 $ and the $ \epsilon $-finite function $ \mathcal{K} $ defined as:
  \begin{equation}
    \mathcal{K}(\epsilon,x,y,z,q^2,m^2) \equiv \left[ 1 - \epsilon + 2 \frac{\Gamma(1 - \epsilon)}{\Gamma(\epsilon)} \frac{(1-x)(1-y) q^2 + (1 - 4z + z^2) m^2}{m^2 (1-z)^2 - xy q^2} \right]
  \end{equation}
\end{proposition}

\begin{proofbox}
  \begin{proof}
    % TODO:
    Copy proof from OneNote
  \end{proof}
\end{proofbox}

Note that, in addition to the UV divergence encapsulated in $ \epsilon $, the electric form factor also presents an IR divergence on the light-cone $ q^2 = 0 $, which is usually regulated introducing a small photon mass $ \mu $.

The integral in the magnetic form factor is trivial on the light-cone $ q^2 = 0 $, and the resulting expression $ F_2(0) = \frac{\alpha}{2\pi} $ determines the first-order correction to the Landé factor:
\begin{equation*}
  g\od1 = 2 + \frac{\alpha}{\pi}
\end{equation*}
As of today, corrections up to the 5-loop order have been numerically computed:
\begin{equation*}
  \frac{g\od5 - 2}{2} = 0.0011596521816(7)
  \qquad \qquad
  \frac{g_\text{exp} - 2}{2} = 0.0011596521806(1)
\end{equation*}
This result makes QED the most precise physical theory currently available.

\newpage

\subsection{Renormalization conditions}

There is only one class of diverging diagrams that remains to be computed: the corrections to the electron propagator.

%\subsubsection{Renormalization group}










