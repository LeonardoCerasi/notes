\selectlanguage{english}

In the case of free Hamiltonians/Lagrangians, free-particle states are eigenstates of the Hamiltonian and they cannot interact. To describe interactions between particles, non-linear terms must be included in $ \ham / \lag $, which will couple Fourier modes (and particles that occupy them) to one another. \\
To preserve causality, these interaction terms must include only products of fields at the same spacetime point. Moreover, the discussion is restricted to terms which do not include derivatives of fields, so that $ \ham_\text{int} = - \lag_\text{int} $.

\begin{example}{$ \phi^4 $ theory}{}
  The so-called $ \phi^4 $ theory is a scalar field theory with an interaction term of the kind:
  \begin{equation}
    \lag = \frac{1}{2} \pa_\mu \phi \pa^\mu \phi - \frac{1}{2} m^2 \phi^2 - \frac{\lambda}{4!} \phi^4
  \end{equation}
  for $ \lambda \in \R $ a dimensionless coupling constant. This interaction describes the Higgs self-interaction in the Standard Model.
\end{example}

\section{Time evolution}

Consider a system described by a Hamiltonian $ H $. Two different ways of describing its time evolution are possible.

\subsection{Schrödinger picture}

In the Schrödinger picture, states are considered time-dependent and operators time-independent. Consider an initial state $ \ket{\psi(0)} \equiv \ket{\psi} $: its time-evolution is:
\begin{equation}
  \ket{\psi(t)} = e^{-i H t} \ket{\psi}
\end{equation}
In this picture, the amplitude for a process $ \ket{a(t_0)} \rightarrow \ket{b(t)} $ is:
\begin{equation}
  \mathcal{A} = \braket{b | e^{-i H (t - t_0)} | a} \eqdef \braket{b | S(t,t_0) | a}
  \label{eq:schr-ampl}
\end{equation}
In the $ t - t_0 \rightarrow \infty $ limit, $ S $ is known as \bctxt{$ S $-matrix}, and scattering amplitudes simply are its elements. This can be seen as an operator which realizes time evolution, as:
\begin{equation}
  \ket{\psi(t)} = S(t) \ket{\psi}
\end{equation}
where $ S(t) \equiv S(t,0) $.

\begin{proposition}{Unitarity of time evolution}{}
  $ S(t,t_0) $ is a unitary operator on $ \hilb $.
\end{proposition}

\begin{proofbox}
  \begin{proof}
    Consider a normalized initial state $ \ket{\psi} : \braket{\psi | \psi} = 1 $. Given a complete orthonormal eigenbasis $ \{\ket{n}\}_{n \in \N} $ of $ \hilb $, then it must be:
    \begin{equation}
      \sum_{n \in \N} \abs{\braket{n | S | \psi}}^2 = 1
    \end{equation}
    This can also be written as:
    \begin{equation}
      \sum_{n \in \N} \abs{\braket{n | S | \psi}}^2 = \sum_{n \in \N} \braket{\psi | S\dg | n} \braket{n | S | \psi} = \braket{\psi | S\dg S | \psi}
    \end{equation}
    Being $ \ket{\psi} $ arbitrary, it must be $ S\dg S = S S\dg = \id_\hilb $.
  \end{proof}
\end{proofbox}

The unitarity of the $ S $-matrix expresses the conservation of probabilities. Moreover, it can be decomposed as:
\begin{equation}
  S = \tens{I} + i T
\end{equation}
where the \bctxt{$ T $-matrix} contains the information on the interactions, while the identity $ \tens{I} $ only represents a part of the incident wave-packet unaffected by interactions.

\subsection{Heisenberg picture}

In the Heisenberg picture, states are considered time-independent and operators time-dependent. This picture is better suited for QFT, as fields (which are operators) depend both on $ \ve{x} $ and $ t $, therefore the Heisenberg picture is natural in light of Lorentz covariance. \\
Given a state $ \ket{\psi(t)} $ in the Schrödinger picture, in the Heisenberg picture it is defined as:
\begin{equation}
  \ket{\psi,t} \defeq e^{i H t} \ket{\psi(t)}
\end{equation}
which is manifestly time-independent. An operator $ \mathcal{O} $ in the Schrödinger picture instead becomes:
\begin{equation}
  \mathcal{O}(t) \defeq e^{i H t} \mathcal{O} e^{-i H t}
\end{equation}
The label $ t $ in the definition of state is necessary to distinguish whose operator the state is eigenstate of: in fact, in general $ \mathcal{O}(t) \neq \mathcal{O}(t') $ for $ t \neq t' $, so they will have different eigenstates too. \\
In the Heisenberg picture, the $ S $-matrix becomes:
\begin{equation}
  \braket{b | S(t,t_0) | a} = \braket{b,t | a,t_0}
\end{equation}

\section{Asymptotic theory}

On a macroscopic scale, interaction times are extremely small. Therefore, it is convenient to make an assumption, the \bctxt{adiabatic hypothesis}: while the interaction is described by $ \ham = \ham_0 + \ham_\text{int} $, where $ \ham_0 $ is the free Hamiltonian, in the far past and the far future $ \ham_\text{int} $ is adiabatically turned off, i.e. $ \ham \rightarrow \ham_0 $ as $ t \rightarrow \pm \infty $. Moreover, as the out-going states can represent in-coming states for a successive process, the two Fock spaces\footnotemark must be isomorphic, i.e. $ \fock_\text{in} \cong \fock_\text{out} $: in particular, this implies the uniqueness of the vacuum, as $ \ket{0_\text{in}} = \ket{0_\text{out}} \equiv \ket{0} $. This isomorphism is realized by $ S $-matrix $ S \equiv S(+\infty,-\infty) $ (recall \eref{eq:schr-ampl}):
%
\footnotetext{Formally, given a single-particle Hilbert space $ \hilb $, the Fock space is defined as the following completion:
\begin{equation}
  \fock_\nu(\hilb) \defeq \overline{\bigoplus_{n = 0}^\infty S_\nu \hilb^{\otimes n}}
\end{equation}
where $ S_\nu $ is the operator which symmetrizes ($ \nu = + $, for bosons) or antisymmetrizes ($ \nu = - $, for fermions) the tensors it acts upon. In general:
\begin{equation*}
  \fock_\nu(\hilb) = \C \oplus \hilb \oplus S_\nu(\hilb \otimes \hilb) \oplus S_\nu(\hilb \otimes \hilb \otimes \hilb) \oplus \dots
\end{equation*}
where $ S_\nu \hilb^{\otimes n} $ consists of $ n $-particle states ($ \C $ is the vacuum). A general state then is:
\begin{equation*}
  \ket{\Psi}_\nu = \sum_{n = 0}^{\infty} \ket{\Psi_n}_\nu = a \ket{0} \oplus \sum_{i} a_i \ket{\psi_i} \oplus \sum_{i,j} a_{ij} \ket{\psi_i , \psi_j}_\nu \oplus \dots
\end{equation*}
The need for this infinite sum to converge in $ \fock_\nu(\hilb) $ is solved by the completion, as it restricts the Fock space only to states with a finite inner-product-induced norm:
\begin{equation*}
  \norm{\ket{\Psi}_\nu}^2 = \sum_{n = 0}^{\infty} \braket{\Psi_n | \Psi_n}_\nu < \infty
\end{equation*}}
%
\begin{equation*}
  \braket{\beta_\text{out} | \alpha_\text{in}} = \braket{\beta_\text{in} | S\dg | \alpha_\text{in}}
  \qquad \Rightarrow \qquad
  \ket{\beta_\text{out}} = S \ket{\beta_\text{in}}
  \qquad \Rightarrow \qquad
  \phi_\text{out}(x) = S \phi_\text{in}(x) S\dg
\end{equation*}
where $ \phi_\text{in}(x) , \phi_\text{out}(x) $ are the free fields which generate $ \fock_\text{in} , \fock_\text{out} $. Note that, to preserve covariance, the $ S $-matrix must commute with Poincaré transformations.
The adiabatic hypothesis asserts then:
\begin{equation}
  \phi(x) \xrightarrow[t \rightarrow -\infty]{} \sqrt{Z} \phi_\text{in}(x)
  \qquad \qquad
  \phi(x) \xrightarrow[t \rightarrow +\infty]{} \sqrt{Z} \phi_\text{out}(x)
  \label{eq:adiabatic-hyp}
\end{equation}
where $ Z \in \C $ is a renormalization factor. These limits must be understood in the weak sense, as they are not operator equations, but they are only valid for each matrix element separately\footnotemark.
%
\footnotetext{If that wasn't the case, then canonical quantization would imply $ Z = 1 $, i.e. that $ \phi(x) $ is a free field. For details, see Sec. 5.1.2 of \cite{itz-zub}.}

\subsection{LSZ reduction formula}

\subsubsection{Scalar fields}

Consider a scattering process of a single species of neutral scalar particles. As the ladder operators of a free real scalar field can be expressed via \eref{eq:frsf-ladder} (which is time-independent, as of \pref{prop:kg-scal-prod-ind}), in the adiabatic hypothesis it is possible to define \bctxt{in-} and \bctxt{out-ladder operators}:
\begin{equation}
  \sqrt{2E_\ve{p}} {a_\ve{p}^\text{in,out}}\dg = -i \int_{t \rightarrow \mp \infty} \dd^3x\, e^{-i p_\mu x^\mu} \smlra{\pa}_0 \phi_\text{in,out}(x) = - \frac{i}{\sqrt{Z}} \lim_{t \rightarrow \mp \infty} \int \dd^3x\, e^{-i p_\mu x^\mu} \smlra{\pa}_0 \phi(x)
  \label{eq:in-out-lad-op}
\end{equation}
These operators respectively act on $ \fock_\text{in,out} $. Note that now these integrals are time-dependent, as they contain the interacting field and not the free fields: the relation between in- and out-ladder operators is therefore not trivial.

\begin{lemma}[before upper = {\tcbtitle}]{}{in-out-rel}
  \begin{equation}
    \sqrt{2E_\ve{p}} ({a_\ve{p}^\text{in}}\dg - {a_\ve{p}^\text{out}}\dg) = \frac{i}{\sqrt{Z}} \int \dd^4x\, e^{-i k_\mu x^\mu} (\Box + m^2) \phi(x)
    \label{eq:lsz-scal-op}
  \end{equation}
\end{lemma}

\begin{proofbox}
  \begin{proof}
    For any integrable $ f(t,\ve{x}) $ the following identity holds:
    \begin{equation}
      \left( \lim_{t \rightarrow +  \infty} - \lim_{t \rightarrow -\infty} \right) \int \dd^3x\, f(t,\ve{x}) = \int_{-\infty}^{+\infty} \dd t\, \frac{\pa}{\pa t} \int \dd^3x\, f(t,\ve{x})
      \label{eq:int-func-lemma}
    \end{equation}
    Applying this to $ f(t,\ve{x}) = -i Z^{-1/2} e^{-i k_\mu x^\mu} \smlra{\pa}_0 \phi(x) $ and using \eref{eq:in-out-lad-op}:
    \begin{equation*}
      \begin{split}
        \sqrt{2E_\ve{p}} ({a_\ve{p}^\text{in}}\dg - {a_\ve{p}^\text{out}}\dg)
        & = \frac{i}{\sqrt{Z}} \int \dd^4x\, \pa_0 \left[ e^{-i k_\mu x^\mu} \smlra{\pa}_0 \phi(x) \right] \\
        & = \frac{i}{\sqrt{Z}} \int \dd^4x\, \pa_0 \left[ e^{-i k_\mu x^\mu} \pa_0 \phi(x) - \phi(x) \pa_0 e^{-i k_\mu x^\mu} \right] \\
        & = \frac{i}{\sqrt{Z}} \int \dd^4x \left[ e^{-i k_\mu x^\mu} \pa_0^2 \phi(x) - \phi(x) \pa_0^2 e^{-i k_\mu x^\mu} \right] \\
        & = \frac{i}{\sqrt{Z}} \int \dd^4x \left[ e^{-i k_\mu x^\mu} \pa_0^2 \phi(x) - \phi(x) (\bs{\nabla}^2 - m^2) e^{-i k_\mu x^\mu} \right]
      \end{split}
    \end{equation*}
    where the last line follows from $ \pa_0^2 e^{-i k_\mu x^\mu} = - k_0^2 e^{-i k_\mu x^\mu} = (\ve{k}^2 - k^2) e^{-i k_\mu x^\mu} = (\bs{\nabla}^2 - m^2) e^{-i k_\mu x^\mu} $. In order to perform integration by parts, note that initial and final particle states are understood to be convoluted to form wave-packets, which are localized in space, while $ \phi(x) $ is not localized in time; hence, the second term can be integrated by parts twice, resulting in:
    \begin{equation*}
      \sqrt{2E_\ve{p}} ({a_\ve{p}^\text{in}}\dg - {a_\ve{p}^\text{out}}\dg) = \frac{i}{\sqrt{Z}} \int \dd^4x\, e^{-i k_\mu x^\mu} (\pa_0^2 - \bs{\nabla}^2 + m^2) \phi(x)
    \end{equation*}
    which is the thesis.
  \end{proof}
\end{proofbox}

Note that if $ \phi(x) $ were a free field, this operator would identically vanish: this is because the KG scalar product is time-independent in a free field theory, therefore the ladder operators too are time-independent. \\
It is now possible to write the amplitude for a generic scattering process (i.e. $ S $-matrix element). In particular, consider a process $ \ket{\ve{k}_1, \dots, \ve{k}_n; -\infty} \rightarrow \ket{\ve{p}_1, \dots, \ve{p}_m; + \infty} $ with $ \ve{k}_i \neq \ve{p}_j \,\,\forall i = 1, \dots, n,\, j = 1, \dots, m $: in this case, as there are no particles which remain unchanged by the interaction, the $ S $-matrix reduces to the $ T $-matrix.

\begin{theorem}{LSZ reduction formula for scalar fields}{lsz-scalar}
  The amplitude for $ \ket{\ve{k}_1 , \dots , \ve{k}_n; -\infty} \rightarrow \ket{\ve{p}_1 , \dots , \ve{p}_m; +\infty} : \ve{k}_i \neq \ve{p}_j $ is:
  \begin{multline}
    \braket{\ve{p}_1 , \dots , \ve{p}_m ; +\infty | \ve{k}_1 , \dots , \ve{k}_n ; -\infty} = \\
    = \prod_{j = 1}^n \frac{k_j^2 - m^2}{i \sqrt{Z}} \int \dd^4x_j\, e^{-i {k_j}_\mu {x_j}^\mu} \prod_{k = 1}^m \frac{p_k^2 - m^2}{i \sqrt{Z}} \int \dd^4y_k\, e^{+i {p_k}_\mu {y_k}^\mu} \times \\
    \times \braket{0 | \tempord\{\phi(x_1) \dots \phi(x_n) \phi(y_1) \dots \phi(y_m)\} | 0}
    \label{eq:lsz-scalar-field}
  \end{multline}
  where $ \tempord $ is the chronological product:
  \begin{equation}
    \begin{split}
      \tempord\{f(x) g(y)\} & \defeq
      \begin{cases}
        g(y) f(x) & y^0 > x^0 \\
        f(x) g(y) & y^0 < x^0
      \end{cases} \\
      & = \theta(y^0 - x^0) g(y) f(x) + \theta(x^0 - y^0) f(x) g(y)
    \end{split}
  \end{equation}
  where $ \theta(x) $ is the Heaviside distribution.
\end{theorem}

\begin{proofbox}
  \begin{proof}
    Using \eref{eq:in-out-lad-op} it is possible to extract a particle from the initial state:
    \begin{equation*}
      \begin{split}
        \braket{\ve{p}_1,\dots,\ve{p}_m;+\infty | \ve{k}_1,\dots,\ve{k}_n;-\infty}
        & = \sqrt{2E_{\ve{k}_1}} \braket{\ve{p}_1,\dots,\ve{p}_m;+\infty | {a_{\ve{k}_1}^\text{in}}\dg | \ve{k}_2,\dots,\ve{k}_n;-\infty} \\
        & = \sqrt{2E_{\ve{k}_1}} \braket{\ve{p}_1,\dots,\ve{p}_m;+\infty | {a_{\ve{k}_1}^\text{in}}\dg - {a_{\ve{k}_1}^\text{out}}\dg | \ve{k}_2,\dots,\ve{k}_n;-\infty}
      \end{split}
    \end{equation*}
    as $ {a_{\ve{k}_1}^\text{out}} \ket{\ve{p}_1,\dots,\ve{p}_n;+\infty} = 0 $ since $ \ve{k}_i \neq \ve{p}_j $. Then, by \lref{lemma:in-out-rel}:
    \begin{equation*}
      \begin{split}
        \braket{\ve{p}_1,\dots,\ve{p}_m;+\infty | \ve{k}_1,\dots,\ve{k}_n;-\infty}
        & = \frac{i}{\sqrt{Z}} \int \dd^4x_1\, e^{-i {k_1}_\mu {x_1}^\mu} (\Box_{x_1} + m^2) \times \\
        & \qquad \qquad \times \braket{\ve{p}_1,\dots,\ve{p}_m;+\infty | \phi(x_1) | \ve{k}_2,\dots,\ve{k}_n;-\infty}
      \end{split}
    \end{equation*}
    Using the same argument (noting that $ \tempord\{a_{\ve{p}_1}^\text{in} \phi(x_1)\} = \phi(x_1) a_{\ve{p}_1}^\text{in} $, $ \tempord\{a_{\ve{p}_1}^\text{out} \phi(x_1)\} = a_{\ve{p}_1}^\text{out} \phi(x_1) $):
    \begin{equation*}
      \begin{split}
        & \braket{\ve{p}_1,\dots,\ve{p}_m;+\infty | \phi(x_1) | \ve{k}_2,\dots,\ve{k}_n;-\infty} = \\
        & \qquad = \sqrt{2E_{\ve{p}_1}} \braket{\ve{p}_2,\dots,\ve{p}_m;+\infty | \tempord\{(a_{\ve{p}_1}^\text{out} - a_{\ve{p}_1}^\text{in}) \phi(x_1)\} | \ve{k}_2,\dots,\ve{k}_n;-\infty} \\
        & \qquad = \frac{i}{\sqrt{Z}} \int \dd^4y_1\, e^{+i {p_1}_\mu {y_1}^\mu} (\Box_{y_1} + m^2) \braket{\ve{p}_2,\dots,\ve{p}_m;+\infty | \tempord\{\phi(y_1) \phi(x_1)\} | \ve{k}_2,\dots,\ve{k}_n;-\infty}
      \end{split}
    \end{equation*}
    This procedure can be iterated\footnote{Technically, $ \Box_{y_1} $ cannot be extracted from $ \tempord $, as it does not commute with the Heaviside distribution in its definition. However, the extraction of $ \Box_{y_1} $ can be performed accounting for an additional term proportional to $ \pa_0 \theta({y_1}^0 - {x_1}^0) [\pa_0 \phi(y_1),\phi(x_1)] \sim \delta^{(4)}(y_1 - x_1) $, which does not alter the singular structure of the LSZ formula, thus leaving the residue and the resulting amplitude unchanged.}, obtaining:
    \begin{equation*}
      \begin{split}
        & \braket{\ve{p}_1,\dots\ve{p}_m;+\infty | \ve{k}_1,\dots,\ve{k}_n;-\infty} = \prod_{j = 1}^n \frac{i}{\sqrt{Z}} \int \dd^4x_j\, e^{-i {k_j}_\mu {x_j}^\mu} \prod_{k = 1}^m \frac{i}{\sqrt{Z}} \int \dd^4y_k\, e^{+i {p_k}_\mu {x_k}^\mu} \times \\
        & \qquad \qquad \qquad \qquad \qquad \qquad \times (\Box_{x_j} + m^2) (\Box_{y_k} + m^2) \braket{0 | \tempord\{\phi(x_1) \dots \phi(x_n) \phi(y_1) \dots \phi(y_m)\} | 0}
      \end{split}
    \end{equation*}
    It is possible to define the \bctxt{$ N $-point Green function} as:
    \begin{equation}
      G(x_1, \dots, x_N) \equiv \braket{0 | \tempord\{\phi(x_1) \dots \phi(x_N)\} | 0}
    \end{equation}
    In terms of its (4-dimensional) Fourier transform it reads:
    \begin{equation*}
      G(x_1, \dots, x_N) = \prod_{j = 1}^N \int \frac{\dd^4\xi_j}{(2\pi)^4} e^{i {\xi_j}_\mu {x_j}^\mu} \tilde{G}(\xi_1, \dots, \xi_N)
    \end{equation*}
    Then:
    \begin{equation*}
      (\Box_{x_j} + m^2) G(x_1, \dots, x_N) = - \prod_{j = 1}^N \int \frac{\dd^4\xi_j}{(2\pi)^4} e^{i {\xi_j}_\mu {x_j}^\mu} (\xi_j^2 - m^2) \tilde{G}(\xi_1, \dots, \xi_N)
    \end{equation*}
    Substituting into the above expression:
    \begin{equation*}
      \begin{split}
        & \prod_{j = 1}^N \frac{i}{\sqrt{Z}} \int \dd^4x_j e^{-i {k_j}_\mu {x_j}^\mu} (\Box_{x_j} + m^2) G(x_1, \dots, x_N) = \\
        & \qquad \qquad = - \prod_{j = 1} \frac{i}{\sqrt{Z}} \int \frac{\dd^4x_j \dd^4\xi_j}{(2\pi)^4} e^{i (\xi_j - k_j)_\mu x^\mu} (\xi_j^2 - m^2) \tilde{G}(\xi_1, \dots, \xi_N) \\
        & \qquad \qquad = \prod_{j = 1}^N \frac{1}{i \sqrt{Z}} \int \dd^4\xi_j\, \delta^{(4)}(\xi_j - k_j) (\xi_j^2 - m^2) \tilde{G}(\xi_1, \dots, \xi_N) \\
        & \qquad \qquad = \prod_{j = 1}^N \frac{k_j^2 - m^2}{i \sqrt{Z}} \tilde{G}(k_1, \dots, k_N) = \prod_{j = 1}^N \frac{k_j^2 - m^2}{i\sqrt{Z}} \int \dd^4x_j\, e^{-i {k_j}_\mu {x_j}^\mu} G(x_1, \dots, x_N)
      \end{split}
    \end{equation*}
    Using $ G(x_1, \dots, x_n , y_1, \dots, y_m) =  \braket{0 | \tempord\{\phi(x_1) \dots \phi(x_n) \phi(y_1) \dots \phi(y_m)\} | 0} $ yields the thesis.
  \end{proof}
\end{proofbox}

Going on mass-shell $ p^2 \rightarrow m^2 $, the Green function (or \bctxt{correlation function}) can be shown to have singularities $ \sim (p^2 - m^2)^{-1} $ for each particle involved: these poles are precisely cancelled by the factors in the LSZ reduction formula, thus leaving a finite result. In this sense, the amplitude of the process can be seen as the multi-pole residue of the Green function.

\subsubsection{Spinor fields}

Consider now a scattering process of a single species of spin-$ \frac{1}{2} $ particles (and anti-particles). The adiabatic hypothesis now yields (recall \eeref{eq:dirac-ladd-op-a}{eq:dirac-ladd-op-b}):
\begin{equation}
  \sqrt{2E_\ve{p}} {a_{\ve{p},s}^\text{in,out}}\dg = \int_{t \rightarrow \mp \infty} \dd^3x\, e^{-i p_\mu x^\mu} \bar{\Psi}_\text{in,out}(x) \gamma^0 u^s(p) = \frac{1}{\sqrt{Z}} \lim_{t \rightarrow \mp \infty} \int \dd^3x\, e^{-i p_\mu x^\mu} \bar{\Psi}(x) \gamma^0 u^s(p)
\end{equation}
\begin{equation}
  \sqrt{2E_\ve{p}} {b_{\ve{p},s}^\text{in,out}}\dg = \int_{t \rightarrow \mp \infty} \dd^3x\, e^{i p_\mu x^\mu} \bar{v}^s(p) \gamma^0 \Psi_\text{in,out}(x) = \frac{1}{\sqrt{Z}} \lim_{t \rightarrow \mp \infty} \int \dd^3x\, e^{i p_\mu x^\mu} \bar{v}^s(p) \gamma^0 \Psi(x)
\end{equation}

\begin{lemma}[before upper = {\tcbtitle}]{}{}
  \begin{equation}
    \sqrt{2E_\ve{p}} ({a_{\ve{p},s}^\text{in}}\dg - {a_{\ve{p},s}^\text{out}}\dg) = \frac{i}{\sqrt{Z}} \int \dd^4x\, \bar{\Psi}(x) ( i \smla{\slashed{\pa}} + m ) u^s(p) e^{-i p_\mu x^\mu}
  \end{equation}
  \begin{equation}
    \sqrt{2E_\ve{p}} ({a_{\ve{p},s}^\text{in}} - {a_{\ve{p},s}^\text{out}}) = \frac{i}{\sqrt{Z}} \int \dd^4x\, e^{i p_\mu x^\mu} \bar{u}^s(p) ( - i \smra{\slashed{\pa}} + m ) \Psi(x)
  \end{equation}
  \begin{equation}
    \sqrt{2E_\ve{p}} ({b_{\ve{p},s}^\text{in}}\dg - {b_{\ve{p},s}^\text{out}}\dg) = - \frac{i}{\sqrt{Z}} \int \dd^4x\, e^{i p_\mu x^\mu} \bar{v}^s(p) ( - i \smra{\slashed{\pa}} + m ) \Psi(x)
  \end{equation}
  \begin{equation}
    \sqrt{2E_\ve{p}} ({b_{\ve{p},s}^\text{in}} - {b_{\ve{p},s}^\text{out}}) = - \frac{i}{\sqrt{Z}} \int \dd^4x\, \bar{\Psi}(x) ( i \smla{\slashed{\pa}} + m ) v^s(p) e^{-i p_\mu x^\mu}
  \end{equation}
\end{lemma}

\begin{proofbox}
  \begin{proof}
    Using \eref{eq:int-func-lemma}:
    \begin{equation*}
      \begin{split}
        \sqrt{2E_\ve{p}} ({a_{\ve{p},s}^\text{in}}\dg - {a_{\ve{p},s}^\text{out}}\dg)
        & = - \frac{1}{\sqrt{Z}} \int \dd^4x\, \pa_0 \left[ e^{-i p_\mu x^\mu} \bar{\Psi}(x) \gamma^0 u^s(p) \right] \\
        & = - \frac{1}{\sqrt{Z}} \int \dd^4x \left[ \pa_0 e^{-i p_\mu x^\mu} \bar{\Psi}(x) + e^{-i p_\mu x^\mu} \pa_0 \bar{\Psi}(x) \right] \gamma^0 u^s(p) \\
        & = - \frac{1}{\sqrt{Z}} \int \dd^4x\, \bar{\Psi}(x) \left[ -i \gamma ^0 p_0 + \gamma^0 \smla{\pa}_0 \right] u^s(p) e^{-i p_\mu x^\mu}
      \end{split}
    \end{equation*}
    By \eref{eq:dirac-eq-spinors} $ (\gamma^0 p_0 - \gamma^k p_k - m) u^s(p) = 0 $, so:
    \begin{equation*}
      \begin{split}
        \sqrt{2E_\ve{p}} ({a_{\ve{p},s}^\text{in}}\dg - {a_{\ve{p},s}^\text{out}}\dg)
        & = - \frac{1}{\sqrt{Z}} \int \dd^4x\, \bar{\Psi}(x) \left[ -i \gamma ^k p_k - i m + \gamma^0 \smla{\pa}_0 \right] u^s(p) e^{-i p_\mu x^\mu} \\
        & = - \frac{1}{\sqrt{Z}} \int \dd^4x\, \bar{\Psi}(x) \left[ \gamma^0 \smla{\pa}_0 + \gamma^k \smra{\pa}_k - im \right] u^s(p) e^{-i p_\mu x^\mu}
      \end{split}
    \end{equation*}
    Assuming that initial and final particle states are convoluted to form wave-packets, integartion by parts in spatial dimensions can be carried out, yielding:
    \begin{equation*}
      \begin{split}
        \sqrt{2E_\ve{p}} ({a_{\ve{p},s}^\text{in}}\dg - {a_{\ve{p},s}^\text{out}}\dg)
        & = - \frac{1}{\sqrt{Z}} \int \dd^4x\, \bar{\Psi}(x) \left[ \gamma^0 \smla{\pa}_0 - \gamma^k \smla{\pa}_k - im \right] u^s(p) e^{-i p_\mu x^\mu} \\
        & = \frac{i}{\sqrt{Z}} \int \dd^4x\, \bar{\Psi}(x) \left[ i \smla{\slashed{\pa}} + m \right] u^s(p) e^{-i p_\mu x^\mu}
      \end{split}
    \end{equation*}
    Other operators are found analogously.
  \end{proof}
\end{proofbox}

Note that, like \eref{eq:lsz-scal-op}, these operators vanish identically when dealing with a free field. \\
Consider now a general scattering process involving both fermions and anti-fermions (quantities denoted by a tilde) $ \ket{\ve{k}_1, \dots, \ve{k}_{n_1} , \tilde{\ve{k}}_1, \dots, \tilde{\ve{k}}_{n_2} ; -\infty} \rightarrow \ket{\ve{p}_1, \dots, \ve{p}_{m_1} , \tilde{\ve{p}}_1, \dots, \tilde{\ve{p}}_{m_2} ; +\infty} $ in which no particles remain unchanged by the interaction, i.e. $ \ve{k}_i \neq \ve{p}_j , \tilde{\ve{k}}_k \neq \tilde{\ve{p}}_l \,\,\forall i = 1,\dots,n_1 ,\, j = 1,\dots,m_1 ,\, k = 1,\dots,n_2 ,\, l = 1,\dots,m_2 $, so that the $ S $-matrix reduces to the $ T $-matrix. By the same reasoning of \tref{th:lsz-scalar}, it is clear how to extract particles from this generic amplitude:
\begin{align}
  \braket{\beta_\text{fin} ; + \infty | \ve{k},s ; -\infty} &\mapsto \frac{i}{\sqrt{Z}} \int \dd^4x \sum_{\sigma = 1}^{4} \braket{\beta_\text{fin} | [\bar{\Psi}(x)]_\sigma | 0} [( i\smla{\slashed{\pa}} + m ) u^s(k)]_\sigma e^{-i k_\mu x^\mu} \\
  \braket{\beta_\text{fin} ; + \infty | \tilde{\ve{k}},\tilde{s} ; -\infty} &\mapsto -\frac{i}{\sqrt{Z}} \int \dd^4\tilde{x} \sum_{\sigma = 1}^{4} e^{i \tilde{k}_\mu \tilde{x}^\mu} [\bar{v}^{\tilde{s}}(\tilde{k})( -i\smra{\slashed{\pa}} + m )]_\sigma \braket{\beta_\text{fin} | [\Psi(\tilde{x})]_\sigma | 0} \\
  \braket{\ve{p},s ; +\infty | \alpha_\text{in} ; -\infty} &\mapsto \frac{i}{\sqrt{Z}} \int \dd^4y \sum_{\sigma = 1}^{4} e^{i p_\mu y^\mu} [\bar{u}^s(p) ( -i \smra{\slashed{\pa}} + m )]_\sigma \braket{0 | [\Psi(y)]_\sigma | \alpha_\text{in}} \\
  \braket{\tilde{\ve{p}},\tilde{s} ; +\infty | \alpha_\text{in} ; -\infty} &\mapsto -\frac{i}{\sqrt{Z}} \int \dd^4\tilde{y} \sum_{\sigma = 1}^{4} \braket{0 | [\bar{\Psi}(\tilde{y})]_\sigma | \alpha_\text{in}} [( i \smla{\slashed{\pa}} + m ) v^{\tilde{s}}(\tilde{p})]_\sigma e^{-i \tilde{p}_\mu \tilde{y}^\mu}
\end{align}
In general, the final $ \virgolette{reduced} $ amplitude formula will contain a $ (n_1 + n_2 + m_1 + m_2) $-point Green function like (omitting spinor indices):
\begin{equation*}
  \braket{0 | \tempord\{\bar{\Psi}(x_1) \dots \bar{\Psi}(x_{n_1}) \Psi(\tilde{x}_1) \dots \Psi(\tilde{x}_{n_2}) \Psi(y_1) \dots \Psi(y_{m_1}) \bar{\Psi}(\tilde{y}_1) \dots \bar{\Psi}(\tilde{y}_{m_2})\} | 0}
\end{equation*}

\subsection{Correlation functions}

With the LSZ reduction formulae, the problem of computing scattering amplitudes is reduced to that of computing correlation functions. \\
Consider a generic quantum field $ \phi(x) $ described by a Hamiltonian $ \ham = \ham_0 + \ham_\text{int} $: the exact form of $ \phi(x) $ is in general too difficult to obtain, as it satisfies a complicated non-linear equation of motion, so it cannot be written through an expansion in plane waves. To compute correlation functions, then, it is convenient to define a field related to $ \phi(x) $:
\begin{equation}
  \phi_I(t,\ve{x}) \defeq e^{i H_0 (t-t_0)} \phi(t_0, \ve{x}) e^{-i H_0 (t-t_0)}
\end{equation}
This field evolves with $ H_0 $, i.e. is a free field, and it is called the \bctxt{interaction picture} field. Being this a free field, it can be expanded as:
\begin{equation}
  \phi_I(t,\ve{x}) = \int \frac{\dd^3p}{(2\pi)^3 \sqrt{2E_\ve{p}}} \left[ a_\ve{p} e^{-i p_\mu x^\mu} + a_\ve{p}\dg e^{i p_\mu x^\mu} \right]_{p^0 = E_\ve{p} ,\, x^0 = t - t_0}
\end{equation}

\begin{proposition}{Interaction picture}{}
  The transformation from the interaction picture to the Heisenberg picture is given by a unitary operator:
  \begin{equation}
    \phi(t,\ve{x}) = \tens{U}\dg(t,t_0) \phi_I \tens{U}(t,t_0)
    \label{eq:int-heis-pic}
  \end{equation}
  with:
  \begin{equation}
    \tens{U}(t,t_0) \equiv e^{i H_0 (t-t_0)} e^{-i H (t-t_0)}
  \end{equation}
\end{proposition}

\begin{proofbox}
  \begin{proof}
    By direct calculation:
    \begin{equation*}
      \begin{split}
        \phi(t,\ve{x})
        & = e^{i H (t-t_0)} \phi(t_0,\ve{x}) e^{-i H (t-t_0)} \\
        & = e^{i H (t-t_0)} e^{-i H_0 (t-t_0)} \left[ e^{i H_0 (t-t_0)} \phi(t_0,\ve{x}) e^{-i H_0 (t-t_0)} \right] e^{i H_0 (t-t_0)} e^{-i H (t-t_0)} \\
        & = e^{i H (t-t_0)} e^{-i H_0 (t-t_0)} \phi_I(t,\ve{x}) e^{i H_0 (t-t_0)} e^{-i H (t-t_0)} \equiv \tens{U}\dg(t,t_0) \phi_I(t,\ve{x}) \tens{U}(t,t_0)
      \end{split}
    \end{equation*}
    Unitarity is obvious, as $ H $ is a Hermitian operator.
  \end{proof}
\end{proofbox}

Note that, since $ [H_0,H_\text{int}] \neq 0 $ in general, the two exponentials cannot be combined trivially (the Baker-Campbell-Hausdorff formula should be used).

\begin{proposition}{Time evolution operator}
  The time evolution operator is:
  \begin{equation}
    \tens{U}(t,t_0) = \tempord \exp \left[ -i \int_{t_0}^t \dd\tau\, H_I(\tau) \right]
  \end{equation}
  where:
  \begin{equation}
    H_I(t) \equiv e^{i H_0 (t-t_0)} H_\text{int} e^{-i H_0 (t-t_0)}
  \end{equation}
\end{proposition}

\begin{proofbox}
  \begin{proof}
    First of all, the time evolution operator solves the Schrödinger equation:
    \begin{equation*}
      \begin{split}
        i \frac{\pa}{\pa t} \tens{U}(t,t_0)
        & = e^{i H_0 (t-t_0)} (H - H_0) e^{-i H (t-t_0)} = e^{i H_0 (t-t_0)} H_\text{int} e^{-i H (t-t_0)} \\
        & = e^{i H_0 (t-t_0)} H_\text{int} e^{-i H_0 (t-t_0)} e^{i H_0 (t-t_0)} e^{-i H (t-t_0)} \equiv H_I(t) \tens{U}(t,t_0)
      \end{split}
    \end{equation*}
    The solution to this equation which satisfies the initial condition $ \tens{U}(t_0,t_0) = 1 $ is unique:
    \begin{equation*}
      \begin{split}
        \tens{U}(t,t_0)
        & = \tempord \exp \left[ -i \int_{t_0}^t \dd\tau\, H_I(\tau) \right] = \sum_{n = 0}^{\infty} \frac{(-i)^n}{n!} \int_{[t_0,t]^n} \dd t_1 \dots \dd t_n\, \tempord\{H_I(t_1) \dots H_I(t_n)\} \\
        & = \sum_{n = 0}^{\infty} (-i)^n \int_{t_0}^t \dd t_1 \int_{t_0}^{t_1} \dd t_2 \dots \int_{t_0}^{t_{n-1}} \dd t_n\, H_I(t_1) \dots H_I(t_n)
      \end{split}
    \end{equation*}
    It is in fact clear that:
    \begin{equation*}
      \frac{\pa}{\pa t} \tens{U}(t,t_0) = \sum_{n = 0}^{\infty} (-i)^n \int_{t_0}^{t} \dd t_2 \dots \int_{t_0}^{t_{n-1}} \dd t_n\, H_I(t) H_I(t_2) \dots H_I(t_n) = -i H_I(t) \tens{U}(t,t_0)
    \end{equation*}
    Hence, this is a solution to the above equation.
  \end{proof}
\end{proofbox}

\begin{lemma}[before upper = {\tcbtitle}]{}{time-evol-func}
  \begin{equation}
    \tens{U}(t_1,t_0) \tens{U}(t_0,t_2) = \tens{U}(t_1,t_2)
  \end{equation}
\end{lemma}

\begin{proofbox}
  \begin{proof}
    Observe that:
    \begin{equation*}
      i \frac{\pa}{\pa t} [\tens{U}(t,t_0) \tens{U}(t_0,t_2)] = \left[ i \frac{\pa}{\pa t} \tens{U}(t,t_0) \right] \tens{U}(t_0,t_2) = H_I(t) \tens{U}(t,t_0) \tens{U}(t_0,t_2)
    \end{equation*}
    The boundary condition now reads $ [\tens{U}(t,t_0) \tens{U}(t_0,t_2)]_{t = t_0} = \tens{U}(t_0,t_2) $, and the unique solution for this boundary condition is:
    \begin{equation*}
      \tens{U}(t,t_0) \tens{U}(t_0,t_2) = \tempord \exp \left[ -i \int_{t_0}^t \dd\tau\, H_I(\tau) \right]
    \end{equation*}
    which is precisely $ \tens{U}(t,t_2) $.
  \end{proof}
\end{proofbox}

It is now possible to compute correlation functions.

\begin{theorem}{Correlation functions}{}
  Given a quantum field $ \phi(x) $ described by a Hamiltonian $ \ham = \ham_0 + \ham_\text{int} $, then:
  \begin{equation}
    \braket{0 | \tempord\{\phi(x_1) \dots \phi(x_n)\} | 0} = \frac{\braket{0 | \tempord\{\phi_I(x_1) \dots \phi_I(x_n) \exp \left[ -i \int \dd^4x\, \ham_I \right]\} | 0}}{\braket{0 | \tempord\{\exp \left[ -i \int \dd^4x\, \ham_I \right]\} |0}}
    \label{eq:corr-func-pert}
  \end{equation}
\end{theorem}

\begin{proofbox}
  \begin{proof}
    Consider WLOG $ \{t_k\}_{k = 1,\dots,n} : t_i < t_j $. Using \eref{eq:int-heis-pic} and \lref{lemma:time-evol-func}:
    \begin{equation*}
      \begin{split}
        \braket{0 | \phi(x_1) \dots \phi(x_n) | 0}
        & = \braket{0 | \tens{U}\dg(t_1,t_0) \phi_I(x_1) \tens{U}(t_1,t_0) \tens{U}\dg(t_2,t_0) \dots \tens{U}\dg(t_n,t_0) \phi_I(x_n) \tens{U}(t_n,t_0) | 0} \\
        & = \braket{0 | \tens{U}\dg(t_1,t_0) \phi_I(x_1) \tens{U}(t_1,t_2) \dots \tens{U}(t_{n-1},t_n) \phi_I(x_n) \tens{U}(t_n,t_0) | 0}
      \end{split}
    \end{equation*}
    Consider $ t \in \R : t \gg t_1 > \dots > t_n \gg -t $, so that $ \tens{U}(t_n,t_0) = \tens{U}(t_n,-t) \tens{U}(-t,t_0) $ and $ \tens{U}\dg(t_1,t_0) = \tens{U}\dg(t,t_0) \tens{U}(t,t_1) $. Therefore:
    \begin{equation*}
      \begin{split}
        & \braket{0 | \phi(x_1) \dots \phi(x_n) | 0} \\
        & = \braket{0 | \tens{U}\dg(t,t_0) [\tens{U}(t,t_1) \phi_I(x_1) \tens{U}(t_1,t_2) \phi_I(x_2) \tens{U}(t_2,t_3) \dots \tens{U}(t_{n-1},t_n) \phi_I(x_n) \tens{U}(t_n,-t)] \tens{U}(-t,t_0) | 0}
      \end{split}
    \end{equation*}
    Note that this expression inside the square brackets is automatically time-ordered, so it may be rewritten as:
    \begin{equation*}
      \begin{split}
        [\dots]
        & = \tempord\{\phi_I(x_1) \dots \phi_I(x_n) \tens{U}(t,t_1) \tens{U}(t_1,t_2) \dots \tens{U}(t_n,-t)\} \\
        & = \tempord\bigg\{ \phi_I(x_1) \dots \phi_I(x_n) \exp \left[ -i \int_{-t}^t \dd\tau\, H_I(\tau) \right]\bigg\}
      \end{split}
    \end{equation*}
    These considerations hold for arbitrary $ t_0 $, so it can be set $ t_0 = -t \rightarrow -\infty $. Then:
    \begin{equation*}
      \braket{0 | \tempord\{\phi(x_1) \dots \phi(x_n)\} | 0} = \braket{0 | \tens{U}\dg(+\infty,-\infty) \tempord\bigg\{ \phi_I(x_1) \dots \phi_I(x_n) \exp \left[ -i \int \dd^4x\, \ham_I \right] \bigg\} | 0}
    \end{equation*}
    Note that $ \bra{0} \tens{U}\dg(\infty,-\infty) $ is the Hermitian conjugate of $ \tens{U}(\infty,-\infty) \ket{0} $, i.e. the state obtained evolving in time the vacuum state. As it was already assumed, the initial-state vacuum coincides physically to the final-state vacuum, i.e.:
    \begin{equation*}
      \tens{U}(\infty,-\infty) \ket{0} = e^{i\alpha} \ket{0}
      \qquad \Rightarrow \qquad
      e^{-i \alpha} = \left( \braket{0 | \tempord\bigg\{ \exp \left[ -i \int \dd^4x\, \ham_I \right] \bigg\} | 0} \right)^{-1}
    \end{equation*}
    Finally:
    \begin{equation*}
    \braket{0 | \tempord\{\phi(x_1) \dots \phi(x_n)\} | 0} = \frac{\braket{0 | \tempord\{\phi_I(x_1) \dots \phi_I(x_n) \exp \left[ -i \int \dd^4x\, \ham_I \right]\} | 0}}{\braket{0 | \tempord\{\exp \left[ -i \int \dd^4x\, \ham_I \right]\} |0}}
    \end{equation*}
    which is the thesis.
  \end{proof}
\end{proofbox}

This allows to compute correlation functions from free fields, rather than interaction fields. Moreover, note that the functional dependence of $ \ham_I $ in terms of $ \phi_I(x) $ is the same as that of $ \ham_\text{int} $ in terms of $ \phi(x) $.

\begin{example}{$ \phi^4 $ potential}{}
  Consider the $ \phi^4 $-interaction Hamiltonian $ \ham_\text{int} = \frac{\lambda}{4!} \phi^4 $. Then:
  \begin{equation*}
    \begin{split}
      \ham_I = \frac{\lambda}{4!} e^{i H_0 (t-t_0)} \phi^4 e^{-i H_0 (t-t_0)} = \frac{\lambda}{4!} \left[ e^{i H_0 (t-t_0)} \phi e^{-i H_0 (t-t_0)} \right]^4 = \frac{\lambda}{4!} \phi_I^4
    \end{split}
  \end{equation*}
\end{example}

Note that \eref{eq:corr-func-pert} is naturally suited for perturbative evaluation with respect to coupling constants which appear in $ \ham_\text{int} $, thanks to the exponential function.

\section{Feynman diagrams}

The problem of computing scattering amplitudes has been further reduced to that of computing $ n $-point Green functions of free (interaction picture) fields.

\subsection{Propagators}

\subsubsection{Feynman propagator}

\begin{theorem}{Feynman propagator}{feynman-prop}
  Given a real scalar field $ \phi(x) $, the \bcth{Feynman propagator} is computed as:
  \begin{equation}
    D_\text{F}(x-y) \defeq \braket{0 | \tempord\{\phi_I(x) \phi_I(y)\} | 0} = \int \frac{\dd^4p}{(2\pi)^4} \frac{i}{p^2 - m^2 + i \epsilon} e^{-i p_\mu (x - y)^\mu}
    \label{eq:feynm-prop}
  \end{equation}
  with $ \epsilon \rightarrow 0^+ $.
\end{theorem}

\begin{proofbox}
  \begin{proof}
    First, decompose $ \phi_I(x) $ into its positive- and negative-frequency parts (i.e. annihilation and creation parts):
    \begin{equation*}
      \phi_I^+(x) \equiv \int \frac{\dd^3p}{(2\pi)^3 \sqrt{2E_\ve{p}}} a_\ve{p} e^{-i p_\mu x^\mu}
      \qquad \qquad
      \phi_I^-(x) \equiv \int \frac{\dd^3p}{(2\pi)^3 \sqrt{2E_\ve{p}}} a_\ve{p}\dg e^{i p_\mu x^\mu}
    \end{equation*}
    Clearly $ \phi_I^+(x) \ket{0} = 0 $ and $ \bra{0} \phi_I^-(x) = 0 $. Consider first the case $ x^0 > y^0 $:
    \begin{equation*}
      \begin{split}
        \tempord\{\phi_I(x) \phi_I(y)\}
        & = \phi_I^+(x) \phi_I^+(y) + \phi_I^+(x) \phi_I^-(y) + \phi_I^-(x) \phi_I^+(y) + \phi_I^-(x) \phi_I^-(y) \\
        & = \phi_I^+(x) \phi_I^+(y) + \phi_I^-(y) \phi_I^+(x) + \phi_I^-(x) \phi_I^+(y) + \phi_I^-(x) \phi_I^-(y) + [\phi_I^+(x) , \phi_I^-(y)] \\
        & = \normord\{\phi_I(x) \phi_I(y)\} + [\phi^+(x) , \phi^-(y)]
      \end{split}
    \end{equation*}
    Similarly, for $ y^0 > x^0 $:
    \begin{equation*}
      \tempord\{\phi_I(x) \phi_I(y)\} = \normord\{\phi_I(x) \phi_I(y)\} + [\phi^+(y) , \phi^-(x)]
    \end{equation*}
    Therefore, in general:
    \begin{equation*}
      \begin{split}
        \tempord\{\phi_I(x) \phi_I(y)\}
        & = \normord\{\phi_I(x) \phi_I(y)\} + \theta(x^0 - y^0) [\phi_I^+(x) , \phi_I^-(y)] + \theta(y^0 - x^0) [\phi_I^+(y) , \phi_I^-(x)] \\
        & \equiv \normord\{\phi_I(x) \phi_I(y)\} + D_\text{F}(x-y)
      \end{split}
    \end{equation*}
    Now, observe that $ \braket{0 | \normord\{\phi_I(x) \phi_I(y)\} | 0} = 0 $, as there is always either an annihilation operator acting on $ \ket{0} $ or a creation operator acting on $ \bra{0} $. On the other hand, $ D_\text{F}(x-y) \in \C $, as $ [a_\ve{p} , a\dg_\ve{q}] \in \C $, therefore $ \braket{0 | D_\text{F}(x-y) | 0} = D_\text{F}(x-y) \braket{0 | 0} = D_\text{F}(x-y) $. There only remains to compute the commutators:
    \begin{equation*}
      \begin{split}
        D_\text{F}(x-y)
        & = \int \frac{\dd^3p \dd^3q}{(2\pi)^6 \sqrt{4E_\ve{p}E_\ve{q}}} \left[ \theta(x^0 - y^0) [a_\ve{p} , a\dg_\ve{q}] e^{-i p_\mu x^\mu + i q_\mu y^\mu} + \theta(y^0 - x^0) [a_\ve{p} , a\dg_\ve{q}] e^{-i p_\mu y^\mu + i q_\mu x^\mu} \right] \\
        & = \int \frac{\dd^3p \dd^3q}{(2\pi)^3 \sqrt{4E_\ve{p}E_\ve{q}}} \delta^{(3)}(\ve{p} - \ve{q}) \left[ \theta(x^0 - y^0) e^{-i p_\mu x^\mu + i q_\mu y^\mu} + \theta(y^0 - x^0) e^{-i p_\mu y^\mu + i q_\mu x^\mu} \right] \\
        & = \int \frac{\dd^3p}{(2\pi)^3 2E_\ve{p}} \left[ \theta(x^0 - y^0) e^{-i p_\mu (x-y)^\mu} + \theta(y^0 - x^0) e^{i p_\mu (x-y)^\mu} \right]
      \end{split}
    \end{equation*}
    To show that this is equivalent to the thesis, note that \eref{eq:feynm-prop} can be rewritten as:
    \begin{equation*}
      D_\text{F}(x-y) = \int \frac{\dd^3p}{(2\pi)^3} e^{i \ve{p} \cdot (\ve{x} - \ve{y})} \int_\R \frac{\dd p^0}{2\pi} \frac{i}{(p^0)^2 - E_\ve{p}^2 + i\epsilon} e^{-i p^0 (x^0 - y^0)}
    \end{equation*}
    as $ E_\ve{p} = + \sqrt{\ve{p}^2 + m^2} $. The integral in $ \dd p^0 $ can be computed in the complex $ p^0 $-plane\footnote{As the integrand is $ \sim (p^0)^{-2} $, the contribution of the curved part of a semicircular contour vanishes, only leaving the integral over the real axis.}: the $ i\epsilon $-prescription slightly displaces the poles from the real axis\footnote{The poles are $ p^0 = \pm \sqrt{E_\ve{p}^2 - i\epsilon} \simeq \pm \left( E_\ve{p} - \frac{i\epsilon}{2E_\ve{p}} \right) $.}, and in particular that in $ p^0 = + E_\ve{p} $ is slightly below it while that in $ p^0 = - E_\ve{p} $ is slightly above it. If $ x^0 - y^0 > 0 $, choose a semicircular (clockwise) contour in the lower-half plane, so that only the $ p^0 = E_\ve{p} $ singularity is enclosed:
    \begin{equation*}
      D_\text{F}(x-y)\vert_{x^0 > y^0} = \int \frac{\dd^3p}{(2\pi)^3} e^{i \ve{p} \cdot (\ve{x} - \ve{y})} \frac{i}{2\pi} \left[ (-2\pi i) \frac{e^{-i E_\ve{p} (x^0 - y^0)}}{2E_\ve{p}} \right] = \int \frac{\dd^3p}{(2\pi)^3 2E_\ve{p}} e^{-i p_\mu (x-y)^\mu}
    \end{equation*}
    If instead $ x^0 - y^0 < 0 $, choose a semicircular (counter-clockwise) contour in the upper-half plane:
    \begin{equation*}
      D_\text{F}(x-y)\vert_{y^0 > x^0} = \int \frac{\dd^3p}{(2\pi)^3} e^{i \ve{p} \cdot (\ve{x} - \ve{y})} \frac{i}{2\pi} \left[ (2\pi i) \frac{e^{i E_\ve{p} (x^0 - y^0)}}{-2E_\ve{p}} \right] = \int \frac{\dd^3p}{(2\pi)^3 2E_\ve{p}} e^{i p_\mu (x-y)^\mu}
    \end{equation*}
    where in the last integral $ \ve{p} \mapsto -\ve{p} $ was renamed. The proof is complete.
  \end{proof}
\end{proofbox}

The expression for the Feynman propagator in momentum space is trivially found:
\begin{equation}
  \tilde{D}_\text{F}(p) = \frac{i}{p^2 - m^2 + i\epsilon}
\end{equation}
Moreover, the Feynman propagator is just a Green function for the KG operator:
\begin{equation*}
  (\Box_x + m^2) D_\text{F}(x-y) = \int \frac{\dd^4p}{(2\pi)^4} \frac{i}{p^2 - m^2 + i\epsilon} (-p^2 + m^2) e^{-i p_\mu (x-y)^\mu} = -i \delta^{(4)}(x-y)
\end{equation*}
Note that this result is independent of the $ i\epsilon $-prescription.

\subsubsection{Dirac propagator}

To explicitly compute the propagator for the Dirac field, it is necessary to include fermionic anti-symmetry when resolving time-ordering and normal-ordering, i.e. a factor of $ (-1) $ for each exchange of fermionic operators: for example, $ \tempord\{\Psi(x_1) \Psi(x_2) \Psi(x_3) \Psi(x_4)\} = (-1)^3 \Psi(x_3) \Psi(x_1) \Psi(x_4) \Psi(x_2) $ if $ x_3^0 > x_1^0 > x_4^0 > x_2^0 $, or $ \normord\{a_\ve{p} a_\ve{q} a_\ve{r}\dg\} = (-1)^2 a_\ve{r}\dg a_\ve{p} a_\ve{q} = (-1)^3 a_\ve{r}\dg a_\ve{q} a_\ve{p} $ (equal expressions).

\begin{definition}{Fermionic time-ordering}{}
  Given a Dirac field $ \Psi(x) $, the \bcdef{time-ordering operator} acts as:
  \begin{equation}
    \tempord\{\Psi(x) \bar{\Psi}(y)\} \defeq
    \begin{cases}
      \Psi(x) \bar{\Psi}(y) & x^0 > y^0 \\
      \bar{\Psi}(y) \Psi(x) & y^0 > x^0 \\
    \end{cases}
  \end{equation}
\end{definition}

\begin{theorem}{Dirac propagator}{dirac-prop}
  Given a Dirac field $ \Psi(x) $, the \bcth{Dirac propagator} is computed as:
  \begin{equation}
    S_\text{D}(x - y) \defeq \braket{0 | \tempord\{\Psi_I(x) \bar{\Psi}_I(y)\} | 0} = \int \frac{\dd^4p}{(2\pi)^4} \frac{i (\slashed{p} + m)}{p^2 - m^2 + i\epsilon} e^{-i p_\mu (x - y)^\mu}
    \label{eq:dirac-prop}
  \end{equation}
\end{theorem}

\begin{proofbox}
  \begin{proof}
    First, decompose $ \Psi_I(x) $ and $ \Psi_I(y) $ into positive- and negative-frequency parts:
    \begin{align*}
      \Psi_I^+(x) &= \int \frac{\dd^3p}{(2\pi)^3 \sqrt{2E_\ve{p}}} \sum_{s = 1,2} a_{\ve{p},s} u^s(p) e^{-i p_\mu x^\mu}
      \qquad
      \Psi_I^-(x) &= \int \frac{\dd^3p}{(2\pi)^3 \sqrt{2E_\ve{p}}} \sum_{s = 1,2} b_{\ve{p},s}\dg v^s(p) e^{i p_\mu x^\mu}
      \\
      \bar{\Psi}_I^+(x) &= \int \frac{\dd^3p}{(2\pi)^3 \sqrt{2E_\ve{p}}} \sum_{s = 1,2} b_{\ve{p},s} \bar{v}^s(p) e^{-i p_\mu x^\mu}
      \qquad
      \bar{\Psi}_I^-(x) &= \int \frac{\dd^3p}{(2\pi)^3 \sqrt{2E_\ve{p}}} \sum_{s = 1,2} a_{\ve{p},s}\dg \bar{u}^s(p) e^{i p_\mu x^\mu}
    \end{align*}
    Clearly $ \Psi_I^+(x) \ket{0} = 0 = \bar{\Psi}_I^+(x) \ket{0} $ and $ \bra{0} \Psi_I^-(x) = 0 = \bra{0} \bar{\Psi}_I^-(x) $. Consider first the case $ x^0 > y^0 $:
    \begin{equation*}
      \begin{split}
        \tempord\{\Psi_I(x) \bar{\Psi}_I(y)\}
        & = \Psi_I^+(x) \bar{\Psi}_I^+(y) + \Psi_I^+(x) \bar{\Psi}_I^-(y) + \Psi_I^-(x) \bar{\Psi}_I^+(y) + \Psi_I^-(x) \bar{\Psi}_I^-(y) \\
        & = \Psi_I^+(x) \bar{\Psi}_I^+(y) - \bar{\Psi}_I^-(y) \Psi_I^+(x) + \Psi_I^-(x) \bar{\Psi}_I^+(y) + \Psi_I^-(x) \bar{\Psi}_I^-(y) + \{\Psi_I^+(x) , \bar{\Psi}_I^-(y)\} \\
        & \equiv \normord\{\Psi_I(x) \bar{\Psi}_I(y)\} + \{\Psi_I^+(x) , \bar{\Psi}_I^-(y)\}
      \end{split}
    \end{equation*}
    Similarly, for $ y^0 > x^0 $:
    \begin{equation*}
      \begin{split}
        \tempord\{\Psi_I(x) \bar{\Psi}_I(y)\}
        & = -\bar{\Psi}_I^+(y) \Psi_I^+(x) - \bar{\Psi}_I^-(y) \Psi_I^+(x) - \bar{\Psi}_I^+(y) \Psi_I^-(x) - \bar{\Psi}_I^-(y) \Psi_I^-(x) \\
        & = \Psi_I^+(x) \bar{\Psi}_I^+(y) - \bar{\Psi}_I^-(y) \Psi_I^+(x) + \Psi_I^-(x) \bar{\Psi}_I^+(y) + \Psi_I^-(x) \bar{\Psi}_I^-(y) - \{\bar{\Psi}_I^+(y) , \Psi_I^-(x)\} \\
        & \equiv \normord\{\Psi_I(x) \bar{\Psi}_I(y)\} - \{\bar{\Psi}_I^+(y) , \Psi_I^-(x)\}
      \end{split}
    \end{equation*}
    Therefore, in general\footnote{To be precise, all these quantities should have spinor indices: indeed, $ \Psi \bar{\Psi} \in \C^{4 \times 4} $ while $ \bar{\Psi} \Psi \in \C $, so the anti-commutator $ \{\Psi , \bar{\Psi}\} $ is only defined with spinor indices, i.e. $ \{\Psi_\alpha , \bar{\Psi}_\beta\} $. To shorten the notation, spinor indices are suppressed, and $ \{\Psi , \bar{\Psi}\} , \{\bar{\Psi} , \Psi\} $ are treated as $ \C^{4 \times 4} $ matrices, always writing Dirac adjoints on the right in the explicit expressions.}:
    \begin{equation*}
      \begin{split}
        \tempord\{\Psi_I(x) \bar{\Psi}_I(y)\}
        & = \normord\{\Psi_I(x) \bar{\Psi}_I(y)\} + \theta(x^0 - y^0) \{\Psi_I^+(x) , \bar{\Psi}_I^-(y)\} - \theta(y^0 - x^0) \{\bar{\Psi}_I^+(y) , \Psi_I^-(x)\} \\
        & = \normord\{\Psi_I(x) \bar{\Psi}_I(y)\} + S_\text{D}(x - y)
      \end{split}
    \end{equation*}
    By the same observations as in the previous proof $ \braket{0 | \tempord\{\Psi_I(x) \bar{\Psi}_I(y)\} | 0} = S_\text{D}(x - y) $, so explicitly computing the anti-commutators:
    \begin{equation*}
      \begin{split}
        S_\text{D}(x - y)
        & = \int \frac{\dd^3p \dd^3q}{(2\pi)^6 \sqrt{4E_\ve{p}E_\ve{q}}} \sum_{s = 1,2} \sum_{r = 1,2} \big[ \theta(x^0 - y^0) \{a_{\ve{p},s} , a_{\ve{q},r}\dg\} u^s(p) \bar{u}^r(q) e^{-i p_\mu x^\mu + i q_\mu y^\mu} + \\
        & \qquad \qquad \qquad \qquad \qquad \qquad - \theta(y^0 - x^0) \{b_{\ve{p},s} , b_{\ve{q},r}\dg\} v^r(q) \bar{v}^s(p) e^{-i p_\mu x^\mu + i q_\mu y^\mu} \big] \\
        & = \int \frac{\dd^3p \dd^3q}{(2\pi)^3 \sqrt{4E_\ve{p}E_\ve{q}}} \sum_{s = 1,2} \sum_{r = 1,2} \delta^{(3)}(\ve{p} - \ve{q}) \delta_{sr} \big[ \theta(x^0 - y^0) u^s(p) \bar{u}^r(q) e^{-i p_\mu y^\mu + i q_\mu x^\mu} + \\
        & \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad - \theta(y^0 - x^0) v^r(q) \bar{v}^s(p) e^{-i p_\mu x^\mu + i q_\mu y^\mu} \big] \\
        & = \int \frac{\dd^3p}{(2\pi)^3 2E_\ve{p}} \sum_{s = 1,2} \left[ \theta(x^0 - y^0) u^s(p) \bar{u}^s(p) e^{-i p_\mu (x-y)^\mu} - \theta(y^0 - x^0) v^s(p) \bar{v}^s(p) e^{i p_\mu (x-y)^\mu} \right]
      \end{split}
    \end{equation*}
    Recalling \eref{eq:spinor-sums}:
    \begin{equation*}
      S_\text{D}(x - y) = \int \frac{\dd^3p}{(2\pi)^3 2E_\ve{p}} \left[ \theta(x^0 - y^0) (\slashed{p} + m) e^{-i p_\mu (x-y)^\mu} - \theta(y^0 - x^0) (\slashed{p} - m) e^{i p_\mu (x-y)^\mu} \right]
    \end{equation*}
    By the same technique in the previous proof, to show that this expression is equal to the thesis, rewrite \eref{eq:dirac-prop} as:
    \begin{equation*}
      S_\text{D}(x - y) = \int \frac{\dd^3p}{(2\pi)^3} e^{i \ve{p} \cdot (\ve{x} - \ve{y})} \int \frac{\dd p^0}{2\pi} \frac{i (p^0 \gamma^0 - \ve{p} \cdot \bs{\gamma} + m)}{(p^0)^2 - E_\ve{p}^2 + i\epsilon} e^{-i p^0 (x^0 - y^0)}
    \end{equation*}
    The $ i\epsilon $-prescription shifts the pole in $ p^0 > 0 $ below the real axis and that in $ p^0 < 0 $ above it. If $ x^0 > y^0 $, chose a semicircular (clockwise) contour in the lower-hald plane, so that only the $ p^0 = E_\ve{p} $ singularity is enclosed:
    \begin{equation*}
      \begin{split}
        S_\text{D}(x - y)\vert_{x^0 > y^0}
        & = \int \frac{\dd^3p}{(2\pi)^3} e^{i \ve{p} \cdot (\ve{x} - \ve{y})} \frac{i}{2\pi} \left[ (-2\pi i) \frac{E_\ve{p} \gamma^0 - \ve{p} \cdot \bs{\gamma} + m}{2E_\ve{p}} e^{-i E_\ve{p} (x^0 - y^0)} \right] \\
        & = \int \frac{\dd^3p}{(2\pi)^3 2E_\ve{p}} e^{i p_\mu \cdot (x-y)^\mu} (E_\ve{p} \gamma^0 - \ve{p} \cdot \bs{\gamma} + m) = \int \frac{\dd^3p}{(2\pi)^3 2E_\ve{p}} e^{i p_\mu \cdot (x-y)^\mu} (\slashed{p} + m)
      \end{split}
    \end{equation*}
    If instead $ y^0 > x^0 $, chose a semicircular (counter-clockwise) contour in the upper-half plane:
    \begin{equation*}
      \begin{split}
        S_\text{D}(x - y)\vert_{y^0 > x^0}
        & = \int \frac{\dd^3p}{(2\pi)^3} e^{i \ve{p} \cdot (\ve{x} - \ve{y})} \frac{i}{2\pi} \left[ (2\pi i) \frac{-E_\ve{p} \gamma^0 - \ve{p} \cdot \bs{\gamma} + m}{-2E_\ve{p}} e^{i E_\ve{p} (x^0 - y^0)} \right] \\
        & = \int \frac{\dd^3p}{(2\pi)^3 2E_\ve{p}} e^{i p_\mu \cdot (x-y)^\mu} (-E_\ve{p} \gamma^0 + \ve{p} \cdot \bs{\gamma} + m) = - \int \frac{\dd^3p}{(2\pi)^3 2E_\ve{p}} e^{i p_\mu \cdot (x-y)^\mu} (\slashed{p} - m)
      \end{split}
    \end{equation*}
    where in the second equality $ \ve{p} \mapsto -\ve{p} $ was renamed. The proof is complete.
  \end{proof}
\end{proofbox}

Note that $ S_\text{D}(x - y) \in \C^{4 \times 4} $, with two Dirac indices: $ S_{\alpha \beta}(x-y) \equiv \braket{0 | \tempord\{\Psi_{I,\alpha}(x) \bar{\Psi}_{I,\beta}(y)\} | 0} $. It is straightforward to see that the Feynman propagator in momentum space is:
\begin{equation}
  \tilde{S}_\text{D}(x-y) = \frac{i (\slashed{p} + m)}{p^2 - m^2 + i\epsilon}
\end{equation}

\begin{lemma}[before upper = {\tcbtitle}]{Dirac propagator in momentum space}{}
  \begin{equation}
    \tilde{S}_\text{D}(x-y) = \frac{i}{\slashed{p} - m}
  \end{equation}
\end{lemma}

\begin{proofbox}
  \begin{proof}
    $ (\slashed{p} + m) (\slashed{p} - m) = \gamma^\mu \gamma^\nu p_\mu p_\nu - m^2 = \frac{1}{2} \{\gamma^\mu , \gamma^\nu\} p_\mu p_\nu - m^2 = \eta^{\mu \nu} p_\mu p_\nu - m^2 = p^2 - m^2 $.
  \end{proof}
\end{proofbox}

This is interpreted as the inverse matrix $ i (\slashed{p} - m)^{-1} $.
As for the Feynman propagator, the Dirac propagator too is a Green function for the Dirac operator:
\begin{equation*}
  (i \slashed{\pa}_x - m) S_\text{D}(x-y) = \int \frac{\dd^4p}{(2\pi)^4} \frac{i}{\slashed{p} - m} (\gamma^\mu p_\mu - m) e^{-i p_\mu (x-y)^\mu} = i \delta^{(4)}(x - y)
\end{equation*}

\subsection{Wick's theorem}

It is possible to simplify the computation of a general $ n $-point Green function in terms of $ 2 $-point Green functions. In the following, the subscript $ I $ for the interaction-picture field is omitted.

\subsubsection{Bosonic fields}

\begin{definition}{Contraction}{}
  Given a bosonic field $ \phi(x) $, its \bcdef{contraction} is defined as:
  \begin{equation}
    \wick{\c\phi(x) \c\phi(y)} \defeq
    \begin{cases}
      [\phi^+(x) , \phi^-(y)] & x^0 > y^0 \\
      [\phi^+(y) , \phi^-(x)] & y^0 > x^0
    \end{cases}
  \end{equation}
\end{definition}

Recalling the proof of \tref{th:feynman-prop}, it is clear that:
\begin{equation}
  \tempord\{\phi(x) \phi(y)\} = \normord\{\phi(x) \phi(y)\} + \wick{\c\phi(x) \c\phi(y)}
  \label{eq:wick-th-2}
\end{equation}
This relation can be generalized to $ n $-point Green functions.

\begin{theorem}{Wick's theorem}{wick-boson}
  Given a bosonic field $ \phi(x) $:
  \begin{equation}
    \tempord\{\phi(x_1) \dots \phi(x_n)\} = \normord\{\phi(x_1) \dots \phi(x_n) \,+\, \text{all possible contractions}\}
    \label{eq:wick-th}
  \end{equation}
  where both partially-contracted and fully-contracted terms are considered.
\end{theorem}

\begin{proofbox}
  \begin{proof}
    Use induction on $ n $. \eref{eq:wick-th-2} proves the $ n = 2 $ case, so assume the theorem true for generic $ n-1 $ and consider the $ n $ case. WLOG $ x_1^0 \ge \dots \ge x_n^0 $ (if that's not the case, just relabel the points, as it does not affect \eref{eq:wick-th}), so, using the inductive step:
    \begin{equation*}
      \begin{split}
        \tempord\{\phi(x_1) \dots \phi(x_n)\}
        & = \phi(x_1) \tempord\{\phi(x_2) \dots \phi(x_n)\} \\
        & = (\phi^+(x_1) + \phi^-(x_1)) \normord\{\phi(x_2) \dots \phi(x_n) + \text{all contr. without } \phi(x_1)\}
      \end{split}
    \end{equation*}
    $ \phi^-(x_1) $ is already in normal order (on the left), while $ \phi^+(x_1) $ must be commuted with all other $ \phi(x_i) $. For the term without contractions:
    \begin{equation*}
      \begin{split}
        \phi^+(x_1) \normord\{\phi(x_2) \dots \phi(x_n)\}
        & = \normord\{\phi(x_2) \dots \phi(x_n)\} \phi^+(x_1) + [\phi^+(x_1) , \normord\{\phi(x_2) \dots \phi(x_n)\}] \\
        & = \normord\{\phi^+(x_1) \phi(x_2) \dots \phi(x_n)\} \\
        & \quad + \normord\{\dots + \phi(x_2) \dots [\phi^+(x_2) , \phi^-(x_i)] \dots \phi(x_n) + \dots\} \\
        & = \normord\{\phi^+(x_1) \phi(x_2) \dots \phi(x_n) + \dots \wick{\c\phi^+(x_1) \phi(x_2) \dots \c\phi(x_i) \dots \phi(x_n)} + \dots\}
      \end{split}
    \end{equation*}
    Analogously, all possible contractions are obtained, proving the theorem.
  \end{proof}
\end{proofbox}

Note that only fully-contracted terms contribute to the $ n $-point Green function: as every term with at least an uncontracted field vanishes when put between $ \braket{0| \cdot |0} $, as there will be an annihilation operator acting on $ \ket{0} $ or a creation operator acting on $ \bra{0} $.

\begin{example}{4-point Green function}{4-green-func}
  Applying Wick's theorem to a 4-point Green function yields:
  \begin{equation*}
    \begin{split}
      &\tempord\{\phi(x_1) \phi(x_2) \phi(x_3) \phi(x_4)\} = \normord\{\phi(x_1) \phi(x_2) \phi(x_3) \phi(x_4) + \\
      & \qquad \qquad + \wick{\c\phi(x_1) \c\phi(x_2) \phi(x_3) \phi(x_4)} + \wick{\c\phi(x_1) \phi(x_2) \c\phi(x_3) \phi(x_4)} + \wick{\c\phi(x_1) \phi(x_2) \phi(x_3) \c\phi(x_4)} \\
      & \qquad \qquad + \wick{\phi(x_1) \c\phi(x_2) \c\phi(x_3) \phi(x_4)} + \wick{\phi(x_1) \c\phi(x_2) \phi(x_3) \c\phi(x_4)} + \wick{\phi(x_1) \phi(x_2) \c\phi(x_3) \c\phi(x_4)} \\
      & \qquad \qquad + \wick{\c\phi(x_1) \c\phi(x_2) \c\phi(x_3) \c\phi(x_4)} + \wick{\c1\phi(x_1) \c2\phi(x_2) \c1\phi(x_3) \c2\phi(x_4)} + \wick{\c2\phi(x_1) \c1\phi(x_2) \c1\phi(x_3) \c2\phi(x_4)}
    \end{split}
  \end{equation*}
  Only the last three terms contribute to the 4-point Green function. If $ \phi(x) $ is a scalar field, then:
  \begin{equation*}
    \begin{split}
      \braket{0 | \tempord\{\phi(x_1) \phi(x_2) \phi(x_3) \phi(x_4)\} | 0}
      & = D_\text{F}(x_1 - x_2) D_\text{F}(x_3 - x_4) + D_\text{F}(x_1 - x_3) D_\text{F}(x_2 - x_4) + \\
      & \qquad \qquad \qquad \qquad \qquad \qquad + D_\text{F}(x_1 - x_4) D_\text{F}(x_2 - x_3)
    \end{split}
  \end{equation*}
  This expression has immediate physical interpretation: indeed, $ D_\text{F}(x_1 - x_2) $ can be interpreted as the amplitude for the propagation of a particle from spacetime point $ x_1 $ to $ x_2 $, while $ D_\text{F}(x_1 - x_2) D_\text{F}(x_3 - x_4) $ is the amplitude for the propagation of a particle from $ x_1 $ to $ x_2 $ and one from $ x_3 $ to $ x_3 $, without interacting with each other. \\
  It is possible to associate intuitive graphs, called \bcex{Feynman diagrams}, to these kind of expressions; for example:
  \begin{equation*}
    D_\text{F}(x_1 - x_2) D_\text{F}(x_3 - x_4)
    =
    \begin{tikzpicture}[baseline=(r.base)]
      \begin{feynman}[inline=(r.base)]
        \vertex[dot] (a1) {};
        \vertex (l1) at ($(a1)+(-0.4,0)$) {\(x_1\)};
        \vertex[right=2cm of a1, dot] (a2) {};
        \vertex (l2) at ($(a2)+(+0.4,0)$) {\(x_2\)};
        \vertex[below=2em of a1, dot] (b1) {};
        \vertex (l3) at ($(b1)+(-0.4,0)$) {\(x_3\)};
        \vertex[below=2em of a2, dot] (b2) {};
        \vertex (l4) at ($(b2)+(+0.4,0)$) {\(x_4\)};

        \vertex[below=1.2em of a1] (r);

        \diagram* {
          (a1) [dot] -- (a2) [particle = \(x_2\)],
          (b1) [dot] -- (b2) [dot],
        };
      \end{feynman}
    \end{tikzpicture}
   \end{equation*}
   Then, the 4-point Green function can be represented as:
   \begin{equation*}
     \tempord\{\phi(x_1) \phi(x_2) \phi(x_3) \phi(x_4)\}
     =
    \begin{tikzpicture}[baseline=(r.base)]
      \begin{feynman}[inline=(r.base)]
        \vertex[dot] (a1) {};
        \vertex (l1) at ($(a1)+(-0.4,0)$) {\(x_1\)};
        \vertex[right=2cm of a1, dot] (a2) {};
        \vertex (l2) at ($(a2)+(+0.4,0)$) {\(x_2\)};
        \vertex[below=2em of a1, dot] (b1) {};
        \vertex (l3) at ($(b1)+(-0.4,0)$) {\(x_3\)};
        \vertex[below=2em of a2, dot] (b2) {};
        \vertex (l4) at ($(b2)+(+0.4,0)$) {\(x_4\)};

        \vertex[below=1.1em of a1] (r);

        \diagram* {
          (a1) [dot] -- (a2) [dot],
          (b1) [dot] -- (b2) [dot],
        };
      \end{feynman}
    \end{tikzpicture}
    \ + \
    \begin{tikzpicture}[baseline=(r.base)]
      \begin{feynman}[inline=(r.base)]
        \vertex[dot] (a1) {};
        \vertex (l1) at ($(a1)+(-0.4,0)$) {\(x_1\)};
        \vertex[right=1cm of a1, dot] (a2) {};
        \vertex (l2) at ($(a2)+(+0.4,0)$) {\(x_2\)};
        \vertex[below=2em of a1, dot] (b1) {};
        \vertex (l3) at ($(b1)+(-0.4,0)$) {\(x_3\)};
        \vertex[below=2em of a2, dot] (b2) {};
        \vertex (l4) at ($(b2)+(+0.4,0)$) {\(x_4\)};

        \vertex[below=1.1em of a1] (r);

        \diagram* {
          (a1) [dot] -- (b1) [dot],
          (a2) [dot] -- (b2) [dot],
        };
      \end{feynman}
    \end{tikzpicture}
    \ + \
    \begin{tikzpicture}[baseline=(r.base)]
      \begin{feynman}[inline=(r.base)]
        \vertex[dot] (a1) {};
        \vertex (l1) at ($(a1)+(-0.4,0)$) {\(x_1\)};
        \vertex[right=2cm of a1, dot] (a2) {};
        \vertex (l2) at ($(a2)+(+0.4,0)$) {\(x_2\)};
        \vertex[below=2em of a1, dot] (b1) {};
        \vertex (l3) at ($(b1)+(-0.4,0)$) {\(x_3\)};
        \vertex[below=2em of a2, dot] (b2) {};
        \vertex (l4) at ($(b2)+(+0.4,0)$) {\(x_4\)};

        \vertex[below=1.1em of a1] (r);

        \diagram* {
          (a1) [dot] -- (b2) [dot],
          (b1) [dot] -- (a2) [dot],
        };
      \end{feynman}
    \end{tikzpicture}
   \end{equation*}
\end{example}

Using this formalism to compute \eref{eq:corr-func-pert}, when expanding the exponential in powers of $ \ham_I $, each term contains fields at the same spacetime point: this gives rise to less trivial Feynman diagrams.

\subsubsection{Fermionic fields}

\begin{definition}{Contraction}{}
  Given a fermionic $ \Psi(x) $, its \bcdef{contraction} is defined as:
  \begin{equation}
    \wick{\c\Psi(x) \c{\bar{\Psi}}(y)} \defeq
    \begin{cases}
      \{\Psi^+(x) , \bar{\Psi}^-(y)\} & x^0 > y^0 \\
      -\{\bar{\Psi}^+(y) , \Psi^-(x)\} & y^0 > x^0
    \end{cases}
  \end{equation}
  and $ \wick{\c\Psi(x) \c\Psi(y)} = \wick{\c{\bar{\Psi}}(x) \c{\bar{\Psi}}(y)} = 0 $.
\end{definition}

By the proof of \tref{th:dirac-prop}, it is clear that:
\begin{equation}
  \tempord\{\Psi(x) \bar{\Psi}(y)\} = \normord\{\Psi(x) \bar{\Psi}(y)\} + \wick{\c\Psi(x) \c{\bar{\Psi}}(y)}
\end{equation}
Wick's theorem remains basically unchanged for fermions.

\begin{theorem}{Wick's theorem}{wick-fermion}
  Given a fermionic field $ \Psi(x) $:
  \begin{equation}
    \tempord\{\Psi(x_1) \bar{\Psi}(x_2) \dots\} = \normord\{\Psi(x_1) \bar{\Psi}(x_2) \dots \,+\, \text{all possible contractions}\}
  \end{equation}
  where both partially-contracted and fully-contracted terms are considered.
\end{theorem}

\begin{proofbox}
  \begin{proof}
    Inserting everything inside $ \normord\{\cdot\} $ ensures that the correct signs are considered due to fermionic anti-commutation, therefore the proof is analogous to that of \tref{th:wick-boson}.
  \end{proof}
\end{proofbox}

As for the bosonic counterparts, only fully-contracted terms contribute to the $ n $-point Green function, as each partially-contracted term will have either an annihilation operator acting on $ \ket{0} $ or a creation operator acting on $ \bra{0} $ (or both).

\subsubsection{Scattering in $ \lambda \phi^4 $-theory}

Consider a real scalar field theory with $ \ham_I = \frac{\lambda}{4!} \phi^4 $ and consider a scattering process with two initial particles with momenta $ \ve{k}_1 , \ve{k}_2 $ and two final particles with momenta $ \ve{p}_1 , \ve{p}_2 $. \eref{eq:lsz-scalar-field} and \eref{eq:corr-func-pert} give the amplitude:
\begin{equation*}
  \begin{split}
    \braket{\ve{p}_1 , \ve{p}_2 | i T | \ve{k}_1 , \ve{k}_2}
    & = \frac{k_1^2 - m^2}{i \sqrt{Z}} \frac{k_2^2 - m^2}{i \sqrt{Z}} \frac{p_1^2 - m^2}{i \sqrt{Z}} \frac{p_2^2 - m^2}{i \sqrt{Z}} \int \prod_{i = 1}^4 \dd^4x_i\, e^{i ({p_1}_\mu {x_1}^\mu + {p_2}_\mu {x_2}^\mu - {p_3}_\mu {x_3}^\mu - {p_4}_\mu {x_4}^\mu)} \times \\
    & \qquad \qquad \times \frac{\braket{0 | \tempord\{ \phi(x_1) \phi(x_2) \phi(x_3) \phi(x_4) \exp \left[ -i \frac{\lambda}{4!} \int \dd^4x\, \phi(x) \right] \} | 0}}{\braket{0 | \tempord\{\exp \left[ - i \frac{\lambda}{4!} \int \dd^4x\, \phi(x) \right]\} | 0}}
  \end{split}
\end{equation*}
To compute this expression up to $ o(\lambda) $, consider that for $ \lambda \phi^4 $-theory $ Z = 1 + o(\lambda^2) $, thus it is safe to set $ Z \equiv 1 $. \\
The $ o(\lambda^0) $ term is obtained setting $ \lambda = 0 $, i.e. no coupling, but in the absence of coupling there is no scattering either and the amplitude must be trivial. Recalling \exref{ex:4-green-func}:
\begin{equation*}
  \begin{split}
    & \int \dd^4x_1 \dd^4x_2 \dd^4x_3 \dd^4x_4\, e^{i ({p_1}_\mu {x_1}^\mu + {p_2}_\mu {x_2}^\mu - {p_3}_\mu {x_3}^\mu - {p_4}_\mu {x_4}^\mu)} \braket{0 | \tempord\{\phi(x_1) \phi(x_2) \phi(x_3) \phi(x_4)\} | 0} \\
    & \qquad = \int \dd^4x_1 \dd^4x_2 \dd^4x_3 \dd^4x_4\, e^{i ({p_1}_\mu {x_1}^\mu + {p_2}_\mu {x_2}^\mu - {p_3}_\mu {x_3}^\mu - {p_4}_\mu {x_4}^\mu)} \left[ D_\text{F}(x_1 - x_2) D_\text{F}(x_3 - x_4) + \dots \right] \\
    & \qquad = \left[ \int \dd^4x \dd^4X\, e^{i (p_1 + p_2)_\mu X^\mu + i (p_1 - p_2)_\mu x^\mu/2} D(x) \right] \left[ \int \dd^4y \dd^4Y\, e^{- i (k_1 + k_2)_\mu Y^\mu - i (k_1 - k_2)_\mu y^\mu/2} D(y) \right] + \dots \\
    & \qquad = (2\pi)^4 \delta^{(4)}(p_1 + p_2) \frac{i}{\left( \frac{p_1 - p_2}{2} \right)^2 - m^2} (2\pi)^4 \delta^{(4)}(k_1 + k_2) \frac{i}{\left( \frac{k_1 - k_2}{2} \right)^2 - m^2} + \dots
  \end{split}
\end{equation*}
with $ x = x_1 - x_2 , 2X = x_1 + x_2 $ and $ y = x_3 - x_4 , 2Y = x_3 + x_4 $. Using $ f(x) \delta(x - x_0) = f(x_0) \delta(x - x_0) $:
\begin{equation*}
  \begin{split}
    & \int \dd^4x_1 \dd^4x_2 \dd^4x_3 \dd^4x_4\, e^{i ({p_1}_\mu {x_1}^\mu + {p_2}_\mu {x_2}^\mu - {p_3}_\mu {x_3}^\mu - {p_4}_\mu {x_4}^\mu)} \braket{0 | \tempord\{\phi(x_1) \phi(x_2) \phi(x_3) \phi(x_4)\} | 0} \\
    & \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad = (2\pi)^4 \delta^{(4)}(p_1 + p_2) (2\pi)^4 \delta^{(4)}(k_1 + k_2) \frac{i}{p_1^2 - m^2} \frac{i}{k_1^2 - m^2} + \dots
  \end{split}
\end{equation*}
Note that the $ i\epsilon $ term must be retained while $ p $ is an integration variable, as it gives the prescription of going around the poles, but it can be dropped when $ p $ is the momentum on an external leg, i.e. fixed. This expression only has two poles, therefore:
\begin{equation*}
  \braket{\ve{p}_1 , \ve{p}_2 | i T | \ve{k}_1 , \ve{k}_2} = - (2\pi)^8 \delta^{(4)}(p_1 + p_2) \delta^{(4)}(k_1 + k_2) (p_2^2 - m^2) (k_2^2 - m^2) + \dots + o(\lambda)
\end{equation*}
These terms vanish when going on mass-shell, confirming that at $ o(\lambda^0) $ there is no interaction, i.e. no contribution to the scattering amplitude. This is a general feature of $ n \rightarrow m $ scattering amplitudes: \textit{disconnected graphs do not contribute to the amplitude}, as they do not provide enough pole factors to cancel those in the LSZ formula. \\
The first non-trivial contribution is that at $ o(\lambda) $. The numerator of \eref{eq:corr-func-pert} is:
\begin{equation*}
  \int \prod_{i = 1}^4 \dd^4x_i\, e^{i ({p_1}_\mu {x_1}^\mu + {p_2}_\mu {x_2}^\mu - {p_3}_\mu {x_3}^\mu - {p_4}_\mu {x_4}^\mu)} \left( - i \frac{\lambda}{4!} \right) \int \dd^4x \braket{0 | \tempord\{\phi(x_1) \phi(x_2) \phi(x_3) \phi(x_4) \phi^4(x)\} | 0}
\end{equation*}
The only non-vanishing contribution is the fully-contracted term:
\begin{equation*}
  \braket{0 | \wick{\c1\phi(x_1) \c2\phi(x_2) \c3\phi(x_3) \c4\phi(x_4) \c1\phi(x) \c2\phi(x) \c3\phi(x) \c4\phi(x)} | 0}
  \quad = \quad
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex[dot] (a1) {};
      \vertex (l1) at ($(a1)+(-0.4,0)$) {\(x_1\)};
      \vertex[right=2cm of a1, dot] (a2) {};
      \vertex (l2) at ($(a2)+(+0.4,0)$) {\(x_2\)};
      \vertex[below=2em of a1, dot] (b1) {};
      \vertex (l3) at ($(b1)+(-0.4,0)$) {\(x_3\)};
      \vertex[below=2em of a2, dot] (b2) {};
      \vertex (l4) at ($(b2)+(+0.4,0)$) {\(x_4\)};
      \vertex[below=1em of a1] (c1) {};
      \vertex[right=1cm of c1, dot] (c2) {};
      \vertex (l5) at ($(c2)+(0,+0.3)$) {\(x\)};

      \vertex[below=1.1em of a1] (r);

      \diagram* {
        (a1) [dot] -- (b2) [dot],
        (b1) [dot] -- (a2) [dot],
      };
    \end{feynman}
  \end{tikzpicture}
\end{equation*}
as it is the only connected diagram between the possible ones. Note that this diagram corresponds to $ 4! $ equal contractions (only one is shown), therefore the numerator becomes:
\begin{equation*}
  \begin{split}
    & -i \lambda \int \dd^4x \prod_{i = 1}^4 \dd^4x_i\, e^{i ({p_1}_\mu {x_1}^\mu + {p_2}_\mu {x_2}^\mu - {p_3}_\mu {x_3}^\mu - {p_4}_\mu {x_4}^\mu)} D_\text{F}(x_1 - x) D_\text{F}(x_2 - x) D_\text{F}(x_3 - x) D_\text{F}(x_4 - x) \\
    & = -i \lambda \tilde{D}_\text{F}(p_1) \tilde{D}_\text{F}(p_2) \tilde{D}_\text{F}(k_1) \tilde{D}_\text{F}(k_2) \int \dd^4x\, e^{i (p_1 + p_2 - k_1 - k_2)_\mu x^\mu} \\
    & = -i \lambda (2\pi)^4 \delta^{(4)}(p_1 + p_2 - k_1 - k_2) \frac{i}{p_1^2 - m^2} \frac{i}{p_2^2 - m^2} \frac{i}{k_1^2 - m^2} \frac{i}{k_2^2 - m^2}
  \end{split}
\end{equation*}
There remains to evaluate the denominator: this term gives only \bctxt{vacuum-to-vacuum transitions}, i.e. diagrams with no external legs. To account for these, note that each connected diagram which contributes to the numerator can be $ \virgolette{dressed} $ with all possible vacuum-to-vacuum transitions; indeed, to be precise:
\begin{equation*}
  \braket{0 | \wick{\c1\phi(x_1) \c2\phi(x_2) \c3\phi(x_3) \c4\phi(x_4) \c1\phi(x) \c2\phi(x) \c3\phi(x) \c4\phi(x)} | 0} =
\end{equation*}
\begin{equation*}
  = \quad
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex[dot] (a1) {};
      \vertex (l1) at ($(a1)+(-0.4,0)$) {\(x_1\)};
      \vertex[right=2cm of a1, dot] (a2) {};
      \vertex (l2) at ($(a2)+(+0.4,0)$) {\(x_2\)};
      \vertex[below=2em of a1, dot] (b1) {};
      \vertex (l3) at ($(b1)+(-0.4,0)$) {\(x_3\)};
      \vertex[below=2em of a2, dot] (b2) {};
      \vertex (l4) at ($(b2)+(+0.4,0)$) {\(x_4\)};
      \vertex[below=1em of a1] (c1) {};
      \vertex[right=1cm of c1, dot] (c2) {};
      \vertex (l5) at ($(c2)+(0,+0.3)$) {\(x\)};

      \vertex[below=1.1em of a1] (r);

      \diagram* {
        (a1) [dot] -- (b2) [dot],
        (b1) [dot] -- (a2) [dot],
      };
    \end{feynman}
  \end{tikzpicture}
  \quad + \quad
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex[dot] (a1) {};
      \vertex (l1) at ($(a1)+(-0.4,0)$) {\(x_1\)};
      \vertex[right=2cm of a1, dot] (a2) {};
      \vertex (l2) at ($(a2)+(+0.4,0)$) {\(x_2\)};
      \vertex[below=2em of a1, dot] (b1) {};
      \vertex (l3) at ($(b1)+(-0.4,0)$) {\(x_3\)};
      \vertex[below=2em of a2, dot] (b2) {};
      \vertex (l4) at ($(b2)+(+0.4,0)$) {\(x_4\)};
      \vertex[below=1em of a1] (c1) {};
      \vertex[right=1cm of c1, dot] (c2) {};
      \vertex (l5) at ($(c2)+(0,+0.3)$) {\(x\)};

      \vertex[above=3em of c2, dot] (d1) {};
      \vertex[right=1cm of d1, empty dot] (d2) {};
      \vertex[left=1cm of d1, empty dot] (d3) {};

      \vertex[below=1.1em of a1] (r);

      \diagram* {
        (a1) [dot] -- (b2) [dot],
        (b1) [dot] -- (a2) [dot],

        (d1) -- [half right] (d2) -- [half right] (d1),
        (d1) -- [half left] (d3) -- [half left] (d1),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad + \quad
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex[dot] (a1) {};
      \vertex (l1) at ($(a1)+(-0.4,0)$) {\(x_1\)};
      \vertex[right=2cm of a1, dot] (a2) {};
      \vertex (l2) at ($(a2)+(+0.4,0)$) {\(x_2\)};
      \vertex[below=2em of a1, dot] (b1) {};
      \vertex (l3) at ($(b1)+(-0.4,0)$) {\(x_3\)};
      \vertex[below=2em of a2, dot] (b2) {};
      \vertex (l4) at ($(b2)+(+0.4,0)$) {\(x_4\)};
      \vertex[below=1em of a1] (c1) {};
      \vertex[right=1cm of c1, dot] (c2) {};
      \vertex (l5) at ($(c2)+(0,+0.3)$) {\(x\)};

      \vertex[above=3em of c2] (d0) {};
      \vertex[left=0.5cm of d0, dot] (d1) {};
      \vertex[right=1cm of d1, dot] (d2) {};
      \vertex[left=1cm of d1, empty dot] (d3) {};
      \vertex[right=1cm of d2, empty dot] (d4) {};

      \vertex[below=1.1em of a1] (r);

      \diagram* {
        (a1) [dot] -- (b2) [dot],
        (b1) [dot] -- (a2) [dot],

        (d1) -- [half right] (d2) -- [half right] (d1),
        (d1) -- [half left] (d3) -- [half left] (d1),
        (d2) -- [half right] (d4) -- [half right] (d2),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad + \quad \dots
\end{equation*}
\begin{equation*}
  = \quad
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex[dot] (a1) {};
      \vertex (l1) at ($(a1)+(-0.4,0)$) {\(x_1\)};
      \vertex[right=2cm of a1, dot] (a2) {};
      \vertex (l2) at ($(a2)+(+0.4,0)$) {\(x_2\)};
      \vertex[below=2em of a1, dot] (b1) {};
      \vertex (l3) at ($(b1)+(-0.4,0)$) {\(x_3\)};
      \vertex[below=2em of a2, dot] (b2) {};
      \vertex (l4) at ($(b2)+(+0.4,0)$) {\(x_4\)};
      \vertex[below=1em of a1] (c1) {};
      \vertex[right=1cm of c1, dot] (c2) {};
      \vertex (l5) at ($(c2)+(0,+0.3)$) {\(x\)};

      \vertex[below=1.1em of a1] (r);

      \diagram* {
        (a1) [dot] -- (b2) [dot],
        (b1) [dot] -- (a2) [dot],
      };
    \end{feynman}
  \end{tikzpicture}
  \quad \times \quad \bigg[ \ 1 \quad + \quad
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex[dot] (d1) {};
      \vertex[right=1cm of d1, empty dot] (d2) {};
      \vertex[left=1cm of d1, empty dot] (d3) {};

      \vertex[below=0.3em of d1] (r);

      \diagram* {
        (d1) -- [half right] (d2) -- [half right] (d1),
        (d1) -- [half left] (d3) -- [half left] (d1),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad + \quad
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex (d0) {};
      \vertex[left=0.5cm of d0, dot] (d1) {};
      \vertex[right=1cm of d1, dot] (d2) {};
      \vertex[left=1cm of d1, empty dot] (d3) {};
      \vertex[right=1cm of d2, empty dot] (d4) {};

      \vertex[below=0.3em of d0] (r);

      \diagram* {
        (d1) -- [half right] (d2) -- [half right] (d1),
        (d1) -- [half left] (d3) -- [half left] (d1),
        (d2) -- [half right] (d4) -- [half right] (d2),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad + \quad \dots \ \bigg]
\end{equation*}
This is nothing but the perturbative expansion of the denominator of \eref{eq:corr-func-pert}, therefore they cancel out leaving only the already computed diagram\footnotemark. Thus, the transition amplitude at $ o(\lambda) $ is:
\begin{equation}
  \braket{\ve{p}_1 , \ve{p}_2 | i T | \ve{k}_1 , \ve{k}_2} = -i \lambda (2\pi)^4 \delta^{(4)}(p_1 + p_2 - k_1 - k_2)
\end{equation}

\footnotetext{This too is a general statement. Consider a generic process with possible connected diagrams $ \{C_i\}_{i \in \mathcal{I}} $ and possible vacuum-to-vacuum diagrams $ \{V_j\}_{j \in \mathcal{J}} $. Then, as shown above, the contribution of a connected diagram $ C_i $ is really:
\begin{equation*}
  C_i \times \sum_{\{n_j\} \subset \N_0} \prod_{j \in \mathcal{J}} \frac{1}{n_j!} V_j^{n_j}
\end{equation*}
with $ \{n_j\}_{j \in \mathcal{J}} \subset \N_0 $ (the symmetry factor is due to the swap of identical diagrams). The sum of all non-vanishing diagrams thus is:
\begin{equation*}
  \begin{split}
    \sum (\text{diagrams})
    & = \sum_{i \in \mathcal{I}} C_i \times \sum_{\{n_j\} \subset \N_0} \prod_{j \in \mathcal{J}} \frac{1}{n_j!} V_j^{n_j} = \sum_{i \in \mathcal{I}} C_i \times \prod_{j \in \mathcal{J}} \sum_{n = 1}^\infty \frac{1}{n!} V_j^n = \sum_{i \in \mathcal{I}} C_i \times \prod_{j \in \mathcal{J}} \exp V_j = \sum_{i \in \mathcal{I}} C_i \times \exp \sum_{j \in \mathcal{J}} V_j
  \end{split}
\end{equation*}
which can be recast in the form:
\begin{equation}
  \sum (\text{diagrams}) = \sum (\text{connected}) \times \exp \sum (\text{vacuum-to-vacuum})
\end{equation}
The exponential exactly cancels $ \braket{0 | \tempord\{\exp \left[ -i \int \dd^4x\, \ham_I \right]\} | 0} $, leaving only connected diagrams in the calculation.}

\subsubsection{Scattering in $ \lambda \phi^3 $-theory}

To illustrate the case of internal lines, it is useful to consider a real scalar field theory with $ \ham_I = \frac{\lambda}{3!} \phi^3 $: in this case, 3 lines meet at each vertex, instead of 4. The $ 2 \rightarrow 2 $ scattering amplitude is:
\begin{equation*}
  \begin{split}
    \braket{\ve{p}_1 , \ve{p}_2 | i T | \ve{k}_1 , \ve{k}_2}
    & = \prod_{i = 1,2} \frac{p_i^2 - m^2}{i \sqrt{Z}} \prod_{j = 1,2} \frac{k_j^2 - m^2}{i \sqrt{Z}} \int \prod_{i = 1}^4 \dd^4x_i\, e^{i ({p_1}_\mu x_1^\mu + {p_2}_\mu x_2^\mu - {k_1}_\mu x_3^\mu - {k_4}_\mu x_4^\mu)} \times \\
    & \qquad \qquad \qquad \qquad \times \braket{0 | \tempord\{\phi(x_1) \phi(x_2) \phi(x_3) \phi(x_4) \exp \left[ -i \frac{\lambda}{3!} \int \dd^4x\, \phi^3(x) \right]\} | 0}
  \end{split}
\end{equation*}
where the denominator was omitted by implicitly considering only connected graphs with 4 external legs. This amplitude does not have a $ o(\lambda^0) $ contribution (as it only has disconnected diagrams) nor an $ o(\lambda) $ contribution (as the product of an odd number of fields cannot be fully contracted). At $ o(\lambda^2) $ the integral becomes:
\begin{equation*}
    \int \prod_{i = 1}^4 \dd^4x_i\, e^{i ({p_1}_\mu x_1^\mu + {p_2}_\mu x_2^\mu - {k_1}_\mu x_3^\mu - {k_4}_\mu x_4^\mu)} \frac{1}{2!} \left( -i \frac{\lambda}{3!} \right)^2 \int \dd^4x \dd^4y \braket{0 | \tempord\{\phi(x_1) \phi(x_2) \phi(x_3) \phi(x_4) \phi^3(x) \phi^3(y)\} | 0}
\end{equation*}
In order to obtain a fully connected diagrams, there needs to be a contraction $ \wick{\c\phi(x) \c\phi(y)} $ between the two vertices, creating an internal line. Note that the $ 1/2! $ factor accounts for the symmetry $ x \leftrightarrow y $, while $ 1/3! $ accounts for sets of equivalent contractions. Examples of possible diagrams are:
\begin{equation*}
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex[dot] (x) {};
      \vertex (lx) at ($(x)+(0,0.4)$) {\(x\)};
      \vertex[right=4.242em of x, dot] (y) {};
      \vertex (ly) at ($(y)+(0,0.4)$) {\(y\)};

      \vertex[above=3em of x] (p1) {};
      \vertex[left=3em of p1, dot] (x1) {};
      \vertex (l1) at ($(x1)+(-0.4,0)$) {\(x_1\)};
      \vertex[below=6em of x1, dot] (x2) {};
      \vertex (l2) at ($(x2)+(-0.4,0)$) {\(x_2\)};

      \vertex[above=3em of y] (p2) {};
      \vertex[right=3em of p2, dot] (x3) {};
      \vertex (l3) at ($(x3)+(0.4,0)$) {\(x_3\)};
      \vertex[below=6em of x3, dot] (x4) {};
      \vertex (l4) at ($(x4)+(0.4,0)$) {\(x_4\)};

      \vertex[below=0.3em of x] (r) {};

      \diagram* {
        (x1) -- (x) -- (y) -- (x3),
        (x2) -- (x),
        (y) -- (x4),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad = \quad
  D_\text{F}(x_1 - x) D_\text{F}(x_2 - x) D_\text{F}(x - y) D_\text{F}(y - x_3) D_\text{F}(y - x_4)
\end{equation*}
\begin{equation*}
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex[dot] (x) {};
      \vertex (lx) at ($(x)+(0.4,0)$) {\(x\)};
      \vertex[above=2em of x, dot] (y) {};
      \vertex (ly) at ($(y)+(0.4,0)$) {\(y\)};

      \vertex[above=2em of y] (p1) {};
      \vertex[left=3em of p1, dot] (x1) {};
      \vertex (l1) at ($(x1)+(-0.4,0)$) {\(x_1\)};
      \vertex[below=6em of x1, dot] (x2) {};
      \vertex (l2) at ($(x2)+(-0.4,0)$) {\(x_2\)};

      \vertex[right=3em of p1, dot] (x3) {};
      \vertex (l3) at ($(x3)+(0.4,0)$) {\(x_3\)};
      \vertex[below=6em of x3, dot] (x4) {};
      \vertex (l4) at ($(x4)+(0.4,0)$) {\(x_4\)};

      \vertex[above=0.7em of x] (r) {};

      \diagram* {
        (x1) -- (y) -- (x3),
        (x) -- (y),
        (x2) -- (x) -- (x4),
      };
    \end{feynman}
  \end{tikzpicture}
  \quad = \quad
  D_\text{F}(x_1 - y) D_\text{F}(x_2 - x) D_\text{F}(x - y) D_\text{F}(y - x_3) D_\text{F}(x - x_4)
\end{equation*}
These diagrams are inequivalent, as they correspond to different sets of contractions. Computing for example the first one:
\begin{equation*}
  \begin{split}
    & (-i \lambda)^2 \int \prod_{i = 1}^4 \dd^4x_i\, e^{i ({p_1}_\mu x_1^\mu + {p_2}_\mu x_2^\mu - {k_1}_\mu x_3^\mu - {k_4}_\mu x_4^\mu)} \times \\
    & \qquad \qquad \qquad \qquad \qquad \qquad \times \int \dd^4x \dd^4y\, D_\text{F}(x_1 - x) D_\text{F}(x_2 - x) D_\text{F}(x - y) D_\text{F}(y - x_3) D_\text{F}(y - x_4) \\
    & = (-i \lambda)^2 \tilde{D}_\text{F}(p_1) \tilde{D}_\text{F}(p_2) \tilde{D}_\text{F}(k_1) \tilde{D}_\text{F}(k_2) \int \dd^4x \dd^4y\, e^{i (p_1 + p_2)_\mu x^\mu - i (k_1 + k_2)_\mu y^\mu} D_\text{F}(x - y) \\
    & = (-i \lambda)^2 \tilde{D}_\text{F}(p_1) \tilde{D}_\text{F}(p_2) \tilde{D}_\text{F}(k_1) \tilde{D}_\text{F}(k_2) \int \dd^4X \dd^4Y\, e^{i (p_1 + p_2 - k_1 - k_2)_\mu Y^\mu + i (p_1 + p_2 + k_1 + k_2)_\mu X^\mu / 2} D_\text{F}(X) \\
    & = (-i \lambda)^2 (2\pi)^4 \delta^{(4)}(p_1 + p_2 - k_1 - k_2) \tilde{D}_\text{F}(p_1) \tilde{D}_\text{F}(p_2) \tilde{D}(p_1 + p_2) \tilde{D}_\text{F}(k_1) \tilde{D}_\text{F}(k_2)
  \end{split}
\end{equation*}
with $ X = x - y , 2Y = x + y $. As expected, momentum-space propagators associated to external legs are canceled by pole terms in the LSZ formula: now there remains only the $ \tilde{D}_\text{F}(p_1 + p_2) $ factor associated to the internal line. \\
It is useful to work in momentum space, rather than coordinate space. For example, in momentum space the above diagrams become:
\begin{equation*}
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex[dot] (x) {};
      \vertex[right=5em of x, dot] (y) {};

      \vertex[above=3em of x] (p1) {};
      \vertex[left=3em of p1] (x1) {};
      \vertex[below=6em of x1] (x2) {};

      \vertex[above=3em of y] (p2) {};
      \vertex[right=3em of p2] (x3) {};
      \vertex[below=6em of x3] (x4) {};

      \vertex[below=0.3em of x] (r) {};

      \diagram* {
        (x1) -- [momentum = \(p_1\)] (x) -- [momentum = \(p_1 + p_2\)] (y) -- [momentum = \(k_1\)] (x3),
        (x2) -- [momentum' = \(p_2\)] (x),
        (y) -- [momentum' = \(k_2\)] (x4),
      };
    \end{feynman}
  \end{tikzpicture}
  \qquad \qquad \qquad \qquad
  \begin{tikzpicture}[baseline=(r.base)]
    \begin{feynman}[inline=(r.base)]
      \vertex[dot] (x) {};
      \vertex[above=4em of x, dot] (y) {};

      \vertex[above=2em of y] (p1) {};
      \vertex[left=5em of p1] (x1) {};
      \vertex[below=8em of x1] (x2) {};

      \vertex[right=5em of p1] (x3) {};
      \vertex[below=8em of x3] (x4) {};

      \vertex[above=1.7em of x] (r) {};

      \diagram* {
        (x1) -- [momentum = \(p_1\)] (y) -- [momentum' = \(k_1\)] (x3),
        (x) -- [momentum = \(p_2 - k_2\)] (y),
        (x2) -- [momentum' = \(p_2\)] (x) -- [momentum = \(k_2\)] (x4),
      };
    \end{feynman}
  \end{tikzpicture}
\end{equation*}

\subsubsection{General considerations}

The example calculations carried for $ \lambda \phi^3 $- and $ \lambda \phi^4 $-theory hint to the general technique to compute general \bctxt{tree diagrams}, i.e. connected diagrams without internal loops. For a scalar field theory, in momentum space:
\begin{enumerate}
  \item draw all possible connected graphs corresponding to the given initial and final states;
  \item each external leg is associated to a pole factor in the LSZ reduction formula, hence they can be omitted directly ($ \virgolette{leg amputation} $);
  \item as there is always a momentum-conserving $ \delta $-function, it is convenient to define the matrix element $ \mat_\text{if} $ for the process $ \ket{\text{i}} \rightarrow \ket{\text{f}} $ as:
    \begin{equation}
      \braket{\ve{p}_1 , \dots , \ve{p}_m | i T | \ve{k}_1 , \dots , \ve{k}_n} \equiv (2\pi)^4 \delta^{(4)}\left( \sum_{i = 1}^{m} p_i - \sum_{j = 1}^{n} k_j \right) i \mat_\text{if}
      \label{eq:mat-el}
    \end{equation}
  \item energy-momentum conservation must be imposed separately at each vertex;
  \item each vertex is associated to a $ -i \lambda $ factor, where $ \lambda $ is the coupling constant of the interaction;
  \item check if that symmetry factors cancel fully or partially with the $ 1/n! $ factor at $ o(\lambda^n) $ and possible numerical factors in the definition of $ \ham_I $.
\end{enumerate}

\subsection{Loop diagrams}

To illustrate how loop diagrams are treated, consider the $ o(\lambda^2) $ corrections to the $ 2 \rightarrow 2 $ scattering in $ \lambda \phi^4 $-theory:
\begin{multline*}
  \frac{1}{2!} \left( -i \frac{\lambda}{4!} \right)^2 \int \prod_{i = 1}^4 \dd^4x_i\, e^{i ({p_1}_\mu x_1^\mu + {p_2}_\mu x_2^\mu - {k_1}_\mu x_3^\mu - {k_4}_\mu x_4^\mu)} \times \\
  \times \int \dd^4x \dd^4y \braket{0 | \tempord\{\phi(x_1) \phi(x_2) \phi(x_3) \phi(x_4) \phi^4(x) \phi^4(y)\} | 0}
\end{multline*}
There are three possible inequivalent full contractions, associated to the connected diagrams:
\begin{equation*}
  \begin{tikzpicture}[baseline = (r.base)]
    \begin{feynman}[inline = (r.base)]
      \vertex (x1) {};
      \vertex[below=3em of x1] (p1) {};
      \vertex[below=3em of p1] (x2) {};

      \vertex[right=3em of p1, dot] (v1) {};
      \vertex[right=5em of v1, dot] (v2) {};

      \vertex[right=3em of v2] (p2) {};
      \vertex[above=3em of p2] (x3) {};
      \vertex[below=3em of p2] (x4) {};

      \vertex[above=0.5em of v1] (r) {};

      \diagram* {
        (x1) -- [momentum = \(p_1\)] (v1),
        (x2) -- [momentum' = \(p_2\)] (v1),
        (v2) -- [momentum = \(k_1\)] (x3),
        (v2) -- [momentum' = \(k_2\)] (x4),

        (v1) -- [half left, momentum' = \(p\)] (v2),
        (v2) -- [half left, momentum' = \(p'\)] (v1),
      };
    \end{feynman}
  \end{tikzpicture}
  \qquad
  \begin{tikzpicture}[baseline = (r.base)]
    \begin{feynman}[inline = (r.base)]
      \vertex (x1) {};
      \vertex[right=4em of x1] (p1) {};
      \vertex[right=4em of p1] (x3) {};

      \vertex[below=2em of p1, dot] (v1) {};
      \vertex[below=5em of v1, dot] (v2) {};

      \vertex[below=9em of x1] (x2) {};
      \vertex[below=9em of x3] (x4) {};

      \vertex[below=2em of v1] (r) {};

      \diagram* {
        (x1) -- [momentum = \(p_1\)] (v1) -- [momentum = \(k_1\)] (x3),
        (x2) -- [momentum' = \(p_2\)] (v2) -- [momentum' = \(k_2\)] (x4),

        (v1) -- [half left, momentum = \(p\)] (v2),
        (v2) -- [half left, momentum = \(p + k_1 - p_1\)] (v1),
      };
    \end{feynman}
  \end{tikzpicture}
  \qquad
  \begin{tikzpicture}[baseline = (r.base)]
    \begin{feynman}[inline = (r.base)]
      \vertex (x1) {};
      \vertex[right=4em of x1] (p1) {};
      \vertex[right=4em of p1] (x3) {};

      \vertex[below=2em of p1, dot] (v1) {};
      \vertex[below=5em of v1, dot] (v2) {};

      \vertex[below=9em of x1] (x2) {};
      \vertex[below=9em of x3] (x4) {};

      \vertex[below=2em of v1] (r) {};

      \diagram* {
        (x1) -- [momentum = \(p_1\)] (v1) -- [momentum = \(k_2\)] (x3),
        (x2) -- [momentum' = \(p_2\)] (v2) -- [momentum' = \(k_1\)] (x4),

        (v1) -- [half left, momentum = \(p\)] (v2),
        (v2) -- [half left, momentum = \(p + k_2 - p_1\)] (v1),
      };
    \end{feynman}
  \end{tikzpicture}
\end{equation*}
with $ p' = p_1 + p_2 - p $. It is clear that energy conservation does not completely fix momenta of internal lines, and in particular of loops.
Consider for example the first diagram: it is obtained contracting $ \phi(x_1) $ and $ \phi(x_2) $ with two $ \phi(x) $ ($ 4 \cdot 3 $ ways), $ \phi(x_3) $ and $ \phi(x_4) $ with two $ \phi(y) $ ($ 4 \cdot 3 $ ways) and two $ \phi(x) $ with two $ \phi(y) $ ($ 2 $ ways), so, considering another $ 2 $ factor for $ x \leftrightarrow y $ symmetry, this diagram has symmetry number $ S = (4!)^2 $. The resulting contribution is:
\begin{equation*}
  \begin{split}
    & \frac{(-i \lambda)^2}{2} \int \prod_{i = 1}^4 \dd^4x_i\, e^{i ({p_1}_\mu x_1^\mu + {p_2}_\mu x_2^\mu - {k_1}_\mu x_3^\mu - {k_4}_\mu x_4^\mu)} \int \dd^4x \dd^4y D_\text{F}(x_1 - x) D_\text{F}(x_2 - x) D_\text{F}(x - y) D_\text{F}(y - x) \\
    & = \frac{(-i \lambda)^2}{2} \tilde{D}_\text{F}(p_1) \tilde{D}_\text{F}(p_2) \tilde{D}_\text{F}(k_1) \tilde{D}_\text{F}(k_2) \int \dd^4x \dd^4y\, e^{i (p_1 + p_2)_\mu x^\mu - i (k_1 + k_2)_\mu y^\mu} D^2(x - y) \\
    & = \frac{(-i \lambda)^2}{2} \tilde{D}_\text{F}(p_1) \tilde{D}_\text{F}(p_2) \tilde{D}_\text{F}(k_1) \tilde{D}_\text{F}(k_2) (2\pi)^4 \delta^{(4)}(p_1 + p_2 - k_1 - k_2) \int \frac{\dd^4k}{(2\pi)^4} \tilde{D}_\text{F}(k) \tilde{D}_\text{F}(p_1 + p_2 - k)
  \end{split}
\end{equation*}
Therefore, the additional feature of loop integrals is the integration over unfixed momenta, assigning the right propagators to each internal line. It is possible to define the \bctxt{loop-amplitude} for $ \lambda \phi^4 $-theory:
\begin{equation}
  \mathcal{A}(p) \defeq \frac{(-i \lambda)^2}{2} \int \frac{\dd^4k}{(2\pi)^4} \frac{i}{k^2 - m^2 + i \epsilon} \frac{i}{(p - k)^2 - m^2 + i \epsilon}
  \label{eq:f4-loop-ampl}
\end{equation}
so that the $ 2 \rightarrow 2 $ scattering amplitude at one-loop level (i.e. $ o(\lambda^2) $) is:
\begin{equation}
  i \mat_{2 \rightarrow 2} = -i \lambda + \mathcal{A}(p_1 + p_2) + \mathcal{A}(p_1 - k_1) + \mathcal{A}(p_1 - k_2)
\end{equation}

\subsubsection{Divergences}

The integral in \eref{eq:f4-loop-ampl} diverges at large $ k $, which is an example of \bctxt{UV divergence}. To study this divergence, first of all note that $ (p - k)^2 \rightarrow k^2 $ as $ k \rightarrow \infty $, so that it is safe to set $ p = 0 $. Due to the $ i\epsilon $-presciption, in the complex $ k^0 $-plane the pole in $ k^0 > 0 $ is below the real axis, while that in $ k^0 < 0 $ is above it: the integration path can then be rotated counterclockwise from the real axis to the imaginary axis by $ k^0 \mapsto i k^0 $, which is called a \bctxt{Wick rotation}. The amplitude then becomes:
\begin{equation*}
    \mathcal{A}(0) = \frac{(-i \lambda)^2}{2} \int \frac{\dd^4k}{(2\pi)^4} \left( \frac{i}{k^2 - m^2 + i\epsilon} \right)^2 \mapsto i \frac{\lambda^2}{2} \int \frac{\dd^4k}{(2\pi)^4} \frac{1}{(k^2 + m^2)^2}
\end{equation*}
where $ k^2 = k_0^2 + \ve{k}^2 $ is now a Euclidean momentum. To regulate the UV divergence, a cutoff $ \Lambda : k^2 < \Lambda^2 $ is introduced, so that:
\begin{equation*}
  \begin{split}
    \mathcal{A}(0)
    & = i \frac{\lambda^2}{2} \int \frac{\dd^4k}{(2\pi)^4} \frac{1}{k^4} + \text{finite terms} = i \frac{\lambda^2}{2} \frac{1}{(2\pi)^4} 2\pi^2 \int^\Lambda \frac{\dd k}{k} + \text{finite terms}\\
    & = \frac{i \lambda^2}{16 \pi^2} \log \Lambda + \text{finite terms}
  \end{split}
\end{equation*}
where $ 2\pi^2 $ is the solid angle in $ \R^4 $. It can be shown that, for general $ p $, the singular part of $ \mathcal{A}(p) $ does not depend on $ p $; hence, it can be written:
\begin{equation*}
  i \mat_{2 \rightarrow 2} = -i \lambda + i \lambda^2 \left( \beta_0 \log \Lambda + \text{finite terms} \right)
\end{equation*}
where:
\begin{equation}
  \beta_0 \equiv \frac{3}{16 \pi^2}
\end{equation}
Another example of loop divergence in $ \lambda \phi^4 $-theory is that associated to the 2-point Green function at $ o(\lambda^1) $:
\begin{equation*}
  \braket{0 | \tempord\{\phi(x_1) \phi(x_2) \phi^4(x)\} | 0} = 4\cdot3 \cdot \wick{\c1\phi(x_1) \c2\phi(x_2) \c1\phi(x) \c2\phi(x) \c1\phi(x) \c1\phi(x)} = \ 4\cdot3 \ \times \
  \begin{tikzpicture}[baseline = (r.base)]
    \begin{feynman}[inline = (r.base)]
      \vertex (x1) {};
      \vertex[right=5em of x1, dot] (v1) {};
      \vertex[above=4em of v1, empty dot] (v2) {};
      \vertex[right=5em of v1] (x2) {};

      \vertex[below=0.2em of v1] (r) {};

      \diagram* {
        (x1) -- [momentum' = \(p\)] (v1) -- [momentum' = \(p\)] (x2),
        (v1) -- [half left, momentum' = \(k\)] (v2),
        (v2) -- [half left, momentum' = \(k\)] (v1),
      };
    \end{feynman}
  \end{tikzpicture}
\end{equation*}
This diagram is typically called a \bctxt{tadpole}. Its contribution can be computed in momentum performing a Wick rotation:
\begin{equation}
  -i B \equiv \frac{-i \lambda}{2} \int \frac{\dd^4k}{(2\pi)^4} \frac{1}{k^2 + m^2} = - i \frac{\lambda}{32\pi^2} \left( \Lambda^2 - m^2 \log \frac{\Lambda^2 + m^2}{m^2} \right)
\end{equation}
Note that the tadpole is independent of $ p $, and it has both a quadratic and logarithmic UV divergence.

\begin{lemma}{Tadpole resummation}{}
  In $ \lambda \phi^4 $-theory, for a $ \ket{\ve{p}} \rightarrow \ket{\ve{p}} $ scattering, tadpole diagrams collectively contribute as:
  \begin{equation*}
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex (x1) {};
        \vertex[right=2em of x1, dot] (v1) {};
        \vertex[above=2em of v1, empty dot] (v2) {};
        \vertex[right=2em of v1] (x2) {};

        \vertex[below=0.2em of v1] (r) {};

        \diagram* {
          (x1) -- (v1) -- (x2),

          (v1) -- [half left] (v2),
          (v2) -- [half left] (v1),
        };
      \end{feynman}
    \end{tikzpicture}
    \quad + \quad
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex (x1) {};
        \vertex[right=2em of x1, dot] (v1) {};
        \vertex[above=2em of v1, empty dot] (v2) {};
        \vertex[right=4em of v1, dot] (v3) {};
        \vertex[above=2em of v3, empty dot] (v4) {};
        \vertex[right=2em of v3] (x2) {};

        \vertex[below=0.2em of v1] (r) {};

        \diagram* {
          (x1) -- (v1) -- (v3) -- (x2),

          (v1) -- [half left] (v2),
          (v2) -- [half left] (v1),

          (v3) -- [half left] (v4),
          (v4) -- [half left] (v3),
        };
      \end{feynman}
    \end{tikzpicture}
    \quad + \quad
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex (x1) {};
        \vertex[right=2em of x1, dot] (v1) {};
        \vertex[above=2em of v1, empty dot] (v2) {};
        \vertex[right=4em of v1, dot] (v3) {};
        \vertex[above=2em of v3, empty dot] (v4) {};
        \vertex[right=4em of v3, dot] (v5) {};
        \vertex[above=2em of v5, empty dot] (v6) {};
        \vertex[right=2em of v5] (x2) {};

        \vertex[below=0.2em of v1] (r) {};

        \diagram* {
          (x1) -- (v1) -- (v3) -- (v5) -- (x2),

          (v1) -- [half left] (v2),
          (v2) -- [half left] (v1),

          (v3) -- [half left] (v4),
          (v4) -- [half left] (v3),

          (v5) -- [half left] (v6),
          (v6) -- [half left] (v5),
        };
      \end{feynman}
    \end{tikzpicture}
    \quad + \quad \dots
  \end{equation*}
  \begin{equation*}
    = \frac{i}{p^2 - m^2 - B}
  \end{equation*}
\end{lemma}

\begin{proofbox}
  \begin{proof}
    The represented diagram series reduces to a geometric series in momentum space:
    \begin{equation*}
      \begin{split}
        & \tilde{D}_\text{F}(p) + \tilde{D}_\text{F}(p) (-iB) \tilde{D}_\text{F}(p) + \tilde{D}_\text{F}(p) (-iB) \tilde{D}_\text{F}(p) (-iB) \tilde{D}_\text{F}(p) + \dots \\
        & = \tilde{D}_\text{F}(p) \sum_{n = 0}^{\infty} \left[ -i B \tilde{D}_\text{F}(p) \right]^n = \tilde{D}_\text{F} \frac{1}{1 + i B \tilde{D}_\text{F}(p)} = \frac{i}{p^2 - m^2} \left[ 1 - \frac{B}{p^2 - m^2} \right]^{-1} = \frac{i}{p^2 - m^2 - B}
      \end{split}
    \end{equation*}
    which is the thesis.
  \end{proof}
\end{proofbox}

This shows that accounting for tadpole diagrams is equivalent to shifting the mass $ m^2 \mapsto m^2 + B $.

\subsection{Feynman rules}

To compute amplitudes up to a desired order, it is not necessary to explicitly expanding the exponential each time and then performing Wick contractions, as these steps are summarized by a simple set of rules.

\subsubsection{$ \lambda \phi^n $-theory}

Consider a scalar field theory with Hamiltonian:
\begin{equation}
  \ham = \ham_\text{KG} + \frac{\lambda}{n!} \phi^n
\end{equation}
The Feynman rules in momentum space for this theory are:
\begin{enumerate}
  \item for each internal line:
    $
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex[dot] (x) {};
        \vertex[right=4em of x, dot] (y) {};

        \vertex[below=0.2em of x] (r) {};

        \diagram* {
          (x) -- [momentum = \(p\)] (y),
        };
      \end{feynman}
    \end{tikzpicture}
    = \tilde{D}_\text{F}(p)
    $;
  \item for each external leg:
    $
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex[dot] (x) {};
        \vertex[right=4em of x] (y) {};

        \vertex[below=0.2em of x] (r) {};

        \diagram* {
          (x) -- (y),
        };
      \end{feynman}
    \end{tikzpicture}
    = 1
    $;
  \item for each vertex:
    $
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex[dot] (x) {};
      \end{feynman}
    \end{tikzpicture}
    = -i \lambda
    $;
  \item impose momentum conservation at each vertex;
  \item integrate over each undetermined loop momentum $ p $ with measure $ \frac{\dd^4p}{(2\pi)^4} $;
  \item divide by the symmetry factor of the diagram.
\end{enumerate}

The problem of computing scattering amplitude is thus reduced to that of drawing every inequivalent fully-connected Feynman diagram (modulo void-to-void diagrams). These rules allow to compute the matrix element $ \mat_\text{if} $, which is related to the $ T $-matrix element by \eref{eq:mat-el} and to the $ S $-matrix element by $ S = 1 + i T $.

\subsubsection{Yukawa theory}

Consider a field theory with a real scalar field $ \phi(x) $ and a Dirac field $ \Psi(x) $. The \bctxt{Yukawa Hamiltonian} is:
\begin{equation}
  \ham = \ham_\text{KG} + \ham_\text{D} + g \bar{\Psi} \Psi \phi
\end{equation}
where $ g $ is a dimensionless coupling constant. This is a simplified model of QED. Note that the form of $ \ham_\text{int} $ allows interaction vertices with two fermion lines and one scalar line. The Feynman rules in momentum space for this theory are:
\begin{enumerate}
  \item propagators:
    \begin{enumerate}
      \item scalar:
      $
      \begin{tikzpicture}[baseline = (r.base)]
        \begin{feynman}[inline = (r.base)]
          \vertex[dot] (x) {};
          \vertex[right=4em of x, dot] (y) {};

          \vertex[below=0.2em of x] (r) {};

          \diagram* {
            (x) -- [scalar, momentum = \(q\)] (y),
          };
        \end{feynman}
      \end{tikzpicture}
      \,=\, \displaystyle\frac{i}{q^2 - m_\phi^2 + i\epsilon} = \tilde{D}_\text{F}(q)
      $;
      \item fermion:
      $
      \begin{tikzpicture}[baseline = (r.base)]
        \begin{feynman}[inline = (r.base)]
          \vertex[dot] (x) {};
          \vertex[right=4em of x, dot] (y) {};

          \vertex[below=0.2em of x] (r) {};

          \diagram* {
            (x) -- [fermion, momentum = \(p\)] (y),
          };
        \end{feynman}
      \end{tikzpicture}
      \,=\, \displaystyle\frac{i(\slashed{p} + m)}{p^2 - m^2 + i\epsilon} = \tilde{S}_\text{D}(p)
      $;
    \end{enumerate}
  \item vertex:
    $
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex[dot] (x) {};
        \vertex[right=4em of x] (y) {};

        \vertex[above=2em of x] (p) {};
        \vertex[left=2em of p] (p1) {};
        \vertex[below=4em of p1] (p2) {};

        \vertex[below=0.2em of x] (r) {};

        \diagram* {
          (x) -- [scalar] (y),
          (p2) -- [fermion] (x) -- [fermion] (p1),
        };
      \end{feynman}
    \end{tikzpicture}
    \,=\, -i g
    $;
  \item external legs:
    \begin{enumerate}
      \item initial state:
        \begin{enumerate}
          \item scalar:
            $
            \begin{tikzpicture}[baseline = (r.base)]
              \begin{feynman}[inline = (r.base)]
                \vertex[dot] (x) {};
                \vertex[right=4em of x] (y) {};

                \vertex[above=1em of x] (p) {};
                \vertex[left=1em of p] (p1) {};
                \vertex[below=2em of p1] (p2) {};

                \vertex[below=0.2em of x] (r) {};

                \diagram* {
                  (y) -- [scalar, momentum = \(q\)] (x),
                  (p2) -- (x) -- (p1),
                };
              \end{feynman}
            \end{tikzpicture}
            \,=\, 1
            $;
          \item fermion:
            $
            \begin{tikzpicture}[baseline = (r.base)]
              \begin{feynman}[inline = (r.base)]
                \vertex[dot] (x) {};
                \vertex[right=4em of x] (y) {};

                \vertex[above=1em of x] (p) {};
                \vertex[left=1em of p] (p1) {};
                \vertex[below=2em of p1] (p2) {};

                \vertex[below=0.2em of x] (r) {};

                \diagram* {
                  (y) -- [fermion, momentum = \(p\)] (x),
                  (p2) -- (x) -- (p1),
                };
              \end{feynman}
            \end{tikzpicture}
            \,=\, u^s(p)
            $;
          \item anti-fermion:
            $
            \begin{tikzpicture}[baseline = (r.base)]
              \begin{feynman}[inline = (r.base)]
                \vertex[dot] (x) {};
                \vertex[right=4em of x] (y) {};

                \vertex[above=1em of x] (p) {};
                \vertex[left=1em of p] (p1) {};
                \vertex[below=2em of p1] (p2) {};

                \vertex[below=0.2em of x] (r) {};

                \diagram* {
                  (y) -- [anti fermion, momentum = \(k\)] (x),
                  (p2) -- (x) -- (p1),
                };
              \end{feynman}
            \end{tikzpicture}
            \,=\, \bar{v}^s(k)
            $;
        \end{enumerate}
      \item final state:
        \begin{enumerate}
          \item scalar:
            $
            \begin{tikzpicture}[baseline = (r.base)]
              \begin{feynman}[inline = (r.base)]
                \vertex[dot] (x) {};
                \vertex[right=4em of x] (y) {};

                \vertex[above=1em of x] (p) {};
                \vertex[left=1em of p] (p1) {};
                \vertex[below=2em of p1] (p2) {};

                \vertex[below=0.2em of x] (r) {};

                \diagram* {
                  (x) -- [scalar, momentum' = \(q\)] (y),
                  (p2) -- (x) -- (p1),
                };
              \end{feynman}
            \end{tikzpicture}
            \,=\, 1
            $;
          \item fermion:
            $
            \begin{tikzpicture}[baseline = (r.base)]
              \begin{feynman}[inline = (r.base)]
                \vertex[dot] (x) {};
                \vertex[right=4em of x] (y) {};

                \vertex[above=1em of x] (p) {};
                \vertex[left=1em of p] (p1) {};
                \vertex[below=2em of p1] (p2) {};

                \vertex[below=0.2em of x] (r) {};

                \diagram* {
                  (x) -- [fermion, momentum' = \(p\)] (y),
                  (p2) -- (x) -- (p1),
                };
              \end{feynman}
            \end{tikzpicture}
            \,=\, \bar{u}^s(p)
            $;
          \item anti-fermion:
            $
            \begin{tikzpicture}[baseline = (r.base)]
              \begin{feynman}[inline = (r.base)]
                \vertex[dot] (x) {};
                \vertex[right=4em of x] (y) {};

                \vertex[above=1em of x] (p) {};
                \vertex[left=1em of p] (p1) {};
                \vertex[below=2em of p1] (p2) {};

                \vertex[below=0.2em of x] (r) {};

                \diagram* {
                  (x) -- [anti fermion, momentum' = \(k\)] (y),
                  (p2) -- (x) -- (p1),
                };
              \end{feynman}
            \end{tikzpicture}
            \,=\, v^s(k)
            $;
        \end{enumerate}
    \end{enumerate}
  \item impose momentum conservation at each vertex;
  \item integrate over each undetermined loop momentum $ p $ with measure $ \frac{\dd^4p}{(2\pi)^4} $ (each closed fermionic loop determines an additional $ (-1) $ factor due to anti-commutation);
  \item divide by the symmetry factor of the diagram.
\end{enumerate}
Note that for the Yukawa interaction $ g \bar{\Psi} \Psi \phi $ the symmetry factor of each diagram is $ S = 1 $, as the three field in $ \ham_\text{int} $ cannot substitute for one another in contractions. Moreover, Dirac indices are always contracted together along fermionic lines. \\
It can be shown that an interaction mediated by a scalar field is always attractive, both for $ ff $, $ f\bar{f} $ and $ \bar{f}\bar{f} $ scattering.

\subsubsection{Quantum Electrodynamics}

Consider a field theory with a Dirac field $ \Psi(x) $ and a vector (gauge) field $ A_\mu(x) $. The \bctxt{QED interaction Hamiltonian} is:
\begin{equation}
  \ham_\text{int} = e \bar{\Psi} \gamma^\mu \Psi A_\mu
\end{equation}
This interaction term determines interaction vertices with two fermionic lines and one vector line.
The photon propagator is introduced:
\begin{equation}
  D_{\mu \nu}(x-y) \defeq \braket{0 | \tempord\{A_\mu(x) A_\nu(y)\} | 0}
  \qquad \Rightarrow \qquad
  \tilde{D}_{\mu \nu}(k) = \frac{-i}{k^2 + i\epsilon} \eta_{\mu \nu}
\end{equation}
Note that the spatial components $ A_i(x) $ have the same propagator as a massless real scalar field, while $ A_0(x) $ has an additional negative sign.
The Feynman rules in momentum space for QED are:
\begin{enumerate}
  \item propagators:
    \begin{enumerate}
      \item vector:
      $
      \begin{tikzpicture}[baseline = (r.base)]
        \begin{feynman}[inline = (r.base)]
          \vertex[dot] (x) {};
          \vertex[right=4em of x, dot] (y) {};

          \vertex (l1) at ($(x)+(-0.4,0)$) {\(\mu\)};
          \vertex (l2) at ($(y)+(0.4,0)$) {\(\nu\)};

          \vertex[below=0.2em of x] (r) {};

          \diagram* {
            (x) -- [photon, momentum = \(q\)] (y),
          };
        \end{feynman}
      \end{tikzpicture}
      \,=\, \tilde{D}_{\mu \nu}(q)
      $;
      \item fermion:
      $
      \begin{tikzpicture}[baseline = (r.base)]
        \begin{feynman}[inline = (r.base)]
          \vertex[dot] (x) {};
          \vertex[right=4em of x, dot] (y) {};

          \vertex[below=0.2em of x] (r) {};

          \diagram* {
            (x) -- [fermion, momentum = \(p\)] (y),
          };
        \end{feynman}
      \end{tikzpicture}
      \,=\, \tilde{S}_\text{D}(p)
      $;
    \end{enumerate}
  \item vertex:
    $
    \begin{tikzpicture}[baseline = (r.base)]
      \begin{feynman}[inline = (r.base)]
        \vertex[dot] (x) {};
        \vertex[right=4em of x] (y) {};

        \vertex[above=2em of x] (p) {};
        \vertex[left=2em of p] (p1) {};
        \vertex[below=4em of p1] (p2) {};

        \vertex (l1) at ($(y)+(0.4,0)$) {\(\mu\)};

        \vertex[below=0.2em of x] (r) {};

        \diagram* {
          (x) -- [photon] (y),
          (p2) -- [fermion] (x) -- [fermion] (p1),
        };
      \end{feynman}
    \end{tikzpicture}
    \,=\, -i e \gamma^\mu
    $;
  \item external legs:
    \begin{enumerate}
      \item initial state:
        \begin{enumerate}
          \item vector:
            $
            \begin{tikzpicture}[baseline = (r.base)]
              \begin{feynman}[inline = (r.base)]
                \vertex[dot] (x) {};
                \vertex[right=4em of x] (y) {};

                \vertex[above=1em of x] (p) {};
                \vertex[left=1em of p] (p1) {};
                \vertex[below=2em of p1] (p2) {};

                \vertex (l1) at ($(y)+(0.4,0)$) {\(\mu\)};

                \vertex[below=0.2em of x] (r) {};

                \diagram* {
                  (y) -- [photon, momentum = \(q\)] (x),
                  (p2) -- (x) -- (p1),
                };
              \end{feynman}
            \end{tikzpicture}
            \,=\, \epsilon_\mu(q)
            $;
          \item fermion:
            $
            \begin{tikzpicture}[baseline = (r.base)]
              \begin{feynman}[inline = (r.base)]
                \vertex[dot] (x) {};
                \vertex[right=4em of x] (y) {};

                \vertex[above=1em of x] (p) {};
                \vertex[left=1em of p] (p1) {};
                \vertex[below=2em of p1] (p2) {};

                \vertex[below=0.2em of x] (r) {};

                \diagram* {
                  (y) -- [fermion, momentum = \(p\)] (x),
                  (p2) -- (x) -- (p1),
                };
              \end{feynman}
            \end{tikzpicture}
            \,=\, u^s(p)
            $;
          \item anti-fermion:
            $
            \begin{tikzpicture}[baseline = (r.base)]
              \begin{feynman}[inline = (r.base)]
                \vertex[dot] (x) {};
                \vertex[right=4em of x] (y) {};

                \vertex[above=1em of x] (p) {};
                \vertex[left=1em of p] (p1) {};
                \vertex[below=2em of p1] (p2) {};

                \vertex[below=0.2em of x] (r) {};

                \diagram* {
                  (y) -- [anti fermion, momentum = \(k\)] (x),
                  (p2) -- (x) -- (p1),
                };
              \end{feynman}
            \end{tikzpicture}
            \,=\, \bar{v}^s(k)
            $;
        \end{enumerate}
      \item final state:
        \begin{enumerate}
          \item scalar:
            $
            \begin{tikzpicture}[baseline = (r.base)]
              \begin{feynman}[inline = (r.base)]
                \vertex[dot] (x) {};
                \vertex[right=4em of x] (y) {};

                \vertex[above=1em of x] (p) {};
                \vertex[left=1em of p] (p1) {};
                \vertex[below=2em of p1] (p2) {};

                \vertex (l1) at ($(y)+(0.4,0)$) {\(\mu\)};

                \vertex[below=0.2em of x] (r) {};

                \diagram* {
                  (x) -- [photon, momentum' = \(q\)] (y),
                  (p2) -- (x) -- (p1),
                };
              \end{feynman}
            \end{tikzpicture}
            \,=\, \epsilon_\mu^*(q)
            $;
          \item fermion:
            $
            \begin{tikzpicture}[baseline = (r.base)]
              \begin{feynman}[inline = (r.base)]
                \vertex[dot] (x) {};
                \vertex[right=4em of x] (y) {};

                \vertex[above=1em of x] (p) {};
                \vertex[left=1em of p] (p1) {};
                \vertex[below=2em of p1] (p2) {};

                \vertex[below=0.2em of x] (r) {};

                \diagram* {
                  (x) -- [fermion, momentum' = \(p\)] (y),
                  (p2) -- (x) -- (p1),
                };
              \end{feynman}
            \end{tikzpicture}
            \,=\, \bar{u}^s(p)
            $;
          \item anti-fermion:
            $
            \begin{tikzpicture}[baseline = (r.base)]
              \begin{feynman}[inline = (r.base)]
                \vertex[dot] (x) {};
                \vertex[right=4em of x] (y) {};

                \vertex[above=1em of x] (p) {};
                \vertex[left=1em of p] (p1) {};
                \vertex[below=2em of p1] (p2) {};

                \vertex[below=0.2em of x] (r) {};

                \diagram* {
                  (x) -- [anti fermion, momentum' = \(k\)] (y),
                  (p2) -- (x) -- (p1),
                };
              \end{feynman}
            \end{tikzpicture}
            \,=\, v^s(k)
            $;
        \end{enumerate}
    \end{enumerate}
  \item impose momentum conservation at each vertex;
  \item integrate over each undetermined loop momentum $ p $ with measure $ \frac{\dd^4p}{(2\pi)^4} $ (each closed fermionic loop determines an additional $ (-1) $ factor due to anti-commutation);
  \item divide by the symmetry factor of the diagram.
\end{enumerate}
Of course, when considering fermions with charge $ Q $ (in units of $ \abs{e} $), substitute $ e \mapsto Q\abs{e} $ in the above formulae. \\
It can be shown that the interaction mediated by a vector field is attractive for $ f\bar{f} $ scattering and repulsive for $ ff $ and $ \bar{f} \bar{f} $ scattering.










